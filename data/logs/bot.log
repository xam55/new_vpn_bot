2025-12-26 02:58:57,741 - __main__ - INFO - База данных создана
2025-12-26 02:59:05,115 - __main__ - CRITICAL - Критическая ошибка: cannot import name 'get_user_keys_keyboard' from 'src.keyboards' (C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\keyboards\__init__.py)
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\run.py", line 72, in main
    from src.main import main as bot_main
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\main.py", line 8, in <module>
    from src.bot.loader import setup_middlewares, setup_routers
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\loader.py", line 6, in <module>
    from src.handlers import start_router, vpn_key_router, admin_router
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\__init__.py", line 4, in <module>
    from .status import router as status_router
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\status.py", line 8, in <module>
    from src.keyboards import (
ImportError: cannot import name 'get_user_keys_keyboard' from 'src.keyboards' (C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\keyboards\__init__.py)
2025-12-26 02:59:19,804 - __main__ - INFO - База данных создана
2025-12-26 02:59:27,153 - __main__ - CRITICAL - Критическая ошибка: cannot import name 'format_key_info' from 'src.utils.formatters' (C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\utils\formatters.py)
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\run.py", line 72, in main
    from src.main import main as bot_main
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\main.py", line 8, in <module>
    from src.bot.loader import setup_middlewares, setup_routers
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\loader.py", line 6, in <module>
    from src.handlers import start_router, vpn_key_router, admin_router
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\__init__.py", line 4, in <module>
    from .status import router as status_router
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\status.py", line 14, in <module>
    from src.utils.formatters import format_key_info, format_time_left
ImportError: cannot import name 'format_key_info' from 'src.utils.formatters' (C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\utils\formatters.py)
2025-12-26 02:59:42,788 - __main__ - INFO - База данных создана
2025-12-26 02:59:51,388 - __main__ - CRITICAL - Критическая ошибка: Passing `parse_mode`, `disable_web_page_preview` or `protect_content` to Bot initializer is not supported anymore. These arguments have been removed in 3.7.0 version. Use `default=DefaultBotProperties(parse_mode=<ParseMode.HTML: 'HTML'>)` argument instead.
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\run.py", line 73, in main
    await bot_main()
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\main.py", line 20, in main
    bot = Bot(
          ^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\client\bot.py", line 301, in __init__
    raise TypeError(
TypeError: Passing `parse_mode`, `disable_web_page_preview` or `protect_content` to Bot initializer is not supported anymore. These arguments have been removed in 3.7.0 version. Use `default=DefaultBotProperties(parse_mode=<ParseMode.HTML: 'HTML'>)` argument instead.
2025-12-26 03:00:02,787 - __main__ - INFO - База данных создана
2025-12-26 03:00:11,447 - __main__ - CRITICAL - Критическая ошибка: name 'status_router' is not defined
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\run.py", line 73, in main
    await bot_main()
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\main.py", line 34, in main
    routers = setup_routers()
              ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\loader.py", line 19, in setup_routers
    routers.append(status_router)
                   ^^^^^^^^^^^^^
NameError: name 'status_router' is not defined
2025-12-26 03:00:27,589 - __main__ - INFO - База данных создана
2025-12-26 03:00:35,777 - vpn_bot - INFO - Уведомление отправлено админу 7672667340
2025-12-26 03:00:35,778 - vpn_bot - INFO - Бот запускается...
2025-12-26 03:00:36,033 - aiogram.event - ERROR - Cause exception while process update id=385075177 by bot id=8399571083
NameError: name 'get_session' is not defined
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 19, in cmd_start
    async for session in get_session():
                         ^^^^^^^^^^^
NameError: name 'get_session' is not defined
2025-12-26 03:01:06,535 - aiogram.event - ERROR - Cause exception while process update id=385075178 by bot id=8399571083
NameError: name 'get_session' is not defined
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\vpn_key\purchase.py", line 28, in cmd_vpn_key
    async for session in get_session():
                         ^^^^^^^^^^^
NameError: name 'get_session' is not defined
2025-12-26 03:01:10,917 - aiogram.event - ERROR - Cause exception while process update id=385075179 by bot id=8399571083
InvalidRequestError: Mapper 'Mapper[User(users)]' has no property 'vpn_keys'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2531, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'vpn_keys'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\status.py", line 28, in cmd_my_status
    user = await UserDAO.get_by_telegram_id(session, message.from_user.id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 30, in get_by_telegram_id
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1591, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2533, in get_property
    raise sa_exc.InvalidRequestError(
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[User(users)]' has no property 'vpn_keys'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 03:01:15,743 - aiogram.event - ERROR - Cause exception while process update id=385075184 by bot id=8399571083
ImportError: cannot import name 'PaymentDAO' from 'src.services.database' (C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\database.py)
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\admin\panel.py", line 66, in show_confirmations
    from src.services.database import PaymentDAO, get_session
ImportError: cannot import name 'PaymentDAO' from 'src.services.database' (C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\database.py)
2025-12-26 03:01:17,482 - aiogram.event - ERROR - Cause exception while process update id=385075185 by bot id=8399571083
TelegramBadRequest: Telegram server says - Bad Request: message is not modified: specified new message content and reply markup are exactly the same as a current content and reply markup of the message
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\admin\panel.py", line 37, in back_to_main_menu
    await callback.message.edit_text(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\methods\base.py", line 84, in emit
    return await bot(self)
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\client\bot.py", line 485, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\client\session\base.py", line 259, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\client\session\aiohttp.py", line 177, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\client\session\base.py", line 121, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: message is not modified: specified new message content and reply markup are exactly the same as a current content and reply markup of the message
2025-12-26 03:01:25,081 - aiogram.event - ERROR - Cause exception while process update id=385075186 by bot id=8399571083
NameError: name 'get_session' is not defined
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 19, in cmd_start
    # Регистрируем пользователя
                ^^^^^^
NameError: name 'get_session' is not defined
2025-12-26 03:04:36,786 - __main__ - INFO - База данных создана
2025-12-26 03:04:45,511 - vpn_bot - INFO - Уведомление отправлено админу 7672667340
2025-12-26 03:04:45,512 - vpn_bot - INFO - Бот запускается...
2025-12-26 03:04:49,370 - aiogram.event - ERROR - Cause exception while process update id=385075187 by bot id=8399571083
NameError: name 'get_session' is not defined
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\vpn_key\purchase.py", line 28, in cmd_vpn_key
    async for session in get_session():
                         ^^^^^^^^^^^
NameError: name 'get_session' is not defined
2025-12-26 03:04:54,270 - aiogram.event - ERROR - Cause exception while process update id=385075188 by bot id=8399571083
NameError: name 'get_session' is not defined
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\vpn_key\purchase.py", line 28, in cmd_vpn_key
    async for session in get_session():
                         ^^^^^^^^^^^
NameError: name 'get_session' is not defined
2025-12-26 03:04:57,848 - aiogram.event - ERROR - Cause exception while process update id=385075190 by bot id=8399571083
InvalidRequestError: Mapper 'Mapper[User(users)]' has no property 'vpn_keys'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2531, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'vpn_keys'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\status.py", line 28, in cmd_my_status
    user = await UserDAO.get_by_telegram_id(session, message.from_user.id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 30, in get_by_telegram_id
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1591, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2533, in get_property
    raise sa_exc.InvalidRequestError(
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[User(users)]' has no property 'vpn_keys'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 03:05:02,874 - aiogram.event - ERROR - Cause exception while process update id=385075191 by bot id=8399571083
ImportError: cannot import name 'PaymentDAO' from 'src.services.database' (C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\database.py)
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\admin\panel.py", line 66, in show_confirmations
    from src.services.database import PaymentDAO, get_session
ImportError: cannot import name 'PaymentDAO' from 'src.services.database' (C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\database.py)
2025-12-26 03:09:36,076 - __main__ - INFO - База данных создана
2025-12-26 03:09:45,073 - vpn_bot - INFO - Уведомление отправлено админу 7672667340
2025-12-26 03:09:45,074 - vpn_bot - INFO - Бот запускается...
2025-12-26 03:09:45,325 - aiogram.event - ERROR - Cause exception while process update id=385075196 by bot id=8399571083
InvalidRequestError: Mapper 'Mapper[User(users)]' has no property 'vpn_keys'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2531, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'vpn_keys'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 21, in cmd_start
    user = await UserDAO.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 16, in get_or_create
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1591, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2533, in get_property
    raise sa_exc.InvalidRequestError(
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[User(users)]' has no property 'vpn_keys'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 03:09:45,364 - aiogram.event - ERROR - Cause exception while process update id=385075195 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[VPNKey(vpn_keys)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'vpn_keys'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\status.py", line 28, in cmd_my_status
    user = await UserDAO.get_by_telegram_id(session, message.from_user.id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 30, in get_by_telegram_id
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4264, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[VPNKey(vpn_keys)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'vpn_keys'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 03:09:48,764 - aiogram.event - ERROR - Cause exception while process update id=385075197 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[VPNKey(vpn_keys)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'vpn_keys'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 21, in cmd_start
    user = await UserDAO.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 16, in get_or_create
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4264, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[VPNKey(vpn_keys)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'vpn_keys'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 03:10:07,200 - aiogram.event - ERROR - Cause exception while process update id=385075198 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[VPNKey(vpn_keys)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'vpn_keys'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 21, in cmd_start
    user = await UserDAO.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 16, in get_or_create
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4264, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[VPNKey(vpn_keys)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'vpn_keys'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 03:17:37,959 - __main__ - INFO - База данных создана
2025-12-26 03:17:46,215 - vpn_bot - INFO - Уведомление отправлено админу 7672667340
2025-12-26 03:17:46,217 - vpn_bot - INFO - Бот запускается...
2025-12-26 03:18:19,494 - aiogram.event - ERROR - Cause exception while process update id=385075200 by bot id=8399571083
InvalidRequestError: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2531, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'payments'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\vpn_key\purchase.py", line 31, in cmd_vpn_key
    user = await UserDAO.get_by_telegram_id(session, message.from_user.id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 30, in get_by_telegram_id
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1591, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2533, in get_property
    raise sa_exc.InvalidRequestError(
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 03:21:23,151 - __main__ - INFO - База данных создана
2025-12-26 03:21:30,401 - __main__ - CRITICAL - Критическая ошибка: name 'purchase_router' is not defined
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\run.py", line 72, in main
    from src.main import main as bot_main
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\main.py", line 9, in <module>
    from src.bot.loader import setup_middlewares, setup_routers
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\loader.py", line 8, in <module>
    from src.handlers.vpn_key import vpn_key_router
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\vpn_key\__init__.py", line 9, in <module>
    vpn_key_router.include_router(purchase_router)
                                  ^^^^^^^^^^^^^^^
NameError: name 'purchase_router' is not defined
2025-12-26 03:21:42,908 - __main__ - INFO - База данных создана
2025-12-26 03:21:51,141 - vpn_bot - INFO - Уведомление отправлено админу 7672667340
2025-12-26 03:21:51,143 - vpn_bot - INFO - Бот запускается...
2025-12-26 03:21:54,346 - aiogram.event - ERROR - Cause exception while process update id=385075201 by bot id=8399571083
InvalidRequestError: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2531, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'payments'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\vpn_key\purchase.py", line 31, in cmd_vpn_key
    user = await UserDAO.get_by_telegram_id(session, message.from_user.id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 30, in get_by_telegram_id
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1591, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2533, in get_property
    raise sa_exc.InvalidRequestError(
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 03:22:15,725 - aiogram.event - ERROR - Cause exception while process update id=385075202 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 21, in cmd_start
    user = await UserDAO.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 16, in get_or_create
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4264, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 03:29:07,445 - __main__ - INFO - База данных создана
2025-12-26 03:29:16,536 - vpn_bot - INFO - Уведомление отправлено админу 7672667340
2025-12-26 03:29:16,537 - vpn_bot - INFO - Бот запускается...
2025-12-26 03:29:19,526 - aiogram.event - ERROR - Cause exception while process update id=385075203 by bot id=8399571083
InvalidRequestError: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2531, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'payments'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 21, in cmd_start
    user = await UserDAO.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 16, in get_or_create
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1591, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2533, in get_property
    raise sa_exc.InvalidRequestError(
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 03:29:32,269 - aiogram.event - ERROR - Cause exception while process update id=385075204 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 21, in cmd_start
    user = await UserDAO.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 16, in get_or_create
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4264, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 03:29:45,870 - aiogram.event - ERROR - Cause exception while process update id=385075205 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\vpn_key\purchase.py", line 31, in cmd_vpn_key
    user = await UserDAO.get_by_telegram_id(session, message.from_user.id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 30, in get_by_telegram_id
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4264, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 03:29:48,477 - aiogram.event - ERROR - Cause exception while process update id=385075206 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 21, in cmd_start
    user = await UserDAO.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 16, in get_or_create
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4264, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 03:30:04,150 - aiogram.event - ERROR - Cause exception while process update id=385075207 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 21, in cmd_start
    user = await UserDAO.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 16, in get_or_create
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4264, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 03:31:23,757 - __main__ - INFO - База данных создана
2025-12-26 03:31:32,549 - vpn_bot - INFO - Уведомление отправлено админу 7672667340
2025-12-26 03:31:32,550 - vpn_bot - INFO - Бот запускается...
2025-12-26 03:31:32,802 - aiogram.event - ERROR - Cause exception while process update id=385075208 by bot id=8399571083
InvalidRequestError: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2531, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'payments'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 21, in cmd_start
    user = await UserDAO.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 16, in get_or_create
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1591, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2533, in get_property
    raise sa_exc.InvalidRequestError(
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 03:32:00,281 - aiogram.event - ERROR - Cause exception while process update id=385075209 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 21, in cmd_start
    user = await UserDAO.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 16, in get_or_create
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4264, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 03:33:44,517 - aiogram.event - ERROR - Cause exception while process update id=385075210 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 21, in cmd_start
    user = await UserDAO.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 16, in get_or_create
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4264, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 03:33:55,745 - aiogram.event - ERROR - Cause exception while process update id=385075211 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 21, in cmd_start
    user = await UserDAO.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 16, in get_or_create
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4264, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 03:33:56,496 - aiogram.event - ERROR - Cause exception while process update id=385075212 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 21, in cmd_start
    user = await UserDAO.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 16, in get_or_create
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4264, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 03:34:01,727 - aiogram.event - ERROR - Cause exception while process update id=385075213 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 21, in cmd_start
    user = await UserDAO.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 16, in get_or_create
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\Desktop\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4264, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 03:34:57,801 - __main__ - ERROR - Ошибка БД: No module named 'aiosqlite'
2025-12-26 03:35:25,844 - __main__ - INFO - База данных создана
2025-12-26 03:35:25,847 - __main__ - CRITICAL - Критическая ошибка: No module named 'aiogram'
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\run.py", line 72, in main
    from src.main import main as bot_main
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\main.py", line 3, in <module>
    from aiogram import Bot, Dispatcher
ModuleNotFoundError: No module named 'aiogram'
2025-12-26 03:36:46,484 - __main__ - INFO - База данных создана
2025-12-26 03:36:50,632 - __main__ - CRITICAL - Критическая ошибка: No module named 'cachetools'
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\run.py", line 72, in main
    from src.main import main as bot_main
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\main.py", line 9, in <module>
    from src.bot.loader import setup_middlewares, setup_routers
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\loader.py", line 2, in <module>
    from src.bot.middlewares.throttling import ThrottlingMiddleware
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\__init__.py", line 1, in <module>
    from .throttling import ThrottlingMiddleware
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 4, in <module>
    from cachetools import TTLCache
ModuleNotFoundError: No module named 'cachetools'
2025-12-26 03:38:01,472 - __main__ - INFO - База данных создана
2025-12-26 03:38:05,219 - __main__ - CRITICAL - Критическая ошибка: No module named 'cachetools'
Traceback (most recent call last):
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\run.py", line 72, in main
    from src.main import main as bot_main
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\main.py", line 9, in <module>
    from src.bot.loader import setup_middlewares, setup_routers
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\loader.py", line 2, in <module>
    from src.bot.middlewares.throttling import ThrottlingMiddleware
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\__init__.py", line 1, in <module>
    from .throttling import ThrottlingMiddleware
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 4, in <module>
    from cachetools import TTLCache
ModuleNotFoundError: No module named 'cachetools'
2025-12-26 03:38:21,075 - __main__ - INFO - База данных создана
2025-12-26 03:38:25,897 - vpn_bot - INFO - Уведомление отправлено админу 7672667340
2025-12-26 03:38:25,898 - vpn_bot - INFO - Бот запускается...
2025-12-26 03:38:30,918 - aiogram.event - ERROR - Cause exception while process update id=385075214 by bot id=8399571083
InvalidRequestError: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2531, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'payments'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 21, in cmd_start
    user = await UserDAO.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 16, in get_or_create
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1591, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2533, in get_property
    raise sa_exc.InvalidRequestError(
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 03:38:40,126 - aiogram.event - ERROR - Cause exception while process update id=385075215 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 21, in cmd_start
    user = await UserDAO.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 16, in get_or_create
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4264, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 03:38:43,246 - aiogram.event - ERROR - Cause exception while process update id=385075216 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 21, in cmd_start
    user = await UserDAO.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 16, in get_or_create
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4264, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 03:38:43,390 - aiogram.event - ERROR - Cause exception while process update id=385075217 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 21, in cmd_start
    user = await UserDAO.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 16, in get_or_create
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4264, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 03:38:43,539 - aiogram.event - ERROR - Cause exception while process update id=385075218 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 21, in cmd_start
    user = await UserDAO.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 16, in get_or_create
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4264, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 03:38:43,691 - aiogram.event - ERROR - Cause exception while process update id=385075219 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 21, in cmd_start
    user = await UserDAO.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 16, in get_or_create
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4264, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 03:38:44,006 - aiogram.event - ERROR - Cause exception while process update id=385075220 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 21, in cmd_start
    user = await UserDAO.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 16, in get_or_create
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4264, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 03:38:54,209 - aiogram.event - ERROR - Cause exception while process update id=385075221 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 21, in cmd_start
    user = await UserDAO.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 16, in get_or_create
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4264, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 03:39:03,921 - aiogram.event - ERROR - Cause exception while process update id=385075222 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\vpn_key\purchase.py", line 31, in cmd_vpn_key
    user = await UserDAO.get_by_telegram_id(session, message.from_user.id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 30, in get_by_telegram_id
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4264, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 03:39:15,075 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-26 03:39:15,076 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8399571083)
2025-12-26 04:03:30,622 - __main__ - INFO - База данных создана
2025-12-26 04:03:37,117 - vpn_bot - INFO - Уведомление отправлено админу 7672667340
2025-12-26 04:03:37,118 - src.services.scheduler - INFO - Планировщик запущен
2025-12-26 04:03:37,118 - vpn_bot - INFO - Планировщик запущен
2025-12-26 04:03:37,118 - vpn_bot - INFO - Бот запускается...
2025-12-26 04:03:37,119 - src.services.scheduler - INFO - Планировщик запущен
2025-12-26 04:03:37,132 - src.services.scheduler - ERROR - Ошибка в планировщике очистки: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 04:03:39,727 - aiogram.event - ERROR - Cause exception while process update id=385075223 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 21, in cmd_start
    user = await UserDAO.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 16, in get_or_create
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4264, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 04:03:58,451 - aiogram.event - ERROR - Cause exception while process update id=385075224 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 21, in cmd_start
    user = await UserDAO.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 16, in get_or_create
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4264, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 04:04:07,656 - aiogram.event - ERROR - Cause exception while process update id=385075225 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 21, in cmd_start
    user = await UserDAO.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 16, in get_or_create
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4264, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 04:04:17,749 - aiogram.event - ERROR - Cause exception while process update id=385075226 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\vpn_key\purchase.py", line 32, in cmd_vpn_key
    user = await UserDAO.get_by_telegram_id(session, message.from_user.id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 30, in get_by_telegram_id
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4264, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 04:11:34,829 - __main__ - INFO - База данных создана
2025-12-26 04:11:40,176 - vpn_bot - INFO - Уведомление отправлено админу 7672667340
2025-12-26 04:11:40,177 - src.services.scheduler - INFO - Планировщик запущен
2025-12-26 04:11:40,177 - vpn_bot - INFO - Планировщик запущен
2025-12-26 04:11:40,178 - vpn_bot - INFO - Бот запускается...
2025-12-26 04:11:40,179 - src.services.scheduler - INFO - Планировщик запущен
2025-12-26 04:11:40,193 - src.services.scheduler - ERROR - Ошибка в планировщике очистки: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 04:11:40,384 - aiogram.event - ERROR - Cause exception while process update id=385075227 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 21, in cmd_start
    user = await UserDAO.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 16, in get_or_create
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4264, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 04:11:43,670 - aiogram.event - ERROR - Cause exception while process update id=385075228 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 21, in cmd_start
    user = await UserDAO.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 16, in get_or_create
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4264, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 04:11:59,395 - aiogram.event - ERROR - Cause exception while process update id=385075229 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 21, in cmd_start
    user = await UserDAO.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 16, in get_or_create
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4264, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 04:12:05,963 - aiogram.event - ERROR - Cause exception while process update id=385075230 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 21, in cmd_start
    user = await UserDAO.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 16, in get_or_create
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4264, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 04:12:13,766 - aiogram.event - ERROR - Cause exception while process update id=385075231 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 21, in cmd_start
    user = await UserDAO.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 16, in get_or_create
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4264, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 04:14:37,734 - __main__ - INFO - База данных создана
2025-12-26 04:14:42,897 - vpn_bot - INFO - Уведомление отправлено админу 7672667340
2025-12-26 04:14:42,898 - src.services.scheduler - INFO - Планировщик запущен
2025-12-26 04:14:42,898 - vpn_bot - INFO - Планировщик запущен
2025-12-26 04:14:42,899 - vpn_bot - INFO - Бот запускается...
2025-12-26 04:14:42,901 - src.services.scheduler - INFO - Планировщик запущен
2025-12-26 04:14:42,916 - src.services.scheduler - ERROR - Ошибка в планировщике очистки: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 04:14:43,099 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-26 04:14:43,100 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8399571083)
2025-12-26 04:14:47,215 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-26 04:14:47,215 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8399571083)
2025-12-26 04:14:48,349 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-26 04:14:48,351 - aiogram.dispatcher - WARNING - Sleep for 1.318548 seconds and try again... (tryings = 1, bot id = 8399571083)
2025-12-26 04:14:52,791 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-26 04:14:52,792 - aiogram.dispatcher - WARNING - Sleep for 1.160966 seconds and try again... (tryings = 1, bot id = 8399571083)
2025-12-26 04:14:54,057 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-26 04:14:54,058 - aiogram.dispatcher - WARNING - Sleep for 1.708048 seconds and try again... (tryings = 2, bot id = 8399571083)
2025-12-26 04:14:58,872 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-26 04:14:58,872 - aiogram.dispatcher - WARNING - Sleep for 1.441825 seconds and try again... (tryings = 2, bot id = 8399571083)
2025-12-26 04:15:00,413 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-26 04:15:00,414 - aiogram.dispatcher - WARNING - Sleep for 2.353559 seconds and try again... (tryings = 3, bot id = 8399571083)
2025-12-26 04:15:05,869 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-26 04:15:05,870 - aiogram.dispatcher - WARNING - Sleep for 1.728466 seconds and try again... (tryings = 3, bot id = 8399571083)
2025-12-26 04:15:07,707 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-26 04:15:07,708 - aiogram.dispatcher - WARNING - Sleep for 3.043166 seconds and try again... (tryings = 4, bot id = 8399571083)
2025-12-26 04:15:10,853 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-26 04:15:10,854 - aiogram.dispatcher - WARNING - Sleep for 2.116130 seconds and try again... (tryings = 4, bot id = 8399571083)
2025-12-26 04:15:16,077 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-26 04:15:16,078 - aiogram.dispatcher - WARNING - Sleep for 3.903283 seconds and try again... (tryings = 5, bot id = 8399571083)
2025-12-26 04:15:20,102 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-26 04:15:20,102 - aiogram.dispatcher - WARNING - Sleep for 2.708540 seconds and try again... (tryings = 5, bot id = 8399571083)
2025-12-26 04:15:25,063 - aiogram.event - ERROR - Cause exception while process update id=385075232 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 21, in cmd_start
    user = await UserDAO.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 16, in get_or_create
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4264, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 04:15:25,918 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-26 04:15:25,918 - aiogram.dispatcher - WARNING - Sleep for 5.050356 seconds and try again... (tryings = 6, bot id = 8399571083)
2025-12-26 04:15:29,266 - aiogram.event - ERROR - Cause exception while process update id=385075233 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 21, in cmd_start
    user = await UserDAO.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 16, in get_or_create
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4264, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 04:15:31,069 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-26 04:15:31,070 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8399571083)
2025-12-26 04:15:32,946 - aiogram.event - ERROR - Cause exception while process update id=385075234 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 21, in cmd_start
    user = await UserDAO.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\Desktop\vpn_bot_xam\vpn_bot\src\services\dao.py", line 16, in get_or_create
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 716, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1447, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 887, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 933, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4782, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\PycharmProjects\hakaton_tovar\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4264, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 04:15:35,169 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-26 04:15:35,169 - aiogram.dispatcher - WARNING - Sleep for 5.010703 seconds and try again... (tryings = 7, bot id = 8399571083)
2025-12-26 04:15:40,287 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-26 04:15:40,288 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8399571083)
2025-12-26 04:15:44,434 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-26 04:15:44,435 - aiogram.dispatcher - WARNING - Sleep for 4.961074 seconds and try again... (tryings = 8, bot id = 8399571083)
2025-12-26 04:15:44,811 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-26 04:15:44,812 - aiogram.dispatcher - WARNING - Sleep for 1.274252 seconds and try again... (tryings = 1, bot id = 8399571083)
2025-12-26 04:15:44,978 - src.services.scheduler - INFO - Планировщик остановлен
2025-12-26 04:15:44,979 - src.services.scheduler - INFO - Планировщик остановлен
2025-12-26 20:57:21,271 - __main__ - INFO - База данных создана
2025-12-26 20:57:24,545 - __main__ - CRITICAL - Критическая ошибка: No module named 'aiogram.client.default'
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\run.py", line 72, in main
    from src.main import main as bot_main
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\main.py", line 5, in <module>
    from aiogram.client.default import DefaultBotProperties
ModuleNotFoundError: No module named 'aiogram.client.default'
2025-12-26 21:01:26,529 - __main__ - INFO - База данных создана
2025-12-26 21:01:34,613 - vpn_bot - INFO - Уведомление отправлено админу 7672667340
2025-12-26 21:01:34,614 - src.services.scheduler - INFO - Планировщик запущен
2025-12-26 21:01:34,614 - vpn_bot - INFO - Планировщик запущен
2025-12-26 21:01:34,615 - vpn_bot - INFO - Бот запускается...
2025-12-26 21:01:34,615 - src.services.scheduler - INFO - Планировщик запущен
2025-12-26 21:01:34,631 - src.services.scheduler - ERROR - Ошибка в планировщике очистки: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 21:02:31,481 - aiogram.event - ERROR - Cause exception while process update id=385075235 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 21, in cmd_start
    user = await UserDAO.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\services\dao.py", line 16, in get_or_create
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 455, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 192, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 293, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1631, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 704, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 316, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1426, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 867, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 912, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 143, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4590, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 687, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1091, in create_for_statement
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2537, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2617, in __init__
    entity._post_inspect
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1260, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2707, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2386, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4199, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4236, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 21:02:43,692 - aiogram.event - ERROR - Cause exception while process update id=385075236 by bot id=8399571083
InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\vpn_key\purchase.py", line 32, in cmd_vpn_key
    user = await UserDAO.get_by_telegram_id(session, message.from_user.id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\services\dao.py", line 30, in get_by_telegram_id
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 455, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 192, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 293, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1631, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 704, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 316, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1426, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 867, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 912, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 143, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4590, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 687, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1091, in create_for_statement
    _QueryEntity.to_compile_state(
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2537, in to_compile_state
    _MapperEntity(
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2617, in __init__
    entity._post_inspect
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1260, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2707, in _post_inspect
    self._check_configure()
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2386, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4199, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4236, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Payment(payments)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-26 21:03:25,323 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-26 21:03:25,323 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8399571083)
2025-12-26 21:03:25,574 - src.services.scheduler - INFO - Планировщик остановлен
2025-12-26 21:03:25,574 - src.services.scheduler - INFO - Планировщик остановлен
2025-12-26 21:06:50,921 - __main__ - INFO - База данных создана
2025-12-26 21:06:57,711 - vpn_bot - INFO - Уведомление отправлено админу 7672667340
2025-12-26 21:06:57,712 - src.services.scheduler - INFO - Планировщик запущен
2025-12-26 21:06:57,713 - vpn_bot - INFO - Планировщик запущен
2025-12-26 21:06:57,714 - vpn_bot - INFO - Бот запускается...
2025-12-26 21:06:57,715 - src.services.scheduler - INFO - Планировщик запущен
2025-12-26 21:06:57,741 - src.services.scheduler - ERROR - Ошибка в планировщике очистки: (sqlite3.OperationalError) no such column: vpn_keys.server_public_key
[SQL: SELECT vpn_keys.id, vpn_keys.key_name, vpn_keys.user_id, vpn_keys.private_key, vpn_keys.public_key, vpn_keys.server_public_key, vpn_keys.server_ip, vpn_keys.server_port, vpn_keys.server_endpoint, vpn_keys.ip_address, vpn_keys.config_data, vpn_keys.days, vpn_keys.created_at, vpn_keys.expires_at, vpn_keys.status, vpn_keys.payment_id 
FROM vpn_keys 
WHERE vpn_keys.status = ? AND vpn_keys.expires_at < ?]
[parameters: ('active', '2025-12-26 21:06:57.716760')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-26 21:08:23,032 - aiogram.event - ERROR - Cause exception while process update id=385075242 by bot id=8399571083
ValidationError: 1 validation error for EditMessageText
reply_markup
  Input should be a valid dictionary or instance of InlineKeyboardMarkup [type=model_type, input_value=ReplyKeyboardMarkup(keybo...er=None, selective=None), input_type=ReplyKeyboardMarkup]
    For further information visit https://errors.pydantic.dev/2.9/v/model_type
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\vpn_key\payment.py", line 114, in mark_as_paid
    await callback.message.edit_text(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\types\message.py", line 3896, in edit_text
    return EditMessageText(
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\pydantic\main.py", line 212, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for EditMessageText
reply_markup
  Input should be a valid dictionary or instance of InlineKeyboardMarkup [type=model_type, input_value=ReplyKeyboardMarkup(keybo...er=None, selective=None), input_type=ReplyKeyboardMarkup]
    For further information visit https://errors.pydantic.dev/2.9/v/model_type
2025-12-26 21:08:32,827 - aiogram.event - ERROR - Cause exception while process update id=385075243 by bot id=8399571083
ValidationError: 1 validation error for EditMessageText
reply_markup
  Input should be a valid dictionary or instance of InlineKeyboardMarkup [type=model_type, input_value=ReplyKeyboardMarkup(keybo...er=None, selective=None), input_type=ReplyKeyboardMarkup]
    For further information visit https://errors.pydantic.dev/2.9/v/model_type
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\vpn_key\payment.py", line 133, in request_photo
    await callback.message.edit_text(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\types\message.py", line 3896, in edit_text
    return EditMessageText(
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\pydantic\main.py", line 212, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for EditMessageText
reply_markup
  Input should be a valid dictionary or instance of InlineKeyboardMarkup [type=model_type, input_value=ReplyKeyboardMarkup(keybo...er=None, selective=None), input_type=ReplyKeyboardMarkup]
    For further information visit https://errors.pydantic.dev/2.9/v/model_type
2025-12-26 21:08:35,404 - aiogram.event - ERROR - Cause exception while process update id=385075245 by bot id=8399571083
ValidationError: 1 validation error for EditMessageText
reply_markup
  Input should be a valid dictionary or instance of InlineKeyboardMarkup [type=model_type, input_value=ReplyKeyboardMarkup(keybo...er=None, selective=None), input_type=ReplyKeyboardMarkup]
    For further information visit https://errors.pydantic.dev/2.9/v/model_type
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\vpn_key\payment.py", line 114, in mark_as_paid
    await callback.message.edit_text(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\types\message.py", line 3896, in edit_text
    return EditMessageText(
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\pydantic\main.py", line 212, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for EditMessageText
reply_markup
  Input should be a valid dictionary or instance of InlineKeyboardMarkup [type=model_type, input_value=ReplyKeyboardMarkup(keybo...er=None, selective=None), input_type=ReplyKeyboardMarkup]
    For further information visit https://errors.pydantic.dev/2.9/v/model_type
2025-12-26 21:08:35,412 - aiogram.event - ERROR - Cause exception while process update id=385075244 by bot id=8399571083
ValidationError: 1 validation error for EditMessageText
reply_markup
  Input should be a valid dictionary or instance of InlineKeyboardMarkup [type=model_type, input_value=ReplyKeyboardMarkup(keybo...er=None, selective=None), input_type=ReplyKeyboardMarkup]
    For further information visit https://errors.pydantic.dev/2.9/v/model_type
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\vpn_key\payment.py", line 133, in request_photo
    await callback.message.edit_text(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\types\message.py", line 3896, in edit_text
    return EditMessageText(
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\pydantic\main.py", line 212, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for EditMessageText
reply_markup
  Input should be a valid dictionary or instance of InlineKeyboardMarkup [type=model_type, input_value=ReplyKeyboardMarkup(keybo...er=None, selective=None), input_type=ReplyKeyboardMarkup]
    For further information visit https://errors.pydantic.dev/2.9/v/model_type
2025-12-26 21:08:36,488 - aiogram.event - ERROR - Cause exception while process update id=385075246 by bot id=8399571083
ValidationError: 1 validation error for EditMessageText
reply_markup
  Input should be a valid dictionary or instance of InlineKeyboardMarkup [type=model_type, input_value=ReplyKeyboardMarkup(keybo...er=None, selective=None), input_type=ReplyKeyboardMarkup]
    For further information visit https://errors.pydantic.dev/2.9/v/model_type
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\vpn_key\payment.py", line 133, in request_photo
    await callback.message.edit_text(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\types\message.py", line 3896, in edit_text
    return EditMessageText(
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\pydantic\main.py", line 212, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for EditMessageText
reply_markup
  Input should be a valid dictionary or instance of InlineKeyboardMarkup [type=model_type, input_value=ReplyKeyboardMarkup(keybo...er=None, selective=None), input_type=ReplyKeyboardMarkup]
    For further information visit https://errors.pydantic.dev/2.9/v/model_type
2025-12-26 21:08:42,800 - aiogram.event - ERROR - Cause exception while process update id=385075247 by bot id=8399571083
ValidationError: 1 validation error for EditMessageText
reply_markup
  Input should be a valid dictionary or instance of InlineKeyboardMarkup [type=model_type, input_value=ReplyKeyboardMarkup(keybo...er=None, selective=None), input_type=ReplyKeyboardMarkup]
    For further information visit https://errors.pydantic.dev/2.9/v/model_type
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\vpn_key\payment.py", line 114, in mark_as_paid
    await callback.message.edit_text(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\types\message.py", line 3896, in edit_text
    return EditMessageText(
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\pydantic\main.py", line 212, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for EditMessageText
reply_markup
  Input should be a valid dictionary or instance of InlineKeyboardMarkup [type=model_type, input_value=ReplyKeyboardMarkup(keybo...er=None, selective=None), input_type=ReplyKeyboardMarkup]
    For further information visit https://errors.pydantic.dev/2.9/v/model_type
2025-12-26 21:09:53,214 - aiogram.event - ERROR - Cause exception while process update id=385075250 by bot id=8399571083
OperationalError: (sqlite3.OperationalError) no such column: vpn_keys.server_public_key
[SQL: SELECT vpn_keys.id, vpn_keys.key_name, vpn_keys.user_id, vpn_keys.private_key, vpn_keys.public_key, vpn_keys.server_public_key, vpn_keys.server_ip, vpn_keys.server_port, vpn_keys.server_endpoint, vpn_keys.ip_address, vpn_keys.config_data, vpn_keys.days, vpn_keys.created_at, vpn_keys.expires_at, vpn_keys.status, vpn_keys.payment_id 
FROM vpn_keys 
WHERE vpn_keys.user_id = ? AND vpn_keys.status = ? ORDER BY vpn_keys.created_at DESC]
[parameters: (1, 'active')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 146, in execute
    self._adapt_connection._handle_exception(error)
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 298, in _handle_exception
    raise error
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 128, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 125, in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 185, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiosqlite\cursor.py", line 40, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiosqlite\core.py", line 160, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiosqlite\core.py", line 63, in _connection_worker_thread
    result = function()
             ^^^^^^^^^^
sqlite3.OperationalError: no such column: vpn_keys.server_public_key

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\status.py", line 38, in cmd_my_status
    keys = await VPNKeyDAO.get_user_keys(session, user.id, active_only=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\services\dao.py", line 106, in get_user_keys
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 455, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 190, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 293, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 146, in execute
    self._adapt_connection._handle_exception(error)
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 298, in _handle_exception
    raise error
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 128, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 125, in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 185, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiosqlite\cursor.py", line 40, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiosqlite\core.py", line 160, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiosqlite\core.py", line 63, in _connection_worker_thread
    result = function()
             ^^^^^^^^^^
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: vpn_keys.server_public_key
[SQL: SELECT vpn_keys.id, vpn_keys.key_name, vpn_keys.user_id, vpn_keys.private_key, vpn_keys.public_key, vpn_keys.server_public_key, vpn_keys.server_ip, vpn_keys.server_port, vpn_keys.server_endpoint, vpn_keys.ip_address, vpn_keys.config_data, vpn_keys.days, vpn_keys.created_at, vpn_keys.expires_at, vpn_keys.status, vpn_keys.payment_id 
FROM vpn_keys 
WHERE vpn_keys.user_id = ? AND vpn_keys.status = ? ORDER BY vpn_keys.created_at DESC]
[parameters: (1, 'active')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-26 21:18:55,103 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-26 21:18:55,103 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8399571083)
2025-12-26 21:18:55,362 - src.services.scheduler - INFO - Планировщик остановлен
2025-12-26 21:18:55,362 - src.services.scheduler - INFO - Планировщик остановлен
2025-12-26 21:28:40,723 - __main__ - INFO - База данных создана
2025-12-26 21:28:47,223 - __main__ - CRITICAL - Критическая ошибка: Router is already attached to <Router '0x289835e2b90'>
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\run.py", line 73, in main
    await bot_main()
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\main.py", line 37, in main
    dp.include_router(router)
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 267, in include_router
    router.parent_router = self
    ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 228, in parent_router
    raise RuntimeError(msg)
RuntimeError: Router is already attached to <Router '0x289835e2b90'>
2025-12-26 21:30:46,481 - __main__ - INFO - База данных создана
2025-12-26 21:30:51,773 - __main__ - CRITICAL - Критическая ошибка: No module named 'src.handlers.purchase'
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\run.py", line 72, in main
    from src.main import main as bot_main
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\main.py", line 9, in <module>
    from src.bot.loader import setup_middlewares, setup_routers
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\loader.py", line 6, in <module>
    from src.handlers import start_router, admin_router, status_router
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\__init__.py", line 3, in <module>
    from .purchase import purchase_router
ModuleNotFoundError: No module named 'src.handlers.purchase'
2025-12-26 21:34:39,483 - __main__ - INFO - База данных создана
2025-12-26 21:34:44,728 - __main__ - CRITICAL - Критическая ошибка: cannot import name 'start_router' from 'src.handlers.start' (C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\start.py)
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\run.py", line 72, in main
    from src.main import main as bot_main
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\main.py", line 9, in <module>
    from src.bot.loader import setup_middlewares, setup_routers
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\loader.py", line 6, in <module>
    from src.handlers import start_router, admin_router, status_router
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\__init__.py", line 1, in <module>
    from .start import start_router
ImportError: cannot import name 'start_router' from 'src.handlers.start' (C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\start.py)
2025-12-26 21:39:54,439 - __main__ - INFO - База данных создана
2025-12-26 21:39:59,652 - __main__ - CRITICAL - Критическая ошибка: cannot import name 'status_router' from 'src.handlers.status' (C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\status.py)
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\run.py", line 72, in main
    from src.main import main as bot_main
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\main.py", line 9, in <module>
    from src.bot.loader import setup_middlewares, setup_routers
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\loader.py", line 7, in <module>
    from src.handlers.start import start_router
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\__init__.py", line 3, in <module>
    from .status import status_router
ImportError: cannot import name 'status_router' from 'src.handlers.status' (C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\status.py)
2025-12-26 21:42:14,984 - __main__ - INFO - База данных создана
2025-12-26 21:42:21,767 - vpn_bot - INFO - Уведомление отправлено админу 7672667340
2025-12-26 21:42:21,767 - src.services.scheduler - INFO - Планировщик запущен
2025-12-26 21:42:21,767 - vpn_bot - INFO - Планировщик запущен
2025-12-26 21:42:21,768 - vpn_bot - INFO - Бот запускается...
2025-12-26 21:42:21,769 - src.services.scheduler - INFO - Планировщик запущен
2025-12-26 21:42:21,791 - src.services.scheduler - ERROR - Ошибка в планировщике очистки: (sqlite3.OperationalError) no such column: vpn_keys.server_public_key
[SQL: SELECT vpn_keys.id, vpn_keys.key_name, vpn_keys.user_id, vpn_keys.private_key, vpn_keys.public_key, vpn_keys.server_public_key, vpn_keys.server_ip, vpn_keys.server_port, vpn_keys.server_endpoint, vpn_keys.ip_address, vpn_keys.config_data, vpn_keys.days, vpn_keys.created_at, vpn_keys.expires_at, vpn_keys.status, vpn_keys.payment_id 
FROM vpn_keys 
WHERE vpn_keys.status = ? AND vpn_keys.expires_at < ?]
[parameters: ('active', '2025-12-26 21:42:21.769887')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-26 21:53:15,764 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - Request timeout error
2025-12-26 21:53:15,764 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8399571083)
2025-12-26 21:53:38,080 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2025-12-26 21:53:38,080 - aiogram.dispatcher - WARNING - Sleep for 1.430698 seconds and try again... (tryings = 1, bot id = 8399571083)
2025-12-26 21:54:00,822 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2025-12-26 21:54:00,823 - aiogram.dispatcher - WARNING - Sleep for 1.905211 seconds and try again... (tryings = 2, bot id = 8399571083)
2025-12-26 21:54:24,033 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2025-12-26 21:54:24,033 - aiogram.dispatcher - WARNING - Sleep for 2.492850 seconds and try again... (tryings = 3, bot id = 8399571083)
2025-12-26 21:54:47,842 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2025-12-26 21:54:47,842 - aiogram.dispatcher - WARNING - Sleep for 3.316120 seconds and try again... (tryings = 4, bot id = 8399571083)
2025-12-26 21:55:12,450 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2025-12-26 21:55:12,450 - aiogram.dispatcher - WARNING - Sleep for 4.327649 seconds and try again... (tryings = 5, bot id = 8399571083)
2025-12-26 22:05:04,761 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-26 22:05:04,762 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8399571083)
2025-12-26 22:05:05,021 - src.services.scheduler - INFO - Планировщик остановлен
2025-12-26 22:05:05,021 - src.services.scheduler - INFO - Планировщик остановлен
2025-12-26 22:28:45,004 - __main__ - INFO - База данных создана
2025-12-26 22:28:51,380 - __main__ - CRITICAL - Критическая ошибка: Router is already attached to <Router '0x1edfd0127d0'>
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\run.py", line 73, in main
    await bot_main()
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\main.py", line 37, in main
    dp.include_router(router)
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 267, in include_router
    router.parent_router = self
    ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 228, in parent_router
    raise RuntimeError(msg)
RuntimeError: Router is already attached to <Router '0x1edfd0127d0'>
2025-12-26 22:41:33,193 - __main__ - INFO - База данных создана
2025-12-26 22:41:42,066 - __main__ - INFO - База данных создана
2025-12-26 22:41:48,675 - vpn_bot - INFO - Уведомление отправлено админу 7672667340
2025-12-26 22:41:48,676 - src.services.scheduler - INFO - Планировщик запущен
2025-12-26 22:41:48,676 - vpn_bot - INFO - Планировщик запущен
2025-12-26 22:41:48,677 - vpn_bot - INFO - Бот запускается...
2025-12-26 22:41:48,677 - src.services.scheduler - INFO - Планировщик запущен
2025-12-26 22:41:48,696 - src.services.scheduler - ERROR - Ошибка в планировщике очистки: (sqlite3.OperationalError) no such column: vpn_keys.server_public_key
[SQL: SELECT vpn_keys.id, vpn_keys.key_name, vpn_keys.user_id, vpn_keys.private_key, vpn_keys.public_key, vpn_keys.server_public_key, vpn_keys.server_ip, vpn_keys.server_port, vpn_keys.server_endpoint, vpn_keys.ip_address, vpn_keys.config_data, vpn_keys.days, vpn_keys.created_at, vpn_keys.expires_at, vpn_keys.status, vpn_keys.payment_id 
FROM vpn_keys 
WHERE vpn_keys.status = ? AND vpn_keys.expires_at < ?]
[parameters: ('active', '2025-12-26 22:41:48.678780')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-26 22:44:22,913 - aiogram.event - ERROR - Cause exception while process update id=385075278 by bot id=8399571083
AttributeError: type object 'VPNKeyDAO' has no attribute 'get_user_keys'
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\status.py", line 40, in cmd_my_status
    keys = await VPNKeyDAO.get_user_keys(session, user.id, active_only=True)
                 ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: type object 'VPNKeyDAO' has no attribute 'get_user_keys'
2025-12-26 23:11:59,776 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-26 23:11:59,776 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8399571083)
2025-12-26 23:12:00,039 - src.services.scheduler - INFO - Планировщик остановлен
2025-12-26 23:12:00,039 - src.services.scheduler - INFO - Планировщик остановлен
2025-12-26 23:12:02,399 - __main__ - INFO - База данных создана
2025-12-26 23:12:09,053 - vpn_bot - INFO - Уведомление отправлено админу 7672667340
2025-12-26 23:12:09,053 - src.services.scheduler - INFO - Планировщик запущен
2025-12-26 23:12:09,053 - vpn_bot - INFO - Планировщик запущен
2025-12-26 23:12:09,054 - vpn_bot - INFO - Бот запускается...
2025-12-26 23:12:09,055 - src.services.scheduler - INFO - Планировщик запущен
2025-12-26 23:12:09,074 - src.services.scheduler - ERROR - Ошибка в планировщике очистки: (sqlite3.OperationalError) no such column: vpn_keys.server_public_key
[SQL: SELECT vpn_keys.id, vpn_keys.key_name, vpn_keys.user_id, vpn_keys.private_key, vpn_keys.public_key, vpn_keys.server_public_key, vpn_keys.server_ip, vpn_keys.server_port, vpn_keys.server_endpoint, vpn_keys.ip_address, vpn_keys.config_data, vpn_keys.days, vpn_keys.created_at, vpn_keys.expires_at, vpn_keys.status, vpn_keys.payment_id 
FROM vpn_keys 
WHERE vpn_keys.status = ? AND vpn_keys.expires_at < ?]
[parameters: ('active', '2025-12-26 23:12:09.055307')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-26 23:12:16,638 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-26 23:12:16,638 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8399571083)
2025-12-26 23:12:16,902 - src.services.scheduler - INFO - Планировщик остановлен
2025-12-26 23:12:16,902 - src.services.scheduler - INFO - Планировщик остановлен
2025-12-26 23:12:45,431 - __main__ - INFO - База данных создана
2025-12-26 23:12:52,274 - vpn_bot - ERROR - Не удалось уведомить админа 625007762: Telegram server says - Bad Request: chat not found
2025-12-26 23:12:52,275 - src.services.scheduler - INFO - Планировщик запущен
2025-12-26 23:12:52,275 - vpn_bot - INFO - Планировщик запущен
2025-12-26 23:12:52,275 - vpn_bot - INFO - Бот запускается...
2025-12-26 23:12:52,276 - src.services.scheduler - INFO - Планировщик запущен
2025-12-26 23:12:52,296 - src.services.scheduler - ERROR - Ошибка в планировщике очистки: (sqlite3.OperationalError) no such column: vpn_keys.server_public_key
[SQL: SELECT vpn_keys.id, vpn_keys.key_name, vpn_keys.user_id, vpn_keys.private_key, vpn_keys.public_key, vpn_keys.server_public_key, vpn_keys.server_ip, vpn_keys.server_port, vpn_keys.server_endpoint, vpn_keys.ip_address, vpn_keys.config_data, vpn_keys.days, vpn_keys.created_at, vpn_keys.expires_at, vpn_keys.status, vpn_keys.payment_id 
FROM vpn_keys 
WHERE vpn_keys.status = ? AND vpn_keys.expires_at < ?]
[parameters: ('active', '2025-12-26 23:12:52.276607')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-26 23:13:05,279 - aiogram.event - ERROR - Cause exception while process update id=385075289 by bot id=8399571083
NameError: name 'PaymentDAO' is not defined
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\vpn_key\purchase.py", line 178, in process_payment_selection
    payment = await PaymentDAO.create_payment(
                    ^^^^^^^^^^
NameError: name 'PaymentDAO' is not defined
2025-12-26 23:17:21,665 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-26 23:17:21,666 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8399571083)
2025-12-26 23:17:21,928 - src.services.scheduler - INFO - Планировщик остановлен
2025-12-26 23:17:21,928 - src.services.scheduler - INFO - Планировщик остановлен
2025-12-26 23:17:24,736 - __main__ - INFO - База данных создана
2025-12-26 23:17:31,691 - vpn_bot - ERROR - Не удалось уведомить админа 625007762: Telegram server says - Bad Request: chat not found
2025-12-26 23:17:31,692 - src.services.scheduler - INFO - Планировщик запущен
2025-12-26 23:17:31,692 - vpn_bot - INFO - Планировщик запущен
2025-12-26 23:17:31,692 - vpn_bot - INFO - Бот запускается...
2025-12-26 23:17:31,693 - src.services.scheduler - INFO - Планировщик запущен
2025-12-26 23:17:31,712 - src.services.scheduler - ERROR - Ошибка в планировщике очистки: (sqlite3.OperationalError) no such column: vpn_keys.server_public_key
[SQL: SELECT vpn_keys.id, vpn_keys.key_name, vpn_keys.user_id, vpn_keys.private_key, vpn_keys.public_key, vpn_keys.server_public_key, vpn_keys.server_ip, vpn_keys.server_port, vpn_keys.server_endpoint, vpn_keys.ip_address, vpn_keys.config_data, vpn_keys.days, vpn_keys.created_at, vpn_keys.expires_at, vpn_keys.status, vpn_keys.payment_id 
FROM vpn_keys 
WHERE vpn_keys.status = ? AND vpn_keys.expires_at < ?]
[parameters: ('active', '2025-12-26 23:17:31.694714')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-26 23:17:42,640 - aiogram.event - ERROR - Cause exception while process update id=385075292 by bot id=8399571083
TypeError: PaymentDAO.create() got an unexpected keyword argument 'days'
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\vpn_key\purchase.py", line 179, in process_payment_selection
    payment = await PaymentDAO.create(
                    ^^^^^^^^^^^^^^^^^^
TypeError: PaymentDAO.create() got an unexpected keyword argument 'days'
2025-12-26 23:17:59,908 - aiogram.event - ERROR - Cause exception while process update id=385075298 by bot id=8399571083
TypeError: PaymentDAO.create() got an unexpected keyword argument 'days'
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\vpn_key\purchase.py", line 179, in process_payment_selection
    payment = await PaymentDAO.create(
                    ^^^^^^^^^^^^^^^^^^
TypeError: PaymentDAO.create() got an unexpected keyword argument 'days'
2025-12-26 23:23:39,857 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-26 23:23:39,858 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8399571083)
2025-12-26 23:23:40,115 - src.services.scheduler - INFO - Планировщик остановлен
2025-12-26 23:23:40,115 - src.services.scheduler - INFO - Планировщик остановлен
2025-12-26 23:28:17,421 - __main__ - INFO - База данных создана
2025-12-26 23:28:25,358 - vpn_bot - ERROR - Не удалось уведомить админа 625007762: Telegram server says - Bad Request: chat not found
2025-12-26 23:28:25,359 - src.services.scheduler - INFO - Планировщик запущен
2025-12-26 23:28:25,359 - vpn_bot - INFO - Планировщик запущен
2025-12-26 23:28:25,360 - vpn_bot - INFO - Бот запускается...
2025-12-26 23:28:25,361 - src.services.scheduler - INFO - Планировщик запущен
2025-12-26 23:28:25,383 - src.services.scheduler - ERROR - Ошибка в планировщике очистки: (sqlite3.OperationalError) no such column: vpn_keys.server_public_key
[SQL: SELECT vpn_keys.id, vpn_keys.key_name, vpn_keys.user_id, vpn_keys.private_key, vpn_keys.public_key, vpn_keys.server_public_key, vpn_keys.server_ip, vpn_keys.server_port, vpn_keys.server_endpoint, vpn_keys.ip_address, vpn_keys.config_data, vpn_keys.days, vpn_keys.created_at, vpn_keys.expires_at, vpn_keys.status, vpn_keys.payment_id 
FROM vpn_keys 
WHERE vpn_keys.status = ? AND vpn_keys.expires_at < ?]
[parameters: ('active', '2025-12-26 23:28:25.362396')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-26 23:28:52,396 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-26 23:28:52,396 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8399571083)
2025-12-26 23:28:52,652 - src.services.scheduler - INFO - Планировщик остановлен
2025-12-26 23:28:52,652 - src.services.scheduler - INFO - Планировщик остановлен
2025-12-26 23:29:16,887 - __main__ - INFO - База данных создана
2025-12-26 23:29:23,705 - vpn_bot - INFO - Уведомление отправлено админу 7672667340
2025-12-26 23:29:23,705 - src.services.scheduler - INFO - Планировщик запущен
2025-12-26 23:29:23,705 - vpn_bot - INFO - Планировщик запущен
2025-12-26 23:29:23,706 - vpn_bot - INFO - Бот запускается...
2025-12-26 23:29:23,706 - src.services.scheduler - INFO - Планировщик запущен
2025-12-26 23:29:23,725 - src.services.scheduler - ERROR - Ошибка в планировщике очистки: (sqlite3.OperationalError) no such column: vpn_keys.server_public_key
[SQL: SELECT vpn_keys.id, vpn_keys.key_name, vpn_keys.user_id, vpn_keys.private_key, vpn_keys.public_key, vpn_keys.server_public_key, vpn_keys.server_ip, vpn_keys.server_port, vpn_keys.server_endpoint, vpn_keys.ip_address, vpn_keys.config_data, vpn_keys.days, vpn_keys.created_at, vpn_keys.expires_at, vpn_keys.status, vpn_keys.payment_id 
FROM vpn_keys 
WHERE vpn_keys.status = ? AND vpn_keys.expires_at < ?]
[parameters: ('active', '2025-12-26 23:29:23.707516')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-26 23:43:59,480 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-26 23:43:59,480 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8399571083)
2025-12-26 23:43:59,734 - src.services.scheduler - INFO - Планировщик остановлен
2025-12-26 23:43:59,734 - src.services.scheduler - INFO - Планировщик остановлен
2025-12-26 23:59:15,128 - __main__ - INFO - База данных создана
2025-12-26 23:59:23,508 - vpn_bot - INFO - Уведомление отправлено админу 7672667340
2025-12-26 23:59:23,509 - src.services.scheduler - INFO - Планировщик запущен
2025-12-26 23:59:23,509 - vpn_bot - INFO - Планировщик запущен
2025-12-26 23:59:23,510 - vpn_bot - INFO - Бот запускается...
2025-12-26 23:59:23,511 - src.services.scheduler - INFO - Планировщик запущен
2025-12-26 23:59:23,536 - src.services.scheduler - ERROR - Ошибка в планировщике очистки: (sqlite3.OperationalError) no such column: vpn_keys.server_public_key
[SQL: SELECT vpn_keys.id, vpn_keys.key_name, vpn_keys.user_id, vpn_keys.private_key, vpn_keys.public_key, vpn_keys.server_public_key, vpn_keys.server_ip, vpn_keys.server_port, vpn_keys.server_endpoint, vpn_keys.ip_address, vpn_keys.config_data, vpn_keys.days, vpn_keys.created_at, vpn_keys.expires_at, vpn_keys.status, vpn_keys.payment_id 
FROM vpn_keys 
WHERE vpn_keys.status = ? AND vpn_keys.expires_at < ?]
[parameters: ('active', '2025-12-26 23:59:23.512315')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-27 00:01:14,292 - aiogram.event - ERROR - Cause exception while process update id=385075323 by bot id=8399571083
ImportError: cannot import name 'PaymentDAO' from 'src.services.database' (C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\services\database.py)
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\admin\panel.py", line 66, in show_confirmations
    from src.services.database import PaymentDAO, get_session
ImportError: cannot import name 'PaymentDAO' from 'src.services.database' (C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\services\database.py)
2025-12-27 00:03:59,482 - aiogram.event - ERROR - Cause exception while process update id=385075327 by bot id=8399571083
TelegramBadRequest: Telegram server says - Bad Request: message is not modified: specified new message content and reply markup are exactly the same as a current content and reply markup of the message
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\admin\panel.py", line 37, in back_to_main_menu
    await callback.message.edit_text(
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\methods\base.py", line 84, in emit
    return await bot(self)
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\client\bot.py", line 485, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\client\session\base.py", line 259, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\client\session\aiohttp.py", line 177, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\client\session\base.py", line 121, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: message is not modified: specified new message content and reply markup are exactly the same as a current content and reply markup of the message
2025-12-27 00:04:23,807 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-27 00:04:23,808 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8399571083)
2025-12-27 00:04:24,072 - src.services.scheduler - INFO - Планировщик остановлен
2025-12-27 00:04:24,072 - src.services.scheduler - INFO - Планировщик остановлен
2025-12-27 00:19:36,169 - __main__ - INFO - База данных создана
2025-12-27 00:19:41,644 - __main__ - CRITICAL - Критическая ошибка: cannot import name 'vpn_key_router' from 'src.handlers.vpn_key' (C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\vpn_key\__init__.py)
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\run.py", line 72, in main
    from src.main import main as bot_main
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\main.py", line 9, in <module>
    from src.bot.loader import setup_middlewares, setup_routers
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\loader.py", line 10, in <module>
    from src.handlers.vpn_key import vpn_key_router
ImportError: cannot import name 'vpn_key_router' from 'src.handlers.vpn_key' (C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\vpn_key\__init__.py)
2025-12-27 00:19:59,066 - __main__ - INFO - База данных создана
2025-12-27 00:20:06,059 - vpn_bot - INFO - Уведомление отправлено админу 7672667340
2025-12-27 00:20:06,060 - src.services.scheduler - INFO - Планировщик запущен
2025-12-27 00:20:06,060 - vpn_bot - INFO - Планировщик запущен
2025-12-27 00:20:06,060 - vpn_bot - INFO - Бот запускается...
2025-12-27 00:20:06,061 - src.services.scheduler - INFO - Планировщик запущен
2025-12-27 00:20:06,080 - src.services.scheduler - ERROR - Ошибка в планировщике очистки: (sqlite3.OperationalError) no such column: vpn_keys.server_public_key
[SQL: SELECT vpn_keys.id, vpn_keys.key_name, vpn_keys.user_id, vpn_keys.private_key, vpn_keys.public_key, vpn_keys.server_public_key, vpn_keys.server_ip, vpn_keys.server_port, vpn_keys.server_endpoint, vpn_keys.ip_address, vpn_keys.config_data, vpn_keys.days, vpn_keys.created_at, vpn_keys.expires_at, vpn_keys.status, vpn_keys.payment_id 
FROM vpn_keys 
WHERE vpn_keys.status = ? AND vpn_keys.expires_at < ?]
[parameters: ('active', '2025-12-27 00:20:06.062963')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-27 00:20:38,843 - aiogram.event - ERROR - Cause exception while process update id=385075329 by bot id=8399571083
ImportError: cannot import name 'PaymentDAO' from 'src.services.database' (C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\services\database.py)
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\admin\panel.py", line 66, in show_confirmations
    from src.services.database import PaymentDAO, get_session
ImportError: cannot import name 'PaymentDAO' from 'src.services.database' (C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\services\database.py)
2025-12-27 00:31:24,907 - __main__ - INFO - База данных создана
2025-12-27 00:31:39,211 - vpn_bot - INFO - Уведомление отправлено админу 7672667340
2025-12-27 00:31:39,212 - src.services.scheduler - INFO - Планировщик запущен
2025-12-27 00:31:39,212 - vpn_bot - INFO - Планировщик запущен
2025-12-27 00:31:39,212 - vpn_bot - INFO - Бот запускается...
2025-12-27 00:31:39,213 - src.services.scheduler - INFO - Планировщик запущен
2025-12-27 00:31:39,235 - src.services.scheduler - ERROR - Ошибка в планировщике очистки: (sqlite3.OperationalError) no such column: vpn_keys.server_public_key
[SQL: SELECT vpn_keys.id, vpn_keys.key_name, vpn_keys.user_id, vpn_keys.private_key, vpn_keys.public_key, vpn_keys.server_public_key, vpn_keys.server_ip, vpn_keys.server_port, vpn_keys.server_endpoint, vpn_keys.ip_address, vpn_keys.config_data, vpn_keys.days, vpn_keys.created_at, vpn_keys.expires_at, vpn_keys.status, vpn_keys.payment_id 
FROM vpn_keys 
WHERE vpn_keys.status = ? AND vpn_keys.expires_at < ?]
[parameters: ('active', '2025-12-27 00:31:39.214288')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-27 00:31:49,391 - aiogram.event - ERROR - Cause exception while process update id=385075333 by bot id=8399571083
ImportError: cannot import name 'PaymentDAO' from 'src.services.database' (C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\services\database.py)
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\admin\panel.py", line 66, in show_confirmations
    from src.services.database import PaymentDAO, get_session
ImportError: cannot import name 'PaymentDAO' from 'src.services.database' (C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\services\database.py)
2025-12-27 00:31:53,663 - aiogram.event - ERROR - Cause exception while process update id=385075336 by bot id=8399571083
ImportError: cannot import name 'PaymentDAO' from 'src.services.database' (C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\services\database.py)
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\admin\panel.py", line 66, in show_confirmations
    from src.services.database import PaymentDAO, get_session
ImportError: cannot import name 'PaymentDAO' from 'src.services.database' (C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\services\database.py)
2025-12-27 00:31:54,906 - aiogram.event - ERROR - Cause exception while process update id=385075339 by bot id=8399571083
TelegramBadRequest: Telegram server says - Bad Request: message is not modified: specified new message content and reply markup are exactly the same as a current content and reply markup of the message
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\admin\panel.py", line 37, in back_to_main_menu
    await callback.message.edit_text(
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\methods\base.py", line 84, in emit
    return await bot(self)
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\client\bot.py", line 485, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\client\session\base.py", line 259, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\client\session\aiohttp.py", line 177, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\client\session\base.py", line 121, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: message is not modified: specified new message content and reply markup are exactly the same as a current content and reply markup of the message
2025-12-27 00:32:07,620 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-27 00:32:07,620 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8399571083)
2025-12-27 00:32:07,873 - src.services.scheduler - INFO - Планировщик остановлен
2025-12-27 00:32:07,873 - src.services.scheduler - INFO - Планировщик остановлен
2025-12-27 00:33:43,773 - __main__ - INFO - База данных создана
2025-12-27 00:33:50,746 - vpn_bot - INFO - Уведомление отправлено админу 7672667340
2025-12-27 00:33:50,747 - vpn_bot - INFO - Планировщик временно отключен (ошибка структуры БД)
2025-12-27 00:33:50,747 - vpn_bot - INFO - Бот запускается...
2025-12-27 00:33:56,123 - aiogram.event - ERROR - Cause exception while process update id=385075341 by bot id=8399571083
ImportError: cannot import name 'PaymentDAO' from 'src.services.database' (C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\services\database.py)
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\admin\panel.py", line 66, in show_confirmations
    from src.services.database import PaymentDAO, get_session
ImportError: cannot import name 'PaymentDAO' from 'src.services.database' (C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\services\database.py)
2025-12-27 00:40:39,857 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-27 00:40:39,857 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8399571083)
2025-12-27 00:46:35,756 - __main__ - INFO - База данных создана
2025-12-27 00:46:41,237 - __main__ - CRITICAL - Критическая ошибка: cannot import name 'admin_router' from partially initialized module 'src.handlers.admin' (most likely due to a circular import) (C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\admin\__init__.py)
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\run.py", line 72, in main
    from src.main import main as bot_main
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\main.py", line 9, in <module>
    from src.bot.loader import setup_middlewares, setup_routers
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\loader.py", line 5, in <module>
    from src.handlers.start import start_router
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\__init__.py", line 2, in <module>
    from .admin import admin_router
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\admin\__init__.py", line 4, in <module>
    from .panel import router as panel_router
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\admin\panel.py", line 9, in <module>
    from src.handlers.admin import admin_router
ImportError: cannot import name 'admin_router' from partially initialized module 'src.handlers.admin' (most likely due to a circular import) (C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\admin\__init__.py)
2025-12-27 00:48:36,540 - __main__ - INFO - База данных создана
2025-12-27 00:48:42,819 - vpn_bot - INFO - Уведомление отправлено админу 7672667340
2025-12-27 00:48:42,820 - vpn_bot - INFO - Планировщик временно отключен (ошибка структуры БД)
2025-12-27 00:48:42,820 - vpn_bot - INFO - Бот запускается...
2025-12-27 00:48:48,331 - aiogram.event - ERROR - Cause exception while process update id=385075343 by bot id=8399571083
ImportError: cannot import name 'PaymentDAO' from 'src.services.database' (C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\services\database.py)
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\admin\panel.py", line 63, in show_confirmations
    from src.services.database import PaymentDAO, get_session
ImportError: cannot import name 'PaymentDAO' from 'src.services.database' (C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\services\database.py)
2025-12-27 00:48:52,696 - aiogram.event - ERROR - Cause exception while process update id=385075347 by bot id=8399571083
TelegramBadRequest: Telegram server says - Bad Request: message is not modified: specified new message content and reply markup are exactly the same as a current content and reply markup of the message
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\admin\panel.py", line 37, in back_to_main_menu
    await callback.message.edit_text(
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\methods\base.py", line 84, in emit
    return await bot(self)
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\client\bot.py", line 485, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\client\session\base.py", line 259, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\client\session\aiohttp.py", line 177, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\client\session\base.py", line 121, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: message is not modified: specified new message content and reply markup are exactly the same as a current content and reply markup of the message
2025-12-27 00:50:59,266 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-27 00:50:59,266 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8399571083)
2025-12-27 00:51:02,024 - __main__ - INFO - База данных создана
2025-12-27 00:51:08,702 - vpn_bot - INFO - Уведомление отправлено админу 7672667340
2025-12-27 00:51:08,703 - vpn_bot - INFO - Планировщик временно отключен (ошибка структуры БД)
2025-12-27 00:51:08,704 - vpn_bot - INFO - Бот запускается...
2025-12-27 00:51:12,140 - aiogram.event - ERROR - Cause exception while process update id=385075349 by bot id=8399571083
ImportError: cannot import name 'PaymentDAO' from 'src.services.database' (C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\services\database.py)
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\admin\panel.py", line 67, in show_confirmations
    from src.services.database import PaymentDAO, get_session
ImportError: cannot import name 'PaymentDAO' from 'src.services.database' (C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\services\database.py)
2025-12-27 00:52:09,016 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-27 00:52:09,016 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8399571083)
2025-12-27 00:52:29,885 - __main__ - INFO - База данных создана
2025-12-27 00:52:36,560 - vpn_bot - INFO - Уведомление отправлено админу 7672667340
2025-12-27 00:52:36,560 - vpn_bot - INFO - Планировщик временно отключен (ошибка структуры БД)
2025-12-27 00:52:36,561 - vpn_bot - INFO - Бот запускается...
2025-12-27 00:52:44,588 - aiogram.event - ERROR - Cause exception while process update id=385075351 by bot id=8399571083
AttributeError: type object 'PaymentDAO' has no attribute 'get_pending_payments'
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\admin\panel.py", line 42, in show_confirmations
    pending_payments = await PaymentDAO.get_pending_payments(session)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: type object 'PaymentDAO' has no attribute 'get_pending_payments'
2025-12-27 00:56:24,840 - __main__ - INFO - База данных создана
2025-12-27 00:56:31,933 - vpn_bot - INFO - Уведомление отправлено админу 7672667340
2025-12-27 00:56:31,934 - vpn_bot - INFO - Планировщик временно отключен (ошибка структуры БД)
2025-12-27 00:56:31,934 - vpn_bot - INFO - Бот запускается...
2025-12-27 00:56:32,167 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:56:32,168 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8399571083)
2025-12-27 00:56:36,315 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:56:36,316 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8399571083)
2025-12-27 00:56:37,446 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:56:37,446 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8399571083)
2025-12-27 00:56:41,570 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:56:41,571 - aiogram.dispatcher - WARNING - Sleep for 1.423737 seconds and try again... (tryings = 1, bot id = 8399571083)
2025-12-27 00:56:43,130 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:56:43,130 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8399571083)
2025-12-27 00:56:47,247 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:56:47,247 - aiogram.dispatcher - WARNING - Sleep for 1.874371 seconds and try again... (tryings = 2, bot id = 8399571083)
2025-12-27 00:56:49,237 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:56:49,237 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8399571083)
2025-12-27 00:56:53,359 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:56:53,359 - aiogram.dispatcher - WARNING - Sleep for 2.567444 seconds and try again... (tryings = 3, bot id = 8399571083)
2025-12-27 00:56:55,405 - aiogram.event - ERROR - Cause exception while process update id=385075358 by bot id=8399571083
AttributeError: type object 'PaymentDAO' has no attribute 'get_pending_payments'
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\admin\panel.py", line 42, in show_confirmations
    result = await session.execute(stmt)
                             ^^^^^^^^^^^^
AttributeError: type object 'PaymentDAO' has no attribute 'get_pending_payments'
2025-12-27 00:56:56,053 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:56:56,053 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8399571083)
2025-12-27 00:57:00,179 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:57:00,180 - aiogram.dispatcher - WARNING - Sleep for 3.289999 seconds and try again... (tryings = 4, bot id = 8399571083)
2025-12-27 00:57:03,588 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:57:03,588 - aiogram.dispatcher - WARNING - Sleep for 1.264059 seconds and try again... (tryings = 1, bot id = 8399571083)
2025-12-27 00:57:07,981 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:57:07,981 - aiogram.dispatcher - WARNING - Sleep for 4.223653 seconds and try again... (tryings = 5, bot id = 8399571083)
2025-12-27 00:57:12,327 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:57:12,327 - aiogram.dispatcher - WARNING - Sleep for 1.557491 seconds and try again... (tryings = 2, bot id = 8399571083)
2025-12-27 00:57:17,017 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:57:17,018 - aiogram.dispatcher - WARNING - Sleep for 4.944172 seconds and try again... (tryings = 6, bot id = 8399571083)
2025-12-27 00:57:22,083 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:57:22,083 - aiogram.dispatcher - WARNING - Sleep for 2.193492 seconds and try again... (tryings = 3, bot id = 8399571083)
2025-12-27 00:57:27,403 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:57:27,403 - aiogram.dispatcher - WARNING - Sleep for 4.935170 seconds and try again... (tryings = 7, bot id = 8399571083)
2025-12-27 00:57:32,461 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:57:32,461 - aiogram.dispatcher - WARNING - Sleep for 2.837931 seconds and try again... (tryings = 4, bot id = 8399571083)
2025-12-27 00:57:38,418 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:57:38,418 - aiogram.dispatcher - WARNING - Sleep for 4.985475 seconds and try again... (tryings = 8, bot id = 8399571083)
2025-12-27 00:57:43,531 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:57:43,531 - aiogram.dispatcher - WARNING - Sleep for 3.629395 seconds and try again... (tryings = 5, bot id = 8399571083)
2025-12-27 00:57:47,295 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:57:47,296 - aiogram.dispatcher - WARNING - Sleep for 4.796834 seconds and try again... (tryings = 9, bot id = 8399571083)
2025-12-27 00:57:52,203 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:57:52,203 - aiogram.dispatcher - WARNING - Sleep for 4.744980 seconds and try again... (tryings = 6, bot id = 8399571083)
2025-12-27 00:57:57,069 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:57:57,069 - aiogram.dispatcher - WARNING - Sleep for 4.716985 seconds and try again... (tryings = 10, bot id = 8399571083)
2025-12-27 00:58:01,910 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:58:01,911 - aiogram.dispatcher - WARNING - Sleep for 4.893099 seconds and try again... (tryings = 7, bot id = 8399571083)
2025-12-27 00:58:06,934 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:58:06,934 - aiogram.dispatcher - WARNING - Sleep for 4.997303 seconds and try again... (tryings = 11, bot id = 8399571083)
2025-12-27 00:58:11,783 - aiogram.event - ERROR - Cause exception while process update id=385075359 by bot id=8399571083
AttributeError: type object 'PaymentDAO' has no attribute 'get_pending_payments'
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 23, in __call__
    raise e
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\database.py", line 18, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\middlewares\throttling.py", line 26, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\admin\panel.py", line 42, in show_confirmations
    result = await session.execute(stmt)
                             ^^^^^^^^^^^^
AttributeError: type object 'PaymentDAO' has no attribute 'get_pending_payments'
2025-12-27 00:58:12,063 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:58:12,063 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8399571083)
2025-12-27 00:58:16,182 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:58:16,182 - aiogram.dispatcher - WARNING - Sleep for 4.933805 seconds and try again... (tryings = 12, bot id = 8399571083)
2025-12-27 00:58:21,239 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:58:21,239 - aiogram.dispatcher - WARNING - Sleep for 1.367403 seconds and try again... (tryings = 1, bot id = 8399571083)
2025-12-27 00:58:25,723 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:58:25,723 - aiogram.dispatcher - WARNING - Sleep for 4.951331 seconds and try again... (tryings = 13, bot id = 8399571083)
2025-12-27 00:58:30,813 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:58:30,813 - aiogram.dispatcher - WARNING - Sleep for 1.990035 seconds and try again... (tryings = 2, bot id = 8399571083)
2025-12-27 00:58:35,922 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:58:35,922 - aiogram.dispatcher - WARNING - Sleep for 4.925763 seconds and try again... (tryings = 14, bot id = 8399571083)
2025-12-27 00:58:40,958 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:58:40,958 - aiogram.dispatcher - WARNING - Sleep for 2.644943 seconds and try again... (tryings = 3, bot id = 8399571083)
2025-12-27 00:58:46,727 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:58:46,727 - aiogram.dispatcher - WARNING - Sleep for 4.976229 seconds and try again... (tryings = 15, bot id = 8399571083)
2025-12-27 00:58:51,827 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:58:51,827 - aiogram.dispatcher - WARNING - Sleep for 3.549911 seconds and try again... (tryings = 4, bot id = 8399571083)
2025-12-27 00:58:55,496 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:58:55,497 - aiogram.dispatcher - WARNING - Sleep for 4.712229 seconds and try again... (tryings = 16, bot id = 8399571083)
2025-12-27 00:59:00,334 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:59:00,334 - aiogram.dispatcher - WARNING - Sleep for 4.540213 seconds and try again... (tryings = 5, bot id = 8399571083)
2025-12-27 00:59:04,991 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:59:04,992 - aiogram.dispatcher - WARNING - Sleep for 4.993239 seconds and try again... (tryings = 17, bot id = 8399571083)
2025-12-27 00:59:10,119 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:59:10,119 - aiogram.dispatcher - WARNING - Sleep for 4.941541 seconds and try again... (tryings = 6, bot id = 8399571083)
2025-12-27 00:59:15,197 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-12-27 00:59:15,197 - aiogram.dispatcher - WARNING - Sleep for 4.981624 seconds and try again... (tryings = 18, bot id = 8399571083)
2025-12-27 01:00:32,741 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:00:32,741 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8399571083)
2025-12-27 01:00:35,548 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:00:35,548 - aiogram.dispatcher - WARNING - Sleep for 1.406354 seconds and try again... (tryings = 1, bot id = 8399571083)
2025-12-27 01:00:37,080 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:00:37,080 - aiogram.dispatcher - WARNING - Sleep for 1.909409 seconds and try again... (tryings = 2, bot id = 8399571083)
2025-12-27 01:00:39,102 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:00:39,102 - aiogram.dispatcher - WARNING - Sleep for 2.334812 seconds and try again... (tryings = 3, bot id = 8399571083)
2025-12-27 01:00:41,550 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:00:41,550 - aiogram.dispatcher - WARNING - Sleep for 3.106567 seconds and try again... (tryings = 4, bot id = 8399571083)
2025-12-27 01:00:44,766 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:00:44,766 - aiogram.dispatcher - WARNING - Sleep for 4.106979 seconds and try again... (tryings = 5, bot id = 8399571083)
2025-12-27 01:00:48,988 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:00:48,988 - aiogram.dispatcher - WARNING - Sleep for 4.975680 seconds and try again... (tryings = 6, bot id = 8399571083)
2025-12-27 01:00:54,086 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:00:54,086 - aiogram.dispatcher - WARNING - Sleep for 4.958349 seconds and try again... (tryings = 7, bot id = 8399571083)
2025-12-27 01:00:59,164 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:00:59,164 - aiogram.dispatcher - WARNING - Sleep for 4.923342 seconds and try again... (tryings = 8, bot id = 8399571083)
2025-12-27 01:01:04,199 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:01:04,199 - aiogram.dispatcher - WARNING - Sleep for 4.911393 seconds and try again... (tryings = 9, bot id = 8399571083)
2025-12-27 01:01:09,225 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:01:09,225 - aiogram.dispatcher - WARNING - Sleep for 4.901339 seconds and try again... (tryings = 10, bot id = 8399571083)
2025-12-27 01:01:14,255 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:01:14,255 - aiogram.dispatcher - WARNING - Sleep for 5.145948 seconds and try again... (tryings = 11, bot id = 8399571083)
2025-12-27 01:01:19,520 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:01:19,521 - aiogram.dispatcher - WARNING - Sleep for 4.978564 seconds and try again... (tryings = 12, bot id = 8399571083)
2025-12-27 01:01:24,617 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:01:24,617 - aiogram.dispatcher - WARNING - Sleep for 4.950949 seconds and try again... (tryings = 13, bot id = 8399571083)
2025-12-27 01:01:29,282 - __main__ - INFO - База данных создана
2025-12-27 01:01:29,686 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:01:29,686 - aiogram.dispatcher - WARNING - Sleep for 5.119670 seconds and try again... (tryings = 14, bot id = 8399571083)
2025-12-27 01:01:34,929 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:01:34,929 - aiogram.dispatcher - WARNING - Sleep for 5.051205 seconds and try again... (tryings = 15, bot id = 8399571083)
2025-12-27 01:01:38,565 - vpn_bot - ERROR - Не удалось уведомить админа 7672667340: Telegram server says - Bad Request: chat not found
2025-12-27 01:01:38,566 - vpn_bot - INFO - Планировщик временно отключен (ошибка структуры БД)
2025-12-27 01:01:38,566 - vpn_bot - INFO - Бот запускается...
2025-12-27 01:01:40,105 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:01:40,105 - aiogram.dispatcher - WARNING - Sleep for 5.007582 seconds and try again... (tryings = 16, bot id = 8399571083)
2025-12-27 01:01:45,213 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:01:45,213 - aiogram.dispatcher - WARNING - Sleep for 5.086586 seconds and try again... (tryings = 17, bot id = 8399571083)
2025-12-27 01:01:50,422 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:01:50,422 - aiogram.dispatcher - WARNING - Sleep for 5.064271 seconds and try again... (tryings = 18, bot id = 8399571083)
2025-12-27 01:01:55,609 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:01:55,609 - aiogram.dispatcher - WARNING - Sleep for 5.012034 seconds and try again... (tryings = 19, bot id = 8399571083)
2025-12-27 01:02:00,740 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:02:00,741 - aiogram.dispatcher - WARNING - Sleep for 5.128676 seconds and try again... (tryings = 20, bot id = 8399571083)
2025-12-27 01:02:05,992 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:02:05,993 - aiogram.dispatcher - WARNING - Sleep for 4.982384 seconds and try again... (tryings = 21, bot id = 8399571083)
2025-12-27 01:02:11,092 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:02:11,092 - aiogram.dispatcher - WARNING - Sleep for 5.110096 seconds and try again... (tryings = 22, bot id = 8399571083)
2025-12-27 01:02:16,319 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:02:16,320 - aiogram.dispatcher - WARNING - Sleep for 5.063410 seconds and try again... (tryings = 23, bot id = 8399571083)
2025-12-27 01:02:21,503 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:02:21,504 - aiogram.dispatcher - WARNING - Sleep for 4.975116 seconds and try again... (tryings = 24, bot id = 8399571083)
2025-12-27 01:02:26,595 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:02:26,595 - aiogram.dispatcher - WARNING - Sleep for 4.750673 seconds and try again... (tryings = 25, bot id = 8399571083)
2025-12-27 01:02:31,480 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:02:31,480 - aiogram.dispatcher - WARNING - Sleep for 4.741706 seconds and try again... (tryings = 26, bot id = 8399571083)
2025-12-27 01:02:34,292 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-27 01:02:34,293 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8286574516)
2025-12-27 01:02:36,336 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:02:36,336 - aiogram.dispatcher - WARNING - Sleep for 4.955670 seconds and try again... (tryings = 27, bot id = 8399571083)
2025-12-27 01:02:41,408 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:02:41,408 - aiogram.dispatcher - WARNING - Sleep for 4.866424 seconds and try again... (tryings = 28, bot id = 8399571083)
2025-12-27 01:02:46,404 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:02:46,404 - aiogram.dispatcher - WARNING - Sleep for 5.020935 seconds and try again... (tryings = 29, bot id = 8399571083)
2025-12-27 01:02:51,544 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:02:51,545 - aiogram.dispatcher - WARNING - Sleep for 4.882706 seconds and try again... (tryings = 30, bot id = 8399571083)
2025-12-27 01:02:56,536 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:02:56,537 - aiogram.dispatcher - WARNING - Sleep for 5.061280 seconds and try again... (tryings = 31, bot id = 8399571083)
2025-12-27 01:03:01,725 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:03:01,725 - aiogram.dispatcher - WARNING - Sleep for 4.938149 seconds and try again... (tryings = 32, bot id = 8399571083)
2025-12-27 01:03:06,785 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:03:06,785 - aiogram.dispatcher - WARNING - Sleep for 4.950916 seconds and try again... (tryings = 33, bot id = 8399571083)
2025-12-27 01:03:11,853 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:03:11,853 - aiogram.dispatcher - WARNING - Sleep for 4.998119 seconds and try again... (tryings = 34, bot id = 8399571083)
2025-12-27 01:03:16,966 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:03:16,966 - aiogram.dispatcher - WARNING - Sleep for 5.087722 seconds and try again... (tryings = 35, bot id = 8399571083)
2025-12-27 01:03:22,179 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:03:22,179 - aiogram.dispatcher - WARNING - Sleep for 4.913828 seconds and try again... (tryings = 36, bot id = 8399571083)
2025-12-27 01:03:27,208 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:03:27,208 - aiogram.dispatcher - WARNING - Sleep for 5.151700 seconds and try again... (tryings = 37, bot id = 8399571083)
2025-12-27 01:03:32,478 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:03:32,478 - aiogram.dispatcher - WARNING - Sleep for 4.908215 seconds and try again... (tryings = 38, bot id = 8399571083)
2025-12-27 01:03:37,511 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:03:37,511 - aiogram.dispatcher - WARNING - Sleep for 5.130674 seconds and try again... (tryings = 39, bot id = 8399571083)
2025-12-27 01:03:42,759 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:03:42,759 - aiogram.dispatcher - WARNING - Sleep for 5.052283 seconds and try again... (tryings = 40, bot id = 8399571083)
2025-12-27 01:03:47,929 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:03:47,930 - aiogram.dispatcher - WARNING - Sleep for 5.024545 seconds and try again... (tryings = 41, bot id = 8399571083)
2025-12-27 01:03:53,072 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:03:53,073 - aiogram.dispatcher - WARNING - Sleep for 5.034915 seconds and try again... (tryings = 42, bot id = 8399571083)
2025-12-27 01:03:58,221 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:03:58,221 - aiogram.dispatcher - WARNING - Sleep for 5.160649 seconds and try again... (tryings = 43, bot id = 8399571083)
2025-12-27 01:04:03,504 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:04:03,504 - aiogram.dispatcher - WARNING - Sleep for 4.970646 seconds and try again... (tryings = 44, bot id = 8399571083)
2025-12-27 01:04:08,594 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:04:08,594 - aiogram.dispatcher - WARNING - Sleep for 5.126806 seconds and try again... (tryings = 45, bot id = 8399571083)
2025-12-27 01:04:13,840 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:04:13,840 - aiogram.dispatcher - WARNING - Sleep for 5.026992 seconds and try again... (tryings = 46, bot id = 8399571083)
2025-12-27 01:04:18,974 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:04:18,974 - aiogram.dispatcher - WARNING - Sleep for 5.040254 seconds and try again... (tryings = 47, bot id = 8399571083)
2025-12-27 01:04:24,131 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:04:24,131 - aiogram.dispatcher - WARNING - Sleep for 5.008491 seconds and try again... (tryings = 48, bot id = 8399571083)
2025-12-27 01:04:29,263 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:04:29,264 - aiogram.dispatcher - WARNING - Sleep for 5.052342 seconds and try again... (tryings = 49, bot id = 8399571083)
2025-12-27 01:04:34,438 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:04:34,438 - aiogram.dispatcher - WARNING - Sleep for 5.102252 seconds and try again... (tryings = 50, bot id = 8399571083)
2025-12-27 01:04:39,716 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:04:39,716 - aiogram.dispatcher - WARNING - Sleep for 5.107894 seconds and try again... (tryings = 51, bot id = 8399571083)
2025-12-27 01:04:44,928 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:04:44,928 - aiogram.dispatcher - WARNING - Sleep for 4.921201 seconds and try again... (tryings = 52, bot id = 8399571083)
2025-12-27 01:04:49,969 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:04:49,969 - aiogram.dispatcher - WARNING - Sleep for 4.950200 seconds and try again... (tryings = 53, bot id = 8399571083)
2025-12-27 01:04:55,052 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:04:55,052 - aiogram.dispatcher - WARNING - Sleep for 4.882403 seconds and try again... (tryings = 54, bot id = 8399571083)
2025-12-27 01:05:00,047 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:05:00,047 - aiogram.dispatcher - WARNING - Sleep for 5.067828 seconds and try again... (tryings = 55, bot id = 8399571083)
2025-12-27 01:05:05,237 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:05:05,237 - aiogram.dispatcher - WARNING - Sleep for 5.158451 seconds and try again... (tryings = 56, bot id = 8399571083)
2025-12-27 01:05:10,510 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:05:10,510 - aiogram.dispatcher - WARNING - Sleep for 4.956751 seconds and try again... (tryings = 57, bot id = 8399571083)
2025-12-27 01:05:15,589 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:05:15,589 - aiogram.dispatcher - WARNING - Sleep for 5.024542 seconds and try again... (tryings = 58, bot id = 8399571083)
2025-12-27 01:05:20,723 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:05:20,723 - aiogram.dispatcher - WARNING - Sleep for 4.896451 seconds and try again... (tryings = 59, bot id = 8399571083)
2025-12-27 01:05:25,744 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:05:25,744 - aiogram.dispatcher - WARNING - Sleep for 5.017223 seconds and try again... (tryings = 60, bot id = 8399571083)
2025-12-27 01:05:30,881 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:05:30,881 - aiogram.dispatcher - WARNING - Sleep for 5.030869 seconds and try again... (tryings = 61, bot id = 8399571083)
2025-12-27 01:05:36,045 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:05:36,045 - aiogram.dispatcher - WARNING - Sleep for 4.850089 seconds and try again... (tryings = 62, bot id = 8399571083)
2025-12-27 01:05:41,011 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:05:41,011 - aiogram.dispatcher - WARNING - Sleep for 4.891115 seconds and try again... (tryings = 63, bot id = 8399571083)
2025-12-27 01:05:46,030 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:05:46,030 - aiogram.dispatcher - WARNING - Sleep for 4.969040 seconds and try again... (tryings = 64, bot id = 8399571083)
2025-12-27 01:05:51,133 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:05:51,133 - aiogram.dispatcher - WARNING - Sleep for 4.924850 seconds and try again... (tryings = 65, bot id = 8399571083)
2025-12-27 01:05:56,184 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:05:56,184 - aiogram.dispatcher - WARNING - Sleep for 5.014207 seconds and try again... (tryings = 66, bot id = 8399571083)
2025-12-27 01:06:01,316 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:06:01,316 - aiogram.dispatcher - WARNING - Sleep for 4.955386 seconds and try again... (tryings = 67, bot id = 8399571083)
2025-12-27 01:06:06,384 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:06:06,384 - aiogram.dispatcher - WARNING - Sleep for 4.804960 seconds and try again... (tryings = 68, bot id = 8399571083)
2025-12-27 01:06:11,301 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:06:11,302 - aiogram.dispatcher - WARNING - Sleep for 5.047066 seconds and try again... (tryings = 69, bot id = 8399571083)
2025-12-27 01:06:16,473 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:06:16,474 - aiogram.dispatcher - WARNING - Sleep for 5.189742 seconds and try again... (tryings = 70, bot id = 8399571083)
2025-12-27 01:06:21,787 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:06:21,788 - aiogram.dispatcher - WARNING - Sleep for 4.963911 seconds and try again... (tryings = 71, bot id = 8399571083)
2025-12-27 01:06:26,872 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:06:26,872 - aiogram.dispatcher - WARNING - Sleep for 5.059863 seconds and try again... (tryings = 72, bot id = 8399571083)
2025-12-27 01:06:32,177 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:06:32,178 - aiogram.dispatcher - WARNING - Sleep for 5.060766 seconds and try again... (tryings = 73, bot id = 8399571083)
2025-12-27 01:06:37,355 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:06:37,356 - aiogram.dispatcher - WARNING - Sleep for 4.925840 seconds and try again... (tryings = 74, bot id = 8399571083)
2025-12-27 01:06:42,434 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:06:42,434 - aiogram.dispatcher - WARNING - Sleep for 5.032136 seconds and try again... (tryings = 75, bot id = 8399571083)
2025-12-27 01:06:47,592 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:06:47,592 - aiogram.dispatcher - WARNING - Sleep for 4.976086 seconds and try again... (tryings = 76, bot id = 8399571083)
2025-12-27 01:06:52,693 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:06:52,693 - aiogram.dispatcher - WARNING - Sleep for 5.106979 seconds and try again... (tryings = 77, bot id = 8399571083)
2025-12-27 01:06:57,927 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:06:57,927 - aiogram.dispatcher - WARNING - Sleep for 4.843665 seconds and try again... (tryings = 78, bot id = 8399571083)
2025-12-27 01:07:02,893 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:07:02,893 - aiogram.dispatcher - WARNING - Sleep for 4.991331 seconds and try again... (tryings = 79, bot id = 8399571083)
2025-12-27 01:07:08,007 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:07:08,007 - aiogram.dispatcher - WARNING - Sleep for 4.852054 seconds and try again... (tryings = 80, bot id = 8399571083)
2025-12-27 01:07:12,974 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:07:12,974 - aiogram.dispatcher - WARNING - Sleep for 5.099676 seconds and try again... (tryings = 81, bot id = 8399571083)
2025-12-27 01:07:18,192 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:07:18,192 - aiogram.dispatcher - WARNING - Sleep for 5.050084 seconds and try again... (tryings = 82, bot id = 8399571083)
2025-12-27 01:07:23,356 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:07:23,356 - aiogram.dispatcher - WARNING - Sleep for 4.899784 seconds and try again... (tryings = 83, bot id = 8399571083)
2025-12-27 01:07:28,377 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:07:28,377 - aiogram.dispatcher - WARNING - Sleep for 4.969017 seconds and try again... (tryings = 84, bot id = 8399571083)
2025-12-27 01:07:33,458 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:07:33,458 - aiogram.dispatcher - WARNING - Sleep for 5.119721 seconds and try again... (tryings = 85, bot id = 8399571083)
2025-12-27 01:07:38,690 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:07:38,690 - aiogram.dispatcher - WARNING - Sleep for 4.943491 seconds and try again... (tryings = 86, bot id = 8399571083)
2025-12-27 01:07:43,751 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:07:43,752 - aiogram.dispatcher - WARNING - Sleep for 5.039102 seconds and try again... (tryings = 87, bot id = 8399571083)
2025-12-27 01:07:48,916 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:07:48,917 - aiogram.dispatcher - WARNING - Sleep for 5.078285 seconds and try again... (tryings = 88, bot id = 8399571083)
2025-12-27 01:07:54,106 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:07:54,106 - aiogram.dispatcher - WARNING - Sleep for 5.039410 seconds and try again... (tryings = 89, bot id = 8399571083)
2025-12-27 01:07:59,266 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:07:59,266 - aiogram.dispatcher - WARNING - Sleep for 5.114670 seconds and try again... (tryings = 90, bot id = 8399571083)
2025-12-27 01:08:04,502 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:08:04,502 - aiogram.dispatcher - WARNING - Sleep for 4.988415 seconds and try again... (tryings = 91, bot id = 8399571083)
2025-12-27 01:08:09,605 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:08:09,605 - aiogram.dispatcher - WARNING - Sleep for 4.967103 seconds and try again... (tryings = 92, bot id = 8399571083)
2025-12-27 01:08:14,693 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:08:14,693 - aiogram.dispatcher - WARNING - Sleep for 5.046377 seconds and try again... (tryings = 93, bot id = 8399571083)
2025-12-27 01:08:19,856 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:08:19,856 - aiogram.dispatcher - WARNING - Sleep for 5.130651 seconds and try again... (tryings = 94, bot id = 8399571083)
2025-12-27 01:08:25,103 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:08:25,103 - aiogram.dispatcher - WARNING - Sleep for 5.022478 seconds and try again... (tryings = 95, bot id = 8399571083)
2025-12-27 01:08:30,254 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:08:30,254 - aiogram.dispatcher - WARNING - Sleep for 4.869550 seconds and try again... (tryings = 96, bot id = 8399571083)
2025-12-27 01:08:30,259 - __main__ - INFO - База данных создана
2025-12-27 01:08:35,234 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:08:35,234 - aiogram.dispatcher - WARNING - Sleep for 5.034481 seconds and try again... (tryings = 97, bot id = 8399571083)
2025-12-27 01:08:35,740 - __main__ - CRITICAL - Критическая ошибка: cannot import name 'AdminBroadcastStates' from 'src.states.admin_states' (C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\states\admin_states.py)
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\run.py", line 72, in main
    from src.main import main as bot_main
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\main.py", line 9, in <module>
    from src.bot.loader import setup_middlewares, setup_routers
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\loader.py", line 5, in <module>
    from src.handlers.start import start_router
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\__init__.py", line 2, in <module>
    from .admin import admin_router
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\admin\__init__.py", line 7, in <module>
    from . import panel  # noqa
    ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\admin\panel.py", line 9, in <module>
    from src.states.admin_states import AdminPanelStates
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\states\__init__.py", line 8, in <module>
    from .admin_states import (
ImportError: cannot import name 'AdminBroadcastStates' from 'src.states.admin_states' (C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\states\admin_states.py)
2025-12-27 01:08:40,413 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:08:40,413 - aiogram.dispatcher - WARNING - Sleep for 5.038975 seconds and try again... (tryings = 98, bot id = 8399571083)
2025-12-27 01:08:45,590 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:08:45,590 - aiogram.dispatcher - WARNING - Sleep for 5.098839 seconds and try again... (tryings = 99, bot id = 8399571083)
2025-12-27 01:08:50,815 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:08:50,816 - aiogram.dispatcher - WARNING - Sleep for 4.959615 seconds and try again... (tryings = 100, bot id = 8399571083)
2025-12-27 01:08:55,898 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:08:55,898 - aiogram.dispatcher - WARNING - Sleep for 5.090414 seconds and try again... (tryings = 101, bot id = 8399571083)
2025-12-27 01:09:01,105 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:09:01,105 - aiogram.dispatcher - WARNING - Sleep for 5.075661 seconds and try again... (tryings = 102, bot id = 8399571083)
2025-12-27 01:09:06,294 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:09:06,294 - aiogram.dispatcher - WARNING - Sleep for 4.780176 seconds and try again... (tryings = 103, bot id = 8399571083)
2025-12-27 01:09:11,215 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:09:11,215 - aiogram.dispatcher - WARNING - Sleep for 5.124842 seconds and try again... (tryings = 104, bot id = 8399571083)
2025-12-27 01:09:16,457 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:09:16,457 - aiogram.dispatcher - WARNING - Sleep for 5.095528 seconds and try again... (tryings = 105, bot id = 8399571083)
2025-12-27 01:09:21,694 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:09:21,694 - aiogram.dispatcher - WARNING - Sleep for 4.881519 seconds and try again... (tryings = 106, bot id = 8399571083)
2025-12-27 01:09:26,697 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:09:26,697 - aiogram.dispatcher - WARNING - Sleep for 5.083091 seconds and try again... (tryings = 107, bot id = 8399571083)
2025-12-27 01:09:31,893 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:09:31,893 - aiogram.dispatcher - WARNING - Sleep for 4.919974 seconds and try again... (tryings = 108, bot id = 8399571083)
2025-12-27 01:09:34,215 - __main__ - INFO - База данных создана
2025-12-27 01:09:36,930 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:09:36,930 - aiogram.dispatcher - WARNING - Sleep for 4.993718 seconds and try again... (tryings = 109, bot id = 8399571083)
2025-12-27 01:09:40,570 - vpn_bot - INFO - Уведомление отправлено админу 7672667340
2025-12-27 01:09:40,570 - vpn_bot - INFO - Планировщик временно отключен (ошибка структуры БД)
2025-12-27 01:09:40,571 - vpn_bot - INFO - Бот запускается...
2025-12-27 01:09:42,038 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:09:42,038 - aiogram.dispatcher - WARNING - Sleep for 5.022464 seconds and try again... (tryings = 110, bot id = 8399571083)
2025-12-27 01:09:47,175 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:09:47,176 - aiogram.dispatcher - WARNING - Sleep for 5.199457 seconds and try again... (tryings = 111, bot id = 8399571083)
2025-12-27 01:09:52,486 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:09:52,487 - aiogram.dispatcher - WARNING - Sleep for 4.919610 seconds and try again... (tryings = 112, bot id = 8399571083)
2025-12-27 01:09:57,520 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:09:57,520 - aiogram.dispatcher - WARNING - Sleep for 5.138996 seconds and try again... (tryings = 113, bot id = 8399571083)
2025-12-27 01:10:02,780 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:10:02,780 - aiogram.dispatcher - WARNING - Sleep for 5.135168 seconds and try again... (tryings = 114, bot id = 8399571083)
2025-12-27 01:10:08,034 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:10:08,034 - aiogram.dispatcher - WARNING - Sleep for 5.129201 seconds and try again... (tryings = 115, bot id = 8399571083)
2025-12-27 01:10:13,286 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:10:13,286 - aiogram.dispatcher - WARNING - Sleep for 4.970871 seconds and try again... (tryings = 116, bot id = 8399571083)
2025-12-27 01:10:18,369 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:10:18,369 - aiogram.dispatcher - WARNING - Sleep for 5.184457 seconds and try again... (tryings = 117, bot id = 8399571083)
2025-12-27 01:10:23,666 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:10:23,666 - aiogram.dispatcher - WARNING - Sleep for 4.791986 seconds and try again... (tryings = 118, bot id = 8399571083)
2025-12-27 01:10:28,565 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:10:28,565 - aiogram.dispatcher - WARNING - Sleep for 4.997203 seconds and try again... (tryings = 119, bot id = 8399571083)
2025-12-27 01:10:33,687 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:10:33,687 - aiogram.dispatcher - WARNING - Sleep for 5.108054 seconds and try again... (tryings = 120, bot id = 8399571083)
2025-12-27 01:10:38,912 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:10:38,912 - aiogram.dispatcher - WARNING - Sleep for 4.973451 seconds and try again... (tryings = 121, bot id = 8399571083)
2025-12-27 01:10:44,000 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:10:44,000 - aiogram.dispatcher - WARNING - Sleep for 5.042893 seconds and try again... (tryings = 122, bot id = 8399571083)
2025-12-27 01:10:49,153 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:10:49,153 - aiogram.dispatcher - WARNING - Sleep for 4.945076 seconds and try again... (tryings = 123, bot id = 8399571083)
2025-12-27 01:10:54,212 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:10:54,212 - aiogram.dispatcher - WARNING - Sleep for 4.905415 seconds and try again... (tryings = 124, bot id = 8399571083)
2025-12-27 01:10:59,244 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:10:59,244 - aiogram.dispatcher - WARNING - Sleep for 4.923094 seconds and try again... (tryings = 125, bot id = 8399571083)
2025-12-27 01:11:04,276 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:11:04,276 - aiogram.dispatcher - WARNING - Sleep for 4.962984 seconds and try again... (tryings = 126, bot id = 8399571083)
2025-12-27 01:11:09,350 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:11:09,351 - aiogram.dispatcher - WARNING - Sleep for 4.937102 seconds and try again... (tryings = 127, bot id = 8399571083)
2025-12-27 01:11:14,402 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:11:14,402 - aiogram.dispatcher - WARNING - Sleep for 5.075046 seconds and try again... (tryings = 128, bot id = 8399571083)
2025-12-27 01:11:19,585 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:11:19,585 - aiogram.dispatcher - WARNING - Sleep for 5.173488 seconds and try again... (tryings = 129, bot id = 8399571083)
2025-12-27 01:11:24,869 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:11:24,869 - aiogram.dispatcher - WARNING - Sleep for 5.098818 seconds and try again... (tryings = 130, bot id = 8399571083)
2025-12-27 01:11:30,081 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:11:30,082 - aiogram.dispatcher - WARNING - Sleep for 5.070421 seconds and try again... (tryings = 131, bot id = 8399571083)
2025-12-27 01:11:35,263 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:11:35,263 - aiogram.dispatcher - WARNING - Sleep for 5.026553 seconds and try again... (tryings = 132, bot id = 8399571083)
2025-12-27 01:11:40,396 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:11:40,396 - aiogram.dispatcher - WARNING - Sleep for 5.070949 seconds and try again... (tryings = 133, bot id = 8399571083)
2025-12-27 01:11:45,588 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:11:45,588 - aiogram.dispatcher - WARNING - Sleep for 4.882882 seconds and try again... (tryings = 134, bot id = 8399571083)
2025-12-27 01:11:50,585 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:11:50,585 - aiogram.dispatcher - WARNING - Sleep for 5.075248 seconds and try again... (tryings = 135, bot id = 8399571083)
2025-12-27 01:11:55,774 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:11:55,775 - aiogram.dispatcher - WARNING - Sleep for 5.065538 seconds and try again... (tryings = 136, bot id = 8399571083)
2025-12-27 01:12:00,959 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:12:00,960 - aiogram.dispatcher - WARNING - Sleep for 5.054007 seconds and try again... (tryings = 137, bot id = 8399571083)
2025-12-27 01:12:06,130 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:12:06,131 - aiogram.dispatcher - WARNING - Sleep for 5.023099 seconds and try again... (tryings = 138, bot id = 8399571083)
2025-12-27 01:12:11,269 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:12:11,269 - aiogram.dispatcher - WARNING - Sleep for 5.084560 seconds and try again... (tryings = 139, bot id = 8399571083)
2025-12-27 01:12:16,475 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:12:16,475 - aiogram.dispatcher - WARNING - Sleep for 5.061297 seconds and try again... (tryings = 140, bot id = 8399571083)
2025-12-27 01:12:21,656 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:12:21,656 - aiogram.dispatcher - WARNING - Sleep for 5.028219 seconds and try again... (tryings = 141, bot id = 8399571083)
2025-12-27 01:12:26,795 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:12:26,796 - aiogram.dispatcher - WARNING - Sleep for 4.852404 seconds and try again... (tryings = 142, bot id = 8399571083)
2025-12-27 01:12:31,771 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:12:31,771 - aiogram.dispatcher - WARNING - Sleep for 5.032778 seconds and try again... (tryings = 143, bot id = 8399571083)
2025-12-27 01:12:36,919 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:12:36,920 - aiogram.dispatcher - WARNING - Sleep for 5.033355 seconds and try again... (tryings = 144, bot id = 8399571083)
2025-12-27 01:12:42,073 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:12:42,073 - aiogram.dispatcher - WARNING - Sleep for 5.167139 seconds and try again... (tryings = 145, bot id = 8399571083)
2025-12-27 01:12:47,354 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:12:47,354 - aiogram.dispatcher - WARNING - Sleep for 5.104104 seconds and try again... (tryings = 146, bot id = 8399571083)
2025-12-27 01:12:52,573 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:12:52,573 - aiogram.dispatcher - WARNING - Sleep for 5.037532 seconds and try again... (tryings = 147, bot id = 8399571083)
2025-12-27 01:12:57,728 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:12:57,729 - aiogram.dispatcher - WARNING - Sleep for 4.858528 seconds and try again... (tryings = 148, bot id = 8399571083)
2025-12-27 01:13:02,707 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:13:02,707 - aiogram.dispatcher - WARNING - Sleep for 5.047947 seconds and try again... (tryings = 149, bot id = 8399571083)
2025-12-27 01:13:07,877 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:13:07,878 - aiogram.dispatcher - WARNING - Sleep for 4.895588 seconds and try again... (tryings = 150, bot id = 8399571083)
2025-12-27 01:13:13,149 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:13:13,149 - aiogram.dispatcher - WARNING - Sleep for 5.194514 seconds and try again... (tryings = 151, bot id = 8399571083)
2025-12-27 01:13:18,476 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:13:18,476 - aiogram.dispatcher - WARNING - Sleep for 4.922366 seconds and try again... (tryings = 152, bot id = 8399571083)
2025-12-27 01:13:23,542 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:13:23,542 - aiogram.dispatcher - WARNING - Sleep for 5.110691 seconds and try again... (tryings = 153, bot id = 8399571083)
2025-12-27 01:13:28,781 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:13:28,781 - aiogram.dispatcher - WARNING - Sleep for 4.912550 seconds and try again... (tryings = 154, bot id = 8399571083)
2025-12-27 01:13:33,824 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:13:33,824 - aiogram.dispatcher - WARNING - Sleep for 5.142455 seconds and try again... (tryings = 155, bot id = 8399571083)
2025-12-27 01:13:39,089 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:13:39,089 - aiogram.dispatcher - WARNING - Sleep for 5.017316 seconds and try again... (tryings = 156, bot id = 8399571083)
2025-12-27 01:13:44,241 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:13:44,242 - aiogram.dispatcher - WARNING - Sleep for 5.162629 seconds and try again... (tryings = 157, bot id = 8399571083)
2025-12-27 01:13:49,538 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:13:49,538 - aiogram.dispatcher - WARNING - Sleep for 4.997379 seconds and try again... (tryings = 158, bot id = 8399571083)
2025-12-27 01:13:54,654 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:13:54,654 - aiogram.dispatcher - WARNING - Sleep for 5.077135 seconds and try again... (tryings = 159, bot id = 8399571083)
2025-12-27 01:13:59,871 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:13:59,871 - aiogram.dispatcher - WARNING - Sleep for 4.934466 seconds and try again... (tryings = 160, bot id = 8399571083)
2025-12-27 01:14:04,944 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:14:04,944 - aiogram.dispatcher - WARNING - Sleep for 4.993583 seconds and try again... (tryings = 161, bot id = 8399571083)
2025-12-27 01:14:10,059 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:14:10,059 - aiogram.dispatcher - WARNING - Sleep for 4.964969 seconds and try again... (tryings = 162, bot id = 8399571083)
2025-12-27 01:14:15,152 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:14:15,152 - aiogram.dispatcher - WARNING - Sleep for 4.899103 seconds and try again... (tryings = 163, bot id = 8399571083)
2025-12-27 01:14:20,175 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:14:20,175 - aiogram.dispatcher - WARNING - Sleep for 4.956790 seconds and try again... (tryings = 164, bot id = 8399571083)
2025-12-27 01:14:25,264 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:14:25,265 - aiogram.dispatcher - WARNING - Sleep for 4.891204 seconds and try again... (tryings = 165, bot id = 8399571083)
2025-12-27 01:14:30,294 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:14:30,294 - aiogram.dispatcher - WARNING - Sleep for 5.026858 seconds and try again... (tryings = 166, bot id = 8399571083)
2025-12-27 01:14:35,451 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:14:35,451 - aiogram.dispatcher - WARNING - Sleep for 5.178608 seconds and try again... (tryings = 167, bot id = 8399571083)
2025-12-27 01:14:40,750 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:14:40,750 - aiogram.dispatcher - WARNING - Sleep for 4.905540 seconds and try again... (tryings = 168, bot id = 8399571083)
2025-12-27 01:14:45,777 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:14:45,777 - aiogram.dispatcher - WARNING - Sleep for 4.916364 seconds and try again... (tryings = 169, bot id = 8399571083)
2025-12-27 01:14:50,824 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:14:50,825 - aiogram.dispatcher - WARNING - Sleep for 4.968842 seconds and try again... (tryings = 170, bot id = 8399571083)
2025-12-27 01:14:55,914 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:14:55,914 - aiogram.dispatcher - WARNING - Sleep for 5.162503 seconds and try again... (tryings = 171, bot id = 8399571083)
2025-12-27 01:15:01,194 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:15:01,194 - aiogram.dispatcher - WARNING - Sleep for 4.891870 seconds and try again... (tryings = 172, bot id = 8399571083)
2025-12-27 01:15:06,213 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:15:06,213 - aiogram.dispatcher - WARNING - Sleep for 4.978800 seconds and try again... (tryings = 173, bot id = 8399571083)
2025-12-27 01:15:11,322 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:15:11,322 - aiogram.dispatcher - WARNING - Sleep for 5.027075 seconds and try again... (tryings = 174, bot id = 8399571083)
2025-12-27 01:15:16,485 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:15:16,485 - aiogram.dispatcher - WARNING - Sleep for 4.933707 seconds and try again... (tryings = 175, bot id = 8399571083)
2025-12-27 01:15:21,545 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:15:21,545 - aiogram.dispatcher - WARNING - Sleep for 5.202972 seconds and try again... (tryings = 176, bot id = 8399571083)
2025-12-27 01:15:26,884 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:15:26,884 - aiogram.dispatcher - WARNING - Sleep for 4.946001 seconds and try again... (tryings = 177, bot id = 8399571083)
2025-12-27 01:15:31,957 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:15:31,958 - aiogram.dispatcher - WARNING - Sleep for 4.915615 seconds and try again... (tryings = 178, bot id = 8399571083)
2025-12-27 01:15:37,008 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:15:37,008 - aiogram.dispatcher - WARNING - Sleep for 4.989999 seconds and try again... (tryings = 179, bot id = 8399571083)
2025-12-27 01:15:42,130 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:15:42,131 - aiogram.dispatcher - WARNING - Sleep for 5.234582 seconds and try again... (tryings = 180, bot id = 8399571083)
2025-12-27 01:15:42,665 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-27 01:15:42,666 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8286574516)
2025-12-27 01:15:47,500 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:15:47,501 - aiogram.dispatcher - WARNING - Sleep for 5.036500 seconds and try again... (tryings = 181, bot id = 8399571083)
2025-12-27 01:15:52,046 - __main__ - INFO - База данных создана
2025-12-27 01:15:52,668 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:15:52,668 - aiogram.dispatcher - WARNING - Sleep for 5.206971 seconds and try again... (tryings = 182, bot id = 8399571083)
2025-12-27 01:15:57,178 - __main__ - CRITICAL - Критическая ошибка: cannot import name 'router' from 'src.handlers.admin.keys' (C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\admin\keys.py)
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\run.py", line 72, in main
    from src.main import main as bot_main
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\main.py", line 9, in <module>
    from src.bot.loader import setup_middlewares, setup_routers
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\loader.py", line 5, in <module>
    from src.handlers.start import start_router
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\__init__.py", line 2, in <module>
    from .admin import admin_router
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\admin\__init__.py", line 6, in <module>
    from .keys import router as keys_router
ImportError: cannot import name 'router' from 'src.handlers.admin.keys' (C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\admin\keys.py)
2025-12-27 01:15:58,006 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:15:58,007 - aiogram.dispatcher - WARNING - Sleep for 5.105558 seconds and try again... (tryings = 183, bot id = 8399571083)
2025-12-27 01:16:03,238 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:16:03,238 - aiogram.dispatcher - WARNING - Sleep for 4.898773 seconds and try again... (tryings = 184, bot id = 8399571083)
2025-12-27 01:16:08,266 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:16:08,266 - aiogram.dispatcher - WARNING - Sleep for 5.076526 seconds and try again... (tryings = 185, bot id = 8399571083)
2025-12-27 01:16:13,472 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:16:13,472 - aiogram.dispatcher - WARNING - Sleep for 5.088764 seconds and try again... (tryings = 186, bot id = 8399571083)
2025-12-27 01:16:18,699 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:16:18,699 - aiogram.dispatcher - WARNING - Sleep for 5.080885 seconds and try again... (tryings = 187, bot id = 8399571083)
2025-12-27 01:16:23,907 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:16:23,907 - aiogram.dispatcher - WARNING - Sleep for 4.894174 seconds and try again... (tryings = 188, bot id = 8399571083)
2025-12-27 01:16:28,928 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:16:28,928 - aiogram.dispatcher - WARNING - Sleep for 5.174632 seconds and try again... (tryings = 189, bot id = 8399571083)
2025-12-27 01:16:34,223 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:16:34,223 - aiogram.dispatcher - WARNING - Sleep for 4.936702 seconds and try again... (tryings = 190, bot id = 8399571083)
2025-12-27 01:16:39,295 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:16:39,295 - aiogram.dispatcher - WARNING - Sleep for 4.802182 seconds and try again... (tryings = 191, bot id = 8399571083)
2025-12-27 01:16:44,228 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:16:44,228 - aiogram.dispatcher - WARNING - Sleep for 4.883918 seconds and try again... (tryings = 192, bot id = 8399571083)
2025-12-27 01:16:49,233 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:16:49,234 - aiogram.dispatcher - WARNING - Sleep for 5.033561 seconds and try again... (tryings = 193, bot id = 8399571083)
2025-12-27 01:16:54,392 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:16:54,392 - aiogram.dispatcher - WARNING - Sleep for 5.019669 seconds and try again... (tryings = 194, bot id = 8399571083)
2025-12-27 01:16:59,543 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:16:59,543 - aiogram.dispatcher - WARNING - Sleep for 5.080675 seconds and try again... (tryings = 195, bot id = 8399571083)
2025-12-27 01:17:04,750 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:17:04,750 - aiogram.dispatcher - WARNING - Sleep for 5.047888 seconds and try again... (tryings = 196, bot id = 8399571083)
2025-12-27 01:17:05,888 - __main__ - INFO - База данных создана
2025-12-27 01:17:09,932 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:17:09,932 - aiogram.dispatcher - WARNING - Sleep for 4.942662 seconds and try again... (tryings = 197, bot id = 8399571083)
2025-12-27 01:17:12,548 - vpn_bot - INFO - Уведомление отправлено админу 7672667340
2025-12-27 01:17:12,549 - vpn_bot - INFO - Планировщик временно отключен (ошибка структуры БД)
2025-12-27 01:17:12,549 - vpn_bot - INFO - Бот запускается...
2025-12-27 01:17:15,000 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:17:15,001 - aiogram.dispatcher - WARNING - Sleep for 5.004481 seconds and try again... (tryings = 198, bot id = 8399571083)
2025-12-27 01:17:20,147 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:17:20,147 - aiogram.dispatcher - WARNING - Sleep for 5.007183 seconds and try again... (tryings = 199, bot id = 8399571083)
2025-12-27 01:17:25,279 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:17:25,280 - aiogram.dispatcher - WARNING - Sleep for 5.139423 seconds and try again... (tryings = 200, bot id = 8399571083)
2025-12-27 01:17:30,581 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:17:30,581 - aiogram.dispatcher - WARNING - Sleep for 4.879826 seconds and try again... (tryings = 201, bot id = 8399571083)
2025-12-27 01:17:35,590 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:17:35,590 - aiogram.dispatcher - WARNING - Sleep for 5.005679 seconds and try again... (tryings = 202, bot id = 8399571083)
2025-12-27 01:17:40,724 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:17:40,724 - aiogram.dispatcher - WARNING - Sleep for 4.955814 seconds and try again... (tryings = 203, bot id = 8399571083)
2025-12-27 01:17:45,805 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:17:45,805 - aiogram.dispatcher - WARNING - Sleep for 4.834327 seconds and try again... (tryings = 204, bot id = 8399571083)
2025-12-27 01:17:50,771 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:17:50,771 - aiogram.dispatcher - WARNING - Sleep for 5.000941 seconds and try again... (tryings = 205, bot id = 8399571083)
2025-12-27 01:17:55,903 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:17:55,903 - aiogram.dispatcher - WARNING - Sleep for 4.746215 seconds and try again... (tryings = 206, bot id = 8399571083)
2025-12-27 01:18:00,777 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:18:00,777 - aiogram.dispatcher - WARNING - Sleep for 5.141964 seconds and try again... (tryings = 207, bot id = 8399571083)
2025-12-27 01:18:06,033 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:18:06,034 - aiogram.dispatcher - WARNING - Sleep for 4.872619 seconds and try again... (tryings = 208, bot id = 8399571083)
2025-12-27 01:18:11,032 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:18:11,032 - aiogram.dispatcher - WARNING - Sleep for 4.990179 seconds and try again... (tryings = 209, bot id = 8399571083)
2025-12-27 01:18:16,160 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:18:16,160 - aiogram.dispatcher - WARNING - Sleep for 5.043905 seconds and try again... (tryings = 210, bot id = 8399571083)
2025-12-27 01:18:21,334 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:18:21,334 - aiogram.dispatcher - WARNING - Sleep for 5.007470 seconds and try again... (tryings = 211, bot id = 8399571083)
2025-12-27 01:18:26,466 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:18:26,467 - aiogram.dispatcher - WARNING - Sleep for 4.990711 seconds and try again... (tryings = 212, bot id = 8399571083)
2025-12-27 01:18:31,577 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:18:31,577 - aiogram.dispatcher - WARNING - Sleep for 4.979405 seconds and try again... (tryings = 213, bot id = 8399571083)
2025-12-27 01:18:36,683 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:18:36,683 - aiogram.dispatcher - WARNING - Sleep for 5.012092 seconds and try again... (tryings = 214, bot id = 8399571083)
2025-12-27 01:18:41,822 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:18:41,822 - aiogram.dispatcher - WARNING - Sleep for 5.014935 seconds and try again... (tryings = 215, bot id = 8399571083)
2025-12-27 01:18:46,967 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:18:46,967 - aiogram.dispatcher - WARNING - Sleep for 5.004381 seconds and try again... (tryings = 216, bot id = 8399571083)
2025-12-27 01:18:52,098 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:18:52,098 - aiogram.dispatcher - WARNING - Sleep for 5.055525 seconds and try again... (tryings = 217, bot id = 8399571083)
2025-12-27 01:18:57,277 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:18:57,277 - aiogram.dispatcher - WARNING - Sleep for 5.126790 seconds and try again... (tryings = 218, bot id = 8399571083)
2025-12-27 01:19:02,531 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:19:02,531 - aiogram.dispatcher - WARNING - Sleep for 5.080745 seconds and try again... (tryings = 219, bot id = 8399571083)
2025-12-27 01:19:07,753 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:19:07,753 - aiogram.dispatcher - WARNING - Sleep for 5.006303 seconds and try again... (tryings = 220, bot id = 8399571083)
2025-12-27 01:19:12,888 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:19:12,888 - aiogram.dispatcher - WARNING - Sleep for 5.162872 seconds and try again... (tryings = 221, bot id = 8399571083)
2025-12-27 01:19:18,179 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:19:18,179 - aiogram.dispatcher - WARNING - Sleep for 4.973983 seconds and try again... (tryings = 222, bot id = 8399571083)
2025-12-27 01:19:23,279 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:19:23,279 - aiogram.dispatcher - WARNING - Sleep for 4.943335 seconds and try again... (tryings = 223, bot id = 8399571083)
2025-12-27 01:19:28,355 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:19:28,355 - aiogram.dispatcher - WARNING - Sleep for 4.821413 seconds and try again... (tryings = 224, bot id = 8399571083)
2025-12-27 01:19:33,312 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:19:33,312 - aiogram.dispatcher - WARNING - Sleep for 5.126364 seconds and try again... (tryings = 225, bot id = 8399571083)
2025-12-27 01:19:38,578 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:19:38,578 - aiogram.dispatcher - WARNING - Sleep for 4.921775 seconds and try again... (tryings = 226, bot id = 8399571083)
2025-12-27 01:19:41,594 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-27 01:19:41,595 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8286574516)
2025-12-27 01:19:43,633 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:19:43,633 - aiogram.dispatcher - WARNING - Sleep for 4.886636 seconds and try again... (tryings = 227, bot id = 8399571083)
2025-12-27 01:19:44,251 - __main__ - INFO - База данных создана
2025-12-27 01:19:48,647 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:19:48,647 - aiogram.dispatcher - WARNING - Sleep for 4.987712 seconds and try again... (tryings = 228, bot id = 8399571083)
2025-12-27 01:19:53,757 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:19:53,757 - aiogram.dispatcher - WARNING - Sleep for 5.138824 seconds and try again... (tryings = 229, bot id = 8399571083)
2025-12-27 01:19:57,039 - __main__ - INFO - База данных создана
2025-12-27 01:19:59,015 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:19:59,016 - aiogram.dispatcher - WARNING - Sleep for 5.025138 seconds and try again... (tryings = 230, bot id = 8399571083)
2025-12-27 01:20:03,365 - vpn_bot - INFO - Уведомление отправлено админу 7672667340
2025-12-27 01:20:03,365 - vpn_bot - INFO - Планировщик временно отключен (ошибка структуры БД)
2025-12-27 01:20:03,366 - vpn_bot - INFO - Бот запускается...
2025-12-27 01:20:04,188 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:20:04,189 - aiogram.dispatcher - WARNING - Sleep for 4.880890 seconds and try again... (tryings = 231, bot id = 8399571083)
2025-12-27 01:20:09,198 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:20:09,198 - aiogram.dispatcher - WARNING - Sleep for 4.901553 seconds and try again... (tryings = 232, bot id = 8399571083)
2025-12-27 01:20:14,226 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:20:14,227 - aiogram.dispatcher - WARNING - Sleep for 5.142152 seconds and try again... (tryings = 233, bot id = 8399571083)
2025-12-27 01:20:19,505 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:20:19,505 - aiogram.dispatcher - WARNING - Sleep for 4.990619 seconds and try again... (tryings = 234, bot id = 8399571083)
2025-12-27 01:20:24,616 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:20:24,616 - aiogram.dispatcher - WARNING - Sleep for 4.780511 seconds and try again... (tryings = 235, bot id = 8399571083)
2025-12-27 01:20:29,520 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:20:29,520 - aiogram.dispatcher - WARNING - Sleep for 5.072728 seconds and try again... (tryings = 236, bot id = 8399571083)
2025-12-27 01:20:34,715 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:20:34,716 - aiogram.dispatcher - WARNING - Sleep for 5.173508 seconds and try again... (tryings = 237, bot id = 8399571083)
2025-12-27 01:20:38,070 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-27 01:20:38,070 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8286574516)
2025-12-27 01:20:40,012 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:20:40,012 - aiogram.dispatcher - WARNING - Sleep for 4.817299 seconds and try again... (tryings = 238, bot id = 8399571083)
2025-12-27 01:20:44,958 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:20:44,958 - aiogram.dispatcher - WARNING - Sleep for 4.881517 seconds and try again... (tryings = 239, bot id = 8399571083)
2025-12-27 01:20:49,964 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:20:49,965 - aiogram.dispatcher - WARNING - Sleep for 5.133954 seconds and try again... (tryings = 240, bot id = 8399571083)
2025-12-27 01:20:55,222 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:20:55,222 - aiogram.dispatcher - WARNING - Sleep for 4.890634 seconds and try again... (tryings = 241, bot id = 8399571083)
2025-12-27 01:21:00,246 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:21:00,246 - aiogram.dispatcher - WARNING - Sleep for 4.982231 seconds and try again... (tryings = 242, bot id = 8399571083)
2025-12-27 01:21:05,358 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:21:05,358 - aiogram.dispatcher - WARNING - Sleep for 5.083393 seconds and try again... (tryings = 243, bot id = 8399571083)
2025-12-27 01:21:10,570 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:21:10,570 - aiogram.dispatcher - WARNING - Sleep for 4.849377 seconds and try again... (tryings = 244, bot id = 8399571083)
2025-12-27 01:21:15,563 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:21:15,563 - aiogram.dispatcher - WARNING - Sleep for 5.076955 seconds and try again... (tryings = 245, bot id = 8399571083)
2025-12-27 01:21:20,767 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:21:20,767 - aiogram.dispatcher - WARNING - Sleep for 5.075901 seconds and try again... (tryings = 246, bot id = 8399571083)
2025-12-27 01:21:25,969 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:21:25,969 - aiogram.dispatcher - WARNING - Sleep for 5.014389 seconds and try again... (tryings = 247, bot id = 8399571083)
2025-12-27 01:21:31,118 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:21:31,118 - aiogram.dispatcher - WARNING - Sleep for 5.019495 seconds and try again... (tryings = 248, bot id = 8399571083)
2025-12-27 01:21:36,271 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:21:36,272 - aiogram.dispatcher - WARNING - Sleep for 5.001279 seconds and try again... (tryings = 249, bot id = 8399571083)
2025-12-27 01:21:41,397 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:21:41,398 - aiogram.dispatcher - WARNING - Sleep for 4.905930 seconds and try again... (tryings = 250, bot id = 8399571083)
2025-12-27 01:21:46,641 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:21:46,641 - aiogram.dispatcher - WARNING - Sleep for 5.121154 seconds and try again... (tryings = 251, bot id = 8399571083)
2025-12-27 01:21:51,887 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:21:51,887 - aiogram.dispatcher - WARNING - Sleep for 4.842902 seconds and try again... (tryings = 252, bot id = 8399571083)
2025-12-27 01:21:56,842 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:21:56,842 - aiogram.dispatcher - WARNING - Sleep for 4.991016 seconds and try again... (tryings = 253, bot id = 8399571083)
2025-12-27 01:22:01,954 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:22:01,954 - aiogram.dispatcher - WARNING - Sleep for 4.888076 seconds and try again... (tryings = 254, bot id = 8399571083)
2025-12-27 01:22:06,964 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:22:06,965 - aiogram.dispatcher - WARNING - Sleep for 4.868171 seconds and try again... (tryings = 255, bot id = 8399571083)
2025-12-27 01:22:11,946 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:22:11,946 - aiogram.dispatcher - WARNING - Sleep for 4.983357 seconds and try again... (tryings = 256, bot id = 8399571083)
2025-12-27 01:22:17,051 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:22:17,051 - aiogram.dispatcher - WARNING - Sleep for 5.094419 seconds and try again... (tryings = 257, bot id = 8399571083)
2025-12-27 01:22:22,267 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:22:22,267 - aiogram.dispatcher - WARNING - Sleep for 5.017157 seconds and try again... (tryings = 258, bot id = 8399571083)
2025-12-27 01:22:27,410 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:22:27,410 - aiogram.dispatcher - WARNING - Sleep for 5.045882 seconds and try again... (tryings = 259, bot id = 8399571083)
2025-12-27 01:22:32,588 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:22:32,588 - aiogram.dispatcher - WARNING - Sleep for 5.042347 seconds and try again... (tryings = 260, bot id = 8399571083)
2025-12-27 01:22:34,000 - __main__ - INFO - База данных создана
2025-12-27 01:22:37,753 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:22:37,753 - aiogram.dispatcher - WARNING - Sleep for 5.162312 seconds and try again... (tryings = 261, bot id = 8399571083)
2025-12-27 01:22:40,400 - vpn_bot - INFO - Уведомление отправлено админу 7672667340
2025-12-27 01:22:40,401 - vpn_bot - INFO - Планировщик временно отключен (ошибка структуры БД)
2025-12-27 01:22:40,401 - vpn_bot - INFO - Бот запускается...
2025-12-27 01:22:43,034 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:22:43,034 - aiogram.dispatcher - WARNING - Sleep for 5.070405 seconds and try again... (tryings = 262, bot id = 8399571083)
2025-12-27 01:22:48,227 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:22:48,227 - aiogram.dispatcher - WARNING - Sleep for 5.071670 seconds and try again... (tryings = 263, bot id = 8399571083)
2025-12-27 01:22:53,414 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:22:53,414 - aiogram.dispatcher - WARNING - Sleep for 4.968421 seconds and try again... (tryings = 264, bot id = 8399571083)
2025-12-27 01:22:58,515 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:22:58,515 - aiogram.dispatcher - WARNING - Sleep for 4.992550 seconds and try again... (tryings = 265, bot id = 8399571083)
2025-12-27 01:23:03,634 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:23:03,635 - aiogram.dispatcher - WARNING - Sleep for 5.157179 seconds and try again... (tryings = 266, bot id = 8399571083)
2025-12-27 01:23:08,913 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:23:08,913 - aiogram.dispatcher - WARNING - Sleep for 4.895306 seconds and try again... (tryings = 267, bot id = 8399571083)
2025-12-27 01:23:13,923 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:23:13,923 - aiogram.dispatcher - WARNING - Sleep for 4.942329 seconds and try again... (tryings = 268, bot id = 8399571083)
2025-12-27 01:23:18,976 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:23:18,977 - aiogram.dispatcher - WARNING - Sleep for 5.096829 seconds and try again... (tryings = 269, bot id = 8399571083)
2025-12-27 01:23:24,190 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:23:24,190 - aiogram.dispatcher - WARNING - Sleep for 4.991651 seconds and try again... (tryings = 270, bot id = 8399571083)
2025-12-27 01:23:29,302 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:23:29,302 - aiogram.dispatcher - WARNING - Sleep for 5.091067 seconds and try again... (tryings = 271, bot id = 8399571083)
2025-12-27 01:23:34,518 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:23:34,518 - aiogram.dispatcher - WARNING - Sleep for 5.019782 seconds and try again... (tryings = 272, bot id = 8399571083)
2025-12-27 01:23:39,668 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:23:39,668 - aiogram.dispatcher - WARNING - Sleep for 4.967580 seconds and try again... (tryings = 273, bot id = 8399571083)
2025-12-27 01:23:44,749 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:23:44,750 - aiogram.dispatcher - WARNING - Sleep for 4.844543 seconds and try again... (tryings = 274, bot id = 8399571083)
2025-12-27 01:23:49,706 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:23:49,707 - aiogram.dispatcher - WARNING - Sleep for 5.072405 seconds and try again... (tryings = 275, bot id = 8399571083)
2025-12-27 01:23:54,900 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:23:54,900 - aiogram.dispatcher - WARNING - Sleep for 5.158868 seconds and try again... (tryings = 276, bot id = 8399571083)
2025-12-27 01:24:00,178 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:24:00,178 - aiogram.dispatcher - WARNING - Sleep for 5.125525 seconds and try again... (tryings = 277, bot id = 8399571083)
2025-12-27 01:24:05,443 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:24:05,443 - aiogram.dispatcher - WARNING - Sleep for 5.080555 seconds and try again... (tryings = 278, bot id = 8399571083)
2025-12-27 01:24:10,645 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:24:10,645 - aiogram.dispatcher - WARNING - Sleep for 5.056941 seconds and try again... (tryings = 279, bot id = 8399571083)
2025-12-27 01:24:15,833 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:24:15,833 - aiogram.dispatcher - WARNING - Sleep for 5.083164 seconds and try again... (tryings = 280, bot id = 8399571083)
2025-12-27 01:24:21,040 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:24:21,040 - aiogram.dispatcher - WARNING - Sleep for 5.041012 seconds and try again... (tryings = 281, bot id = 8399571083)
2025-12-27 01:24:26,209 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:24:26,210 - aiogram.dispatcher - WARNING - Sleep for 4.988482 seconds and try again... (tryings = 282, bot id = 8399571083)
2025-12-27 01:24:31,318 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:24:31,319 - aiogram.dispatcher - WARNING - Sleep for 4.862326 seconds and try again... (tryings = 283, bot id = 8399571083)
2025-12-27 01:24:36,295 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:24:36,295 - aiogram.dispatcher - WARNING - Sleep for 5.014290 seconds and try again... (tryings = 284, bot id = 8399571083)
2025-12-27 01:24:40,034 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-27 01:24:40,034 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8286574516)
2025-12-27 01:24:41,456 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:24:41,456 - aiogram.dispatcher - WARNING - Sleep for 4.944481 seconds and try again... (tryings = 285, bot id = 8399571083)
2025-12-27 01:24:46,517 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:24:46,517 - aiogram.dispatcher - WARNING - Sleep for 4.813402 seconds and try again... (tryings = 286, bot id = 8399571083)
2025-12-27 01:24:50,500 - __main__ - INFO - База данных создана
2025-12-27 01:24:51,443 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:24:51,444 - aiogram.dispatcher - WARNING - Sleep for 4.919867 seconds and try again... (tryings = 287, bot id = 8399571083)
2025-12-27 01:24:56,490 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:24:56,490 - aiogram.dispatcher - WARNING - Sleep for 5.004540 seconds and try again... (tryings = 288, bot id = 8399571083)
2025-12-27 01:24:56,861 - vpn_bot - INFO - Уведомление отправлено админу 7672667340
2025-12-27 01:24:56,862 - vpn_bot - INFO - Планировщик временно отключен (ошибка структуры БД)
2025-12-27 01:24:56,862 - vpn_bot - INFO - Бот запускается...
2025-12-27 01:25:01,620 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:25:01,620 - aiogram.dispatcher - WARNING - Sleep for 4.993797 seconds and try again... (tryings = 289, bot id = 8399571083)
2025-12-27 01:25:06,740 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:25:06,740 - aiogram.dispatcher - WARNING - Sleep for 4.902746 seconds and try again... (tryings = 290, bot id = 8399571083)
2025-12-27 01:25:11,777 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:25:11,778 - aiogram.dispatcher - WARNING - Sleep for 4.949895 seconds and try again... (tryings = 291, bot id = 8399571083)
2025-12-27 01:25:16,840 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:25:16,840 - aiogram.dispatcher - WARNING - Sleep for 4.914394 seconds and try again... (tryings = 292, bot id = 8399571083)
2025-12-27 01:25:21,867 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:25:21,867 - aiogram.dispatcher - WARNING - Sleep for 5.026108 seconds and try again... (tryings = 293, bot id = 8399571083)
2025-12-27 01:25:27,024 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:25:27,024 - aiogram.dispatcher - WARNING - Sleep for 5.060364 seconds and try again... (tryings = 294, bot id = 8399571083)
2025-12-27 01:25:32,196 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:25:32,197 - aiogram.dispatcher - WARNING - Sleep for 5.030422 seconds and try again... (tryings = 295, bot id = 8399571083)
2025-12-27 01:25:37,352 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:25:37,352 - aiogram.dispatcher - WARNING - Sleep for 5.088984 seconds and try again... (tryings = 296, bot id = 8399571083)
2025-12-27 01:25:42,555 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:25:42,555 - aiogram.dispatcher - WARNING - Sleep for 5.141728 seconds and try again... (tryings = 297, bot id = 8399571083)
2025-12-27 01:25:47,824 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:25:47,824 - aiogram.dispatcher - WARNING - Sleep for 4.878132 seconds and try again... (tryings = 298, bot id = 8399571083)
2025-12-27 01:25:52,827 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:25:52,827 - aiogram.dispatcher - WARNING - Sleep for 5.160242 seconds and try again... (tryings = 299, bot id = 8399571083)
2025-12-27 01:25:58,121 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:25:58,121 - aiogram.dispatcher - WARNING - Sleep for 5.049855 seconds and try again... (tryings = 300, bot id = 8399571083)
2025-12-27 01:26:03,283 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:26:03,283 - aiogram.dispatcher - WARNING - Sleep for 4.942858 seconds and try again... (tryings = 301, bot id = 8399571083)
2025-12-27 01:26:08,348 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:26:08,348 - aiogram.dispatcher - WARNING - Sleep for 4.928141 seconds and try again... (tryings = 302, bot id = 8399571083)
2025-12-27 01:26:13,400 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:26:13,400 - aiogram.dispatcher - WARNING - Sleep for 4.950863 seconds and try again... (tryings = 303, bot id = 8399571083)
2025-12-27 01:26:18,497 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:26:18,497 - aiogram.dispatcher - WARNING - Sleep for 4.886880 seconds and try again... (tryings = 304, bot id = 8399571083)
2025-12-27 01:26:23,502 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:26:23,502 - aiogram.dispatcher - WARNING - Sleep for 5.081934 seconds and try again... (tryings = 305, bot id = 8399571083)
2025-12-27 01:26:28,702 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:26:28,703 - aiogram.dispatcher - WARNING - Sleep for 4.907495 seconds and try again... (tryings = 306, bot id = 8399571083)
2025-12-27 01:26:33,729 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:26:33,729 - aiogram.dispatcher - WARNING - Sleep for 5.170126 seconds and try again... (tryings = 307, bot id = 8399571083)
2025-12-27 01:26:39,062 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:26:39,062 - aiogram.dispatcher - WARNING - Sleep for 5.052911 seconds and try again... (tryings = 308, bot id = 8399571083)
2025-12-27 01:26:39,743 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-27 01:26:39,743 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8286574516)
2025-12-27 01:26:43,996 - __main__ - INFO - База данных создана
2025-12-27 01:26:44,240 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:26:44,240 - aiogram.dispatcher - WARNING - Sleep for 4.871048 seconds and try again... (tryings = 309, bot id = 8399571083)
2025-12-27 01:26:49,230 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:26:49,230 - aiogram.dispatcher - WARNING - Sleep for 4.867261 seconds and try again... (tryings = 310, bot id = 8399571083)
2025-12-27 01:26:50,633 - vpn_bot - INFO - Уведомление отправлено админу 7672667340
2025-12-27 01:26:50,634 - vpn_bot - INFO - Планировщик временно отключен (ошибка структуры БД)
2025-12-27 01:26:50,634 - vpn_bot - INFO - Бот запускается...
2025-12-27 01:26:54,215 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:26:54,215 - aiogram.dispatcher - WARNING - Sleep for 5.055279 seconds and try again... (tryings = 311, bot id = 8399571083)
2025-12-27 01:26:59,375 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:26:59,375 - aiogram.dispatcher - WARNING - Sleep for 4.982180 seconds and try again... (tryings = 312, bot id = 8399571083)
2025-12-27 01:27:04,483 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:27:04,484 - aiogram.dispatcher - WARNING - Sleep for 4.996888 seconds and try again... (tryings = 313, bot id = 8399571083)
2025-12-27 01:27:09,598 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:27:09,599 - aiogram.dispatcher - WARNING - Sleep for 5.099264 seconds and try again... (tryings = 314, bot id = 8399571083)
2025-12-27 01:27:14,823 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:27:14,823 - aiogram.dispatcher - WARNING - Sleep for 4.973564 seconds and try again... (tryings = 315, bot id = 8399571083)
2025-12-27 01:27:19,912 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:27:19,912 - aiogram.dispatcher - WARNING - Sleep for 5.082378 seconds and try again... (tryings = 316, bot id = 8399571083)
2025-12-27 01:27:25,116 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:27:25,116 - aiogram.dispatcher - WARNING - Sleep for 4.994684 seconds and try again... (tryings = 317, bot id = 8399571083)
2025-12-27 01:27:30,228 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:27:30,229 - aiogram.dispatcher - WARNING - Sleep for 5.150281 seconds and try again... (tryings = 318, bot id = 8399571083)
2025-12-27 01:27:35,505 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:27:35,505 - aiogram.dispatcher - WARNING - Sleep for 5.046023 seconds and try again... (tryings = 319, bot id = 8399571083)
2025-12-27 01:27:40,675 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:27:40,675 - aiogram.dispatcher - WARNING - Sleep for 4.850087 seconds and try again... (tryings = 320, bot id = 8399571083)
2025-12-27 01:27:45,649 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:27:45,649 - aiogram.dispatcher - WARNING - Sleep for 4.969742 seconds and try again... (tryings = 321, bot id = 8399571083)
2025-12-27 01:27:50,737 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:27:50,737 - aiogram.dispatcher - WARNING - Sleep for 5.081389 seconds and try again... (tryings = 322, bot id = 8399571083)
2025-12-27 01:27:55,942 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:27:55,943 - aiogram.dispatcher - WARNING - Sleep for 4.960625 seconds and try again... (tryings = 323, bot id = 8399571083)
2025-12-27 01:28:01,022 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:28:01,022 - aiogram.dispatcher - WARNING - Sleep for 4.992860 seconds and try again... (tryings = 324, bot id = 8399571083)
2025-12-27 01:28:06,134 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:28:06,135 - aiogram.dispatcher - WARNING - Sleep for 5.012599 seconds and try again... (tryings = 325, bot id = 8399571083)
2025-12-27 01:28:11,261 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:28:11,261 - aiogram.dispatcher - WARNING - Sleep for 4.822489 seconds and try again... (tryings = 326, bot id = 8399571083)
2025-12-27 01:28:16,207 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:28:16,207 - aiogram.dispatcher - WARNING - Sleep for 5.118589 seconds and try again... (tryings = 327, bot id = 8399571083)
2025-12-27 01:28:21,456 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:28:21,456 - aiogram.dispatcher - WARNING - Sleep for 4.986927 seconds and try again... (tryings = 328, bot id = 8399571083)
2025-12-27 01:28:26,556 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:28:26,556 - aiogram.dispatcher - WARNING - Sleep for 4.968935 seconds and try again... (tryings = 329, bot id = 8399571083)
2025-12-27 01:28:31,633 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:28:31,633 - aiogram.dispatcher - WARNING - Sleep for 5.099192 seconds and try again... (tryings = 330, bot id = 8399571083)
2025-12-27 01:28:32,852 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-27 01:28:32,852 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8286574516)
2025-12-27 01:28:36,858 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:28:36,858 - aiogram.dispatcher - WARNING - Sleep for 5.038574 seconds and try again... (tryings = 331, bot id = 8399571083)
2025-12-27 01:28:39,935 - __main__ - INFO - База данных создана
2025-12-27 01:28:42,022 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:28:42,023 - aiogram.dispatcher - WARNING - Sleep for 5.096903 seconds and try again... (tryings = 332, bot id = 8399571083)
2025-12-27 01:28:46,338 - vpn_bot - INFO - Уведомление отправлено админу 7672667340
2025-12-27 01:28:46,339 - vpn_bot - INFO - Планировщик временно отключен (ошибка структуры БД)
2025-12-27 01:28:46,339 - vpn_bot - INFO - Бот запускается...
2025-12-27 01:28:47,240 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:28:47,240 - aiogram.dispatcher - WARNING - Sleep for 5.020960 seconds and try again... (tryings = 333, bot id = 8399571083)
2025-12-27 01:28:52,379 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:28:52,380 - aiogram.dispatcher - WARNING - Sleep for 4.993790 seconds and try again... (tryings = 334, bot id = 8399571083)
2025-12-27 01:28:57,493 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:28:57,493 - aiogram.dispatcher - WARNING - Sleep for 5.056413 seconds and try again... (tryings = 335, bot id = 8399571083)
2025-12-27 01:29:02,682 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:29:02,682 - aiogram.dispatcher - WARNING - Sleep for 5.137609 seconds and try again... (tryings = 336, bot id = 8399571083)
2025-12-27 01:29:07,945 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:29:07,945 - aiogram.dispatcher - WARNING - Sleep for 4.793053 seconds and try again... (tryings = 337, bot id = 8399571083)
2025-12-27 01:29:12,857 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:29:12,857 - aiogram.dispatcher - WARNING - Sleep for 4.884301 seconds and try again... (tryings = 338, bot id = 8399571083)
2025-12-27 01:29:17,854 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:29:17,854 - aiogram.dispatcher - WARNING - Sleep for 4.830137 seconds and try again... (tryings = 339, bot id = 8399571083)
2025-12-27 01:29:22,808 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:29:22,808 - aiogram.dispatcher - WARNING - Sleep for 4.908695 seconds and try again... (tryings = 340, bot id = 8399571083)
2025-12-27 01:29:27,836 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:29:27,836 - aiogram.dispatcher - WARNING - Sleep for 5.104565 seconds and try again... (tryings = 341, bot id = 8399571083)
2025-12-27 01:29:33,060 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:29:33,060 - aiogram.dispatcher - WARNING - Sleep for 4.987875 seconds and try again... (tryings = 342, bot id = 8399571083)
2025-12-27 01:29:38,170 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:29:38,170 - aiogram.dispatcher - WARNING - Sleep for 5.041212 seconds and try again... (tryings = 343, bot id = 8399571083)
2025-12-27 01:29:43,330 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:29:43,330 - aiogram.dispatcher - WARNING - Sleep for 5.051408 seconds and try again... (tryings = 344, bot id = 8399571083)
2025-12-27 01:29:48,505 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:29:48,505 - aiogram.dispatcher - WARNING - Sleep for 4.915975 seconds and try again... (tryings = 345, bot id = 8399571083)
2025-12-27 01:29:53,535 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:29:53,535 - aiogram.dispatcher - WARNING - Sleep for 4.910248 seconds and try again... (tryings = 346, bot id = 8399571083)
2025-12-27 01:29:58,563 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:29:58,563 - aiogram.dispatcher - WARNING - Sleep for 4.994369 seconds and try again... (tryings = 347, bot id = 8399571083)
2025-12-27 01:30:03,687 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:30:03,687 - aiogram.dispatcher - WARNING - Sleep for 4.735245 seconds and try again... (tryings = 348, bot id = 8399571083)
2025-12-27 01:30:05,574 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-27 01:30:05,574 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8286574516)
2025-12-27 01:30:08,539 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:30:08,539 - aiogram.dispatcher - WARNING - Sleep for 4.971144 seconds and try again... (tryings = 349, bot id = 8399571083)
2025-12-27 01:30:13,623 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:30:13,623 - aiogram.dispatcher - WARNING - Sleep for 5.062738 seconds and try again... (tryings = 350, bot id = 8399571083)
2025-12-27 01:30:14,652 - __main__ - INFO - База данных создана
2025-12-27 01:30:19,078 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:30:19,078 - aiogram.dispatcher - WARNING - Sleep for 4.947319 seconds and try again... (tryings = 351, bot id = 8399571083)
2025-12-27 01:30:21,102 - vpn_bot - INFO - Уведомление отправлено админу 7672667340
2025-12-27 01:30:21,102 - vpn_bot - INFO - Планировщик временно отключен (ошибка структуры БД)
2025-12-27 01:30:21,103 - vpn_bot - INFO - Бот запускается...
2025-12-27 01:30:24,148 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:30:24,149 - aiogram.dispatcher - WARNING - Sleep for 4.934229 seconds and try again... (tryings = 352, bot id = 8399571083)
2025-12-27 01:30:29,223 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:30:29,223 - aiogram.dispatcher - WARNING - Sleep for 4.881901 seconds and try again... (tryings = 353, bot id = 8399571083)
2025-12-27 01:30:34,239 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:30:34,239 - aiogram.dispatcher - WARNING - Sleep for 4.941996 seconds and try again... (tryings = 354, bot id = 8399571083)
2025-12-27 01:30:39,316 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:30:39,317 - aiogram.dispatcher - WARNING - Sleep for 5.201910 seconds and try again... (tryings = 355, bot id = 8399571083)
2025-12-27 01:30:44,647 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:30:44,647 - aiogram.dispatcher - WARNING - Sleep for 5.093959 seconds and try again... (tryings = 356, bot id = 8399571083)
2025-12-27 01:30:51,267 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:30:51,268 - aiogram.dispatcher - WARNING - Sleep for 5.162560 seconds and try again... (tryings = 357, bot id = 8399571083)
2025-12-27 01:30:56,569 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:30:56,569 - aiogram.dispatcher - WARNING - Sleep for 5.210781 seconds and try again... (tryings = 358, bot id = 8399571083)
2025-12-27 01:31:01,904 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:31:01,904 - aiogram.dispatcher - WARNING - Sleep for 5.022731 seconds and try again... (tryings = 359, bot id = 8399571083)
2025-12-27 01:31:07,053 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:31:07,053 - aiogram.dispatcher - WARNING - Sleep for 4.833716 seconds and try again... (tryings = 360, bot id = 8399571083)
2025-12-27 01:31:12,009 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:31:12,009 - aiogram.dispatcher - WARNING - Sleep for 5.137699 seconds and try again... (tryings = 361, bot id = 8399571083)
2025-12-27 01:31:17,276 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:31:17,276 - aiogram.dispatcher - WARNING - Sleep for 5.227188 seconds and try again... (tryings = 362, bot id = 8399571083)
2025-12-27 01:31:22,630 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:31:22,630 - aiogram.dispatcher - WARNING - Sleep for 5.065823 seconds and try again... (tryings = 363, bot id = 8399571083)
2025-12-27 01:31:27,832 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:31:27,832 - aiogram.dispatcher - WARNING - Sleep for 4.845580 seconds and try again... (tryings = 364, bot id = 8399571083)
2025-12-27 01:31:32,805 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:31:32,805 - aiogram.dispatcher - WARNING - Sleep for 5.027479 seconds and try again... (tryings = 365, bot id = 8399571083)
2025-12-27 01:31:37,962 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:31:37,963 - aiogram.dispatcher - WARNING - Sleep for 4.832506 seconds and try again... (tryings = 366, bot id = 8399571083)
2025-12-27 01:31:42,921 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:31:42,922 - aiogram.dispatcher - WARNING - Sleep for 5.054810 seconds and try again... (tryings = 367, bot id = 8399571083)
2025-12-27 01:31:48,100 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:31:48,100 - aiogram.dispatcher - WARNING - Sleep for 4.948615 seconds and try again... (tryings = 368, bot id = 8399571083)
2025-12-27 01:31:53,178 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:31:53,178 - aiogram.dispatcher - WARNING - Sleep for 5.046635 seconds and try again... (tryings = 369, bot id = 8399571083)
2025-12-27 01:31:58,351 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:31:58,352 - aiogram.dispatcher - WARNING - Sleep for 5.025365 seconds and try again... (tryings = 370, bot id = 8399571083)
2025-12-27 01:32:03,510 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:32:03,510 - aiogram.dispatcher - WARNING - Sleep for 4.892300 seconds and try again... (tryings = 371, bot id = 8399571083)
2025-12-27 01:32:08,534 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:32:08,534 - aiogram.dispatcher - WARNING - Sleep for 5.166485 seconds and try again... (tryings = 372, bot id = 8399571083)
2025-12-27 01:32:13,829 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:32:13,829 - aiogram.dispatcher - WARNING - Sleep for 4.943110 seconds and try again... (tryings = 373, bot id = 8399571083)
2025-12-27 01:32:18,910 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:32:18,910 - aiogram.dispatcher - WARNING - Sleep for 5.150101 seconds and try again... (tryings = 374, bot id = 8399571083)
2025-12-27 01:32:24,187 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:32:24,187 - aiogram.dispatcher - WARNING - Sleep for 4.878220 seconds and try again... (tryings = 375, bot id = 8399571083)
2025-12-27 01:32:28,479 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-27 01:32:28,479 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8286574516)
2025-12-27 01:32:29,200 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:32:29,200 - aiogram.dispatcher - WARNING - Sleep for 5.010442 seconds and try again... (tryings = 376, bot id = 8399571083)
2025-12-27 01:32:31,553 - __main__ - INFO - База данных создана
2025-12-27 01:32:34,341 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:32:34,341 - aiogram.dispatcher - WARNING - Sleep for 5.085417 seconds and try again... (tryings = 377, bot id = 8399571083)
2025-12-27 01:32:36,821 - __main__ - CRITICAL - Критическая ошибка: name 'logging' is not defined
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\run.py", line 72, in main
    from src.main import main as bot_main
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\main.py", line 9, in <module>
    from src.bot.loader import setup_middlewares, setup_routers
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\loader.py", line 5, in <module>
    from src.handlers.start import start_router
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\__init__.py", line 1, in <module>
    from .start import start_router
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\start.py", line 81, in <module>
    logger = logging.getLogger(__name__)
             ^^^^^^^
NameError: name 'logging' is not defined
2025-12-27 01:32:39,544 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:32:39,544 - aiogram.dispatcher - WARNING - Sleep for 4.998133 seconds and try again... (tryings = 378, bot id = 8399571083)
2025-12-27 01:32:44,672 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:32:44,672 - aiogram.dispatcher - WARNING - Sleep for 5.035767 seconds and try again... (tryings = 379, bot id = 8399571083)
2025-12-27 01:32:49,840 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:32:49,840 - aiogram.dispatcher - WARNING - Sleep for 4.794946 seconds and try again... (tryings = 380, bot id = 8399571083)
2025-12-27 01:32:54,746 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:32:54,746 - aiogram.dispatcher - WARNING - Sleep for 5.074045 seconds and try again... (tryings = 381, bot id = 8399571083)
2025-12-27 01:32:59,942 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:32:59,942 - aiogram.dispatcher - WARNING - Sleep for 5.224873 seconds and try again... (tryings = 382, bot id = 8399571083)
2025-12-27 01:33:05,288 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:33:05,288 - aiogram.dispatcher - WARNING - Sleep for 5.090673 seconds and try again... (tryings = 383, bot id = 8399571083)
2025-12-27 01:33:10,500 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:33:10,500 - aiogram.dispatcher - WARNING - Sleep for 5.098296 seconds and try again... (tryings = 384, bot id = 8399571083)
2025-12-27 01:33:15,728 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:33:15,728 - aiogram.dispatcher - WARNING - Sleep for 5.115865 seconds and try again... (tryings = 385, bot id = 8399571083)
2025-12-27 01:33:20,977 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:33:20,977 - aiogram.dispatcher - WARNING - Sleep for 4.961134 seconds and try again... (tryings = 386, bot id = 8399571083)
2025-12-27 01:33:26,076 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:33:26,076 - aiogram.dispatcher - WARNING - Sleep for 5.000026 seconds and try again... (tryings = 387, bot id = 8399571083)
2025-12-27 01:33:31,208 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:33:31,208 - aiogram.dispatcher - WARNING - Sleep for 4.797408 seconds and try again... (tryings = 388, bot id = 8399571083)
2025-12-27 01:33:36,128 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:33:36,128 - aiogram.dispatcher - WARNING - Sleep for 5.061664 seconds and try again... (tryings = 389, bot id = 8399571083)
2025-12-27 01:33:41,321 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:33:41,321 - aiogram.dispatcher - WARNING - Sleep for 4.972921 seconds and try again... (tryings = 390, bot id = 8399571083)
2025-12-27 01:33:46,428 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:33:46,428 - aiogram.dispatcher - WARNING - Sleep for 5.143457 seconds and try again... (tryings = 391, bot id = 8399571083)
2025-12-27 01:33:51,695 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:33:51,695 - aiogram.dispatcher - WARNING - Sleep for 4.994534 seconds and try again... (tryings = 392, bot id = 8399571083)
2025-12-27 01:33:56,813 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:33:56,813 - aiogram.dispatcher - WARNING - Sleep for 5.093493 seconds and try again... (tryings = 393, bot id = 8399571083)
2025-12-27 01:34:02,029 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:34:02,029 - aiogram.dispatcher - WARNING - Sleep for 4.931226 seconds and try again... (tryings = 394, bot id = 8399571083)
2025-12-27 01:34:07,083 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:34:07,083 - aiogram.dispatcher - WARNING - Sleep for 4.891397 seconds and try again... (tryings = 395, bot id = 8399571083)
2025-12-27 01:34:12,104 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:34:12,104 - aiogram.dispatcher - WARNING - Sleep for 4.896185 seconds and try again... (tryings = 396, bot id = 8399571083)
2025-12-27 01:34:17,126 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:34:17,127 - aiogram.dispatcher - WARNING - Sleep for 4.966128 seconds and try again... (tryings = 397, bot id = 8399571083)
2025-12-27 01:34:22,216 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:34:22,217 - aiogram.dispatcher - WARNING - Sleep for 4.947252 seconds and try again... (tryings = 398, bot id = 8399571083)
2025-12-27 01:34:27,291 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:34:27,291 - aiogram.dispatcher - WARNING - Sleep for 5.078864 seconds and try again... (tryings = 399, bot id = 8399571083)
2025-12-27 01:34:32,498 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:34:32,498 - aiogram.dispatcher - WARNING - Sleep for 4.894927 seconds and try again... (tryings = 400, bot id = 8399571083)
2025-12-27 01:34:37,524 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:34:37,524 - aiogram.dispatcher - WARNING - Sleep for 4.993164 seconds and try again... (tryings = 401, bot id = 8399571083)
2025-12-27 01:34:42,574 - __main__ - INFO - База данных создана
2025-12-27 01:34:42,646 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:34:42,646 - aiogram.dispatcher - WARNING - Sleep for 4.891846 seconds and try again... (tryings = 402, bot id = 8399571083)
2025-12-27 01:34:47,674 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:34:47,674 - aiogram.dispatcher - WARNING - Sleep for 4.898244 seconds and try again... (tryings = 403, bot id = 8399571083)
2025-12-27 01:34:48,818 - vpn_bot - INFO - Уведомление отправлено админу 7672667340
2025-12-27 01:34:48,818 - vpn_bot - INFO - Планировщик временно отключен (ошибка структуры БД)
2025-12-27 01:34:48,819 - vpn_bot - INFO - Бот запускается...
2025-12-27 01:34:52,707 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:34:52,707 - aiogram.dispatcher - WARNING - Sleep for 5.050767 seconds and try again... (tryings = 404, bot id = 8399571083)
2025-12-27 01:34:57,891 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:34:57,891 - aiogram.dispatcher - WARNING - Sleep for 4.872250 seconds and try again... (tryings = 405, bot id = 8399571083)
2025-12-27 01:35:02,897 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:35:02,897 - aiogram.dispatcher - WARNING - Sleep for 4.974813 seconds and try again... (tryings = 406, bot id = 8399571083)
2025-12-27 01:35:07,996 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:35:07,996 - aiogram.dispatcher - WARNING - Sleep for 5.041864 seconds and try again... (tryings = 407, bot id = 8399571083)
2025-12-27 01:35:13,156 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:35:13,156 - aiogram.dispatcher - WARNING - Sleep for 5.023560 seconds and try again... (tryings = 408, bot id = 8399571083)
2025-12-27 01:35:18,301 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:35:18,301 - aiogram.dispatcher - WARNING - Sleep for 4.970651 seconds and try again... (tryings = 409, bot id = 8399571083)
2025-12-27 01:35:23,407 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:35:23,408 - aiogram.dispatcher - WARNING - Sleep for 4.957955 seconds and try again... (tryings = 410, bot id = 8399571083)
2025-12-27 01:35:28,509 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:35:28,509 - aiogram.dispatcher - WARNING - Sleep for 4.952863 seconds and try again... (tryings = 411, bot id = 8399571083)
2025-12-27 01:35:33,593 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:35:33,593 - aiogram.dispatcher - WARNING - Sleep for 4.939716 seconds and try again... (tryings = 412, bot id = 8399571083)
2025-12-27 01:35:38,666 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:35:38,667 - aiogram.dispatcher - WARNING - Sleep for 4.915773 seconds and try again... (tryings = 413, bot id = 8399571083)
2025-12-27 01:35:43,704 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:35:43,704 - aiogram.dispatcher - WARNING - Sleep for 5.008723 seconds and try again... (tryings = 414, bot id = 8399571083)
2025-12-27 01:35:48,844 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:35:48,844 - aiogram.dispatcher - WARNING - Sleep for 4.900344 seconds and try again... (tryings = 415, bot id = 8399571083)
2025-12-27 01:35:53,874 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:35:53,874 - aiogram.dispatcher - WARNING - Sleep for 4.984973 seconds and try again... (tryings = 416, bot id = 8399571083)
2025-12-27 01:35:58,983 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:35:58,983 - aiogram.dispatcher - WARNING - Sleep for 5.074930 seconds and try again... (tryings = 417, bot id = 8399571083)
2025-12-27 01:36:04,179 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:36:04,179 - aiogram.dispatcher - WARNING - Sleep for 4.952724 seconds and try again... (tryings = 418, bot id = 8399571083)
2025-12-27 01:36:09,255 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:36:09,255 - aiogram.dispatcher - WARNING - Sleep for 4.899098 seconds and try again... (tryings = 419, bot id = 8399571083)
2025-12-27 01:36:14,280 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:36:14,280 - aiogram.dispatcher - WARNING - Sleep for 4.935612 seconds and try again... (tryings = 420, bot id = 8399571083)
2025-12-27 01:36:19,355 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:36:19,355 - aiogram.dispatcher - WARNING - Sleep for 4.962385 seconds and try again... (tryings = 421, bot id = 8399571083)
2025-12-27 01:36:24,455 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:36:24,455 - aiogram.dispatcher - WARNING - Sleep for 5.055013 seconds and try again... (tryings = 422, bot id = 8399571083)
2025-12-27 01:36:29,646 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:36:29,646 - aiogram.dispatcher - WARNING - Sleep for 5.045318 seconds and try again... (tryings = 423, bot id = 8399571083)
2025-12-27 01:36:34,814 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:36:34,814 - aiogram.dispatcher - WARNING - Sleep for 5.112341 seconds and try again... (tryings = 424, bot id = 8399571083)
2025-12-27 01:36:40,053 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:36:40,053 - aiogram.dispatcher - WARNING - Sleep for 5.065088 seconds and try again... (tryings = 425, bot id = 8399571083)
2025-12-27 01:36:45,250 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:36:45,250 - aiogram.dispatcher - WARNING - Sleep for 5.033286 seconds and try again... (tryings = 426, bot id = 8399571083)
2025-12-27 01:36:50,418 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:36:50,419 - aiogram.dispatcher - WARNING - Sleep for 4.848403 seconds and try again... (tryings = 427, bot id = 8399571083)
2025-12-27 01:36:55,407 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:36:55,407 - aiogram.dispatcher - WARNING - Sleep for 4.907889 seconds and try again... (tryings = 428, bot id = 8399571083)
2025-12-27 01:37:00,453 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:37:00,454 - aiogram.dispatcher - WARNING - Sleep for 5.042674 seconds and try again... (tryings = 429, bot id = 8399571083)
2025-12-27 01:37:05,630 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:37:05,630 - aiogram.dispatcher - WARNING - Sleep for 5.159131 seconds and try again... (tryings = 430, bot id = 8399571083)
2025-12-27 01:37:10,925 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:37:10,925 - aiogram.dispatcher - WARNING - Sleep for 4.819184 seconds and try again... (tryings = 431, bot id = 8399571083)
2025-12-27 01:37:15,879 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:37:15,880 - aiogram.dispatcher - WARNING - Sleep for 4.886163 seconds and try again... (tryings = 432, bot id = 8399571083)
2025-12-27 01:37:20,895 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:37:20,895 - aiogram.dispatcher - WARNING - Sleep for 5.179813 seconds and try again... (tryings = 433, bot id = 8399571083)
2025-12-27 01:37:26,203 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:37:26,203 - aiogram.dispatcher - WARNING - Sleep for 4.943459 seconds and try again... (tryings = 434, bot id = 8399571083)
2025-12-27 01:37:31,274 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:37:31,274 - aiogram.dispatcher - WARNING - Sleep for 5.067544 seconds and try again... (tryings = 435, bot id = 8399571083)
2025-12-27 01:37:36,469 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:37:36,470 - aiogram.dispatcher - WARNING - Sleep for 5.007803 seconds and try again... (tryings = 436, bot id = 8399571083)
2025-12-27 01:37:41,604 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:37:41,604 - aiogram.dispatcher - WARNING - Sleep for 5.051379 seconds and try again... (tryings = 437, bot id = 8399571083)
2025-12-27 01:37:46,779 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:37:46,780 - aiogram.dispatcher - WARNING - Sleep for 5.268862 seconds and try again... (tryings = 438, bot id = 8399571083)
2025-12-27 01:37:52,180 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:37:52,180 - aiogram.dispatcher - WARNING - Sleep for 5.077907 seconds and try again... (tryings = 439, bot id = 8399571083)
2025-12-27 01:37:57,386 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:37:57,386 - aiogram.dispatcher - WARNING - Sleep for 5.047701 seconds and try again... (tryings = 440, bot id = 8399571083)
2025-12-27 01:38:02,563 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:38:02,563 - aiogram.dispatcher - WARNING - Sleep for 4.962072 seconds and try again... (tryings = 441, bot id = 8399571083)
2025-12-27 01:38:07,648 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:38:07,648 - aiogram.dispatcher - WARNING - Sleep for 5.038480 seconds and try again... (tryings = 442, bot id = 8399571083)
2025-12-27 01:38:12,810 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:38:12,810 - aiogram.dispatcher - WARNING - Sleep for 5.046568 seconds and try again... (tryings = 443, bot id = 8399571083)
2025-12-27 01:38:17,979 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:38:17,979 - aiogram.dispatcher - WARNING - Sleep for 5.104217 seconds and try again... (tryings = 444, bot id = 8399571083)
2025-12-27 01:38:23,212 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:38:23,213 - aiogram.dispatcher - WARNING - Sleep for 5.011167 seconds and try again... (tryings = 445, bot id = 8399571083)
2025-12-27 01:38:28,359 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:38:28,359 - aiogram.dispatcher - WARNING - Sleep for 4.998832 seconds and try again... (tryings = 446, bot id = 8399571083)
2025-12-27 01:38:33,501 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:38:33,502 - aiogram.dispatcher - WARNING - Sleep for 5.011757 seconds and try again... (tryings = 447, bot id = 8399571083)
2025-12-27 01:38:38,649 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:38:38,649 - aiogram.dispatcher - WARNING - Sleep for 5.045143 seconds and try again... (tryings = 448, bot id = 8399571083)
2025-12-27 01:38:43,819 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:38:43,819 - aiogram.dispatcher - WARNING - Sleep for 4.877444 seconds and try again... (tryings = 449, bot id = 8399571083)
2025-12-27 01:38:48,829 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:38:48,829 - aiogram.dispatcher - WARNING - Sleep for 5.137018 seconds and try again... (tryings = 450, bot id = 8399571083)
2025-12-27 01:38:54,310 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:38:54,311 - aiogram.dispatcher - WARNING - Sleep for 4.882721 seconds and try again... (tryings = 451, bot id = 8399571083)
2025-12-27 01:38:59,357 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:38:59,357 - aiogram.dispatcher - WARNING - Sleep for 4.824544 seconds and try again... (tryings = 452, bot id = 8399571083)
2025-12-27 01:39:04,293 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:39:04,293 - aiogram.dispatcher - WARNING - Sleep for 4.908779 seconds and try again... (tryings = 453, bot id = 8399571083)
2025-12-27 01:39:09,341 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:39:09,341 - aiogram.dispatcher - WARNING - Sleep for 4.904289 seconds and try again... (tryings = 454, bot id = 8399571083)
2025-12-27 01:39:14,356 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:39:14,356 - aiogram.dispatcher - WARNING - Sleep for 4.905974 seconds and try again... (tryings = 455, bot id = 8399571083)
2025-12-27 01:39:19,364 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:39:19,364 - aiogram.dispatcher - WARNING - Sleep for 5.047658 seconds and try again... (tryings = 456, bot id = 8399571083)
2025-12-27 01:39:24,525 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:39:24,525 - aiogram.dispatcher - WARNING - Sleep for 5.008668 seconds and try again... (tryings = 457, bot id = 8399571083)
2025-12-27 01:39:29,650 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:39:29,650 - aiogram.dispatcher - WARNING - Sleep for 4.918069 seconds and try again... (tryings = 458, bot id = 8399571083)
2025-12-27 01:39:34,670 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:39:34,670 - aiogram.dispatcher - WARNING - Sleep for 5.106631 seconds and try again... (tryings = 459, bot id = 8399571083)
2025-12-27 01:39:39,899 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:39:39,900 - aiogram.dispatcher - WARNING - Sleep for 5.078574 seconds and try again... (tryings = 460, bot id = 8399571083)
2025-12-27 01:39:45,102 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:39:45,102 - aiogram.dispatcher - WARNING - Sleep for 5.021439 seconds and try again... (tryings = 461, bot id = 8399571083)
2025-12-27 01:39:50,235 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:39:50,236 - aiogram.dispatcher - WARNING - Sleep for 5.042932 seconds and try again... (tryings = 462, bot id = 8399571083)
2025-12-27 01:39:55,409 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:39:55,410 - aiogram.dispatcher - WARNING - Sleep for 5.054059 seconds and try again... (tryings = 463, bot id = 8399571083)
2025-12-27 01:40:00,582 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:40:00,582 - aiogram.dispatcher - WARNING - Sleep for 5.029090 seconds and try again... (tryings = 464, bot id = 8399571083)
2025-12-27 01:40:05,736 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:40:05,736 - aiogram.dispatcher - WARNING - Sleep for 5.063797 seconds and try again... (tryings = 465, bot id = 8399571083)
2025-12-27 01:40:10,927 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:40:10,927 - aiogram.dispatcher - WARNING - Sleep for 4.962710 seconds and try again... (tryings = 466, bot id = 8399571083)
2025-12-27 01:40:16,011 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:40:16,011 - aiogram.dispatcher - WARNING - Sleep for 5.119871 seconds and try again... (tryings = 467, bot id = 8399571083)
2025-12-27 01:40:21,255 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:40:21,255 - aiogram.dispatcher - WARNING - Sleep for 4.947064 seconds and try again... (tryings = 468, bot id = 8399571083)
2025-12-27 01:40:26,312 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:40:26,312 - aiogram.dispatcher - WARNING - Sleep for 4.963871 seconds and try again... (tryings = 469, bot id = 8399571083)
2025-12-27 01:40:31,400 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:40:31,400 - aiogram.dispatcher - WARNING - Sleep for 5.001203 seconds and try again... (tryings = 470, bot id = 8399571083)
2025-12-27 01:40:36,525 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:40:36,525 - aiogram.dispatcher - WARNING - Sleep for 4.983780 seconds and try again... (tryings = 471, bot id = 8399571083)
2025-12-27 01:40:39,767 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-27 01:40:39,767 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8286574516)
2025-12-27 01:40:41,624 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:40:41,624 - aiogram.dispatcher - WARNING - Sleep for 5.109219 seconds and try again... (tryings = 472, bot id = 8399571083)
2025-12-27 01:40:46,859 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:40:46,859 - aiogram.dispatcher - WARNING - Sleep for 4.960628 seconds and try again... (tryings = 473, bot id = 8399571083)
2025-12-27 01:40:51,934 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:40:51,934 - aiogram.dispatcher - WARNING - Sleep for 5.002688 seconds and try again... (tryings = 474, bot id = 8399571083)
2025-12-27 01:40:57,050 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:40:57,050 - aiogram.dispatcher - WARNING - Sleep for 5.096496 seconds and try again... (tryings = 475, bot id = 8399571083)
2025-12-27 01:41:02,284 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:41:02,284 - aiogram.dispatcher - WARNING - Sleep for 5.009273 seconds and try again... (tryings = 476, bot id = 8399571083)
2025-12-27 01:41:07,412 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:41:07,412 - aiogram.dispatcher - WARNING - Sleep for 5.196918 seconds and try again... (tryings = 477, bot id = 8399571083)
2025-12-27 01:41:12,731 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:41:12,732 - aiogram.dispatcher - WARNING - Sleep for 4.996622 seconds and try again... (tryings = 478, bot id = 8399571083)
2025-12-27 01:41:17,839 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:41:17,839 - aiogram.dispatcher - WARNING - Sleep for 5.023524 seconds and try again... (tryings = 479, bot id = 8399571083)
2025-12-27 01:41:22,985 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:41:22,985 - aiogram.dispatcher - WARNING - Sleep for 5.004412 seconds and try again... (tryings = 480, bot id = 8399571083)
2025-12-27 01:41:28,110 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:41:28,111 - aiogram.dispatcher - WARNING - Sleep for 5.216637 seconds and try again... (tryings = 481, bot id = 8399571083)
2025-12-27 01:41:33,441 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:41:33,441 - aiogram.dispatcher - WARNING - Sleep for 4.985322 seconds and try again... (tryings = 482, bot id = 8399571083)
2025-12-27 01:41:38,552 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:41:38,552 - aiogram.dispatcher - WARNING - Sleep for 4.991293 seconds and try again... (tryings = 483, bot id = 8399571083)
2025-12-27 01:41:43,668 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:41:43,668 - aiogram.dispatcher - WARNING - Sleep for 5.068430 seconds and try again... (tryings = 484, bot id = 8399571083)
2025-12-27 01:41:48,848 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:41:48,848 - aiogram.dispatcher - WARNING - Sleep for 5.028673 seconds and try again... (tryings = 485, bot id = 8399571083)
2025-12-27 01:41:53,990 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:41:53,990 - aiogram.dispatcher - WARNING - Sleep for 4.884456 seconds and try again... (tryings = 486, bot id = 8399571083)
2025-12-27 01:41:58,997 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:41:58,997 - aiogram.dispatcher - WARNING - Sleep for 5.035472 seconds and try again... (tryings = 487, bot id = 8399571083)
2025-12-27 01:42:04,151 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:42:04,151 - aiogram.dispatcher - WARNING - Sleep for 4.882568 seconds and try again... (tryings = 488, bot id = 8399571083)
2025-12-27 01:42:09,147 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:42:09,147 - aiogram.dispatcher - WARNING - Sleep for 5.170435 seconds and try again... (tryings = 489, bot id = 8399571083)
2025-12-27 01:42:14,314 - __main__ - INFO - База данных создана
2025-12-27 01:42:14,440 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:42:14,440 - aiogram.dispatcher - WARNING - Sleep for 4.847443 seconds and try again... (tryings = 490, bot id = 8399571083)
2025-12-27 01:42:19,405 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:42:19,405 - aiogram.dispatcher - WARNING - Sleep for 5.178187 seconds and try again... (tryings = 491, bot id = 8399571083)
2025-12-27 01:42:24,700 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:42:24,701 - aiogram.dispatcher - WARNING - Sleep for 4.930932 seconds and try again... (tryings = 492, bot id = 8399571083)
2025-12-27 01:42:29,753 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:42:29,753 - aiogram.dispatcher - WARNING - Sleep for 5.000785 seconds and try again... (tryings = 493, bot id = 8399571083)
2025-12-27 01:42:34,877 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:42:34,877 - aiogram.dispatcher - WARNING - Sleep for 5.021844 seconds and try again... (tryings = 494, bot id = 8399571083)
2025-12-27 01:42:40,024 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:42:40,025 - aiogram.dispatcher - WARNING - Sleep for 4.988322 seconds and try again... (tryings = 495, bot id = 8399571083)
2025-12-27 01:42:45,127 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:42:45,128 - aiogram.dispatcher - WARNING - Sleep for 5.005590 seconds and try again... (tryings = 496, bot id = 8399571083)
2025-12-27 01:42:50,248 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:42:50,248 - aiogram.dispatcher - WARNING - Sleep for 5.017896 seconds and try again... (tryings = 497, bot id = 8399571083)
2025-12-27 01:42:55,382 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:42:55,382 - aiogram.dispatcher - WARNING - Sleep for 4.901566 seconds and try again... (tryings = 498, bot id = 8399571083)
2025-12-27 01:43:00,413 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:43:00,413 - aiogram.dispatcher - WARNING - Sleep for 4.860838 seconds and try again... (tryings = 499, bot id = 8399571083)
2025-12-27 01:43:05,393 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:43:05,394 - aiogram.dispatcher - WARNING - Sleep for 5.024574 seconds and try again... (tryings = 500, bot id = 8399571083)
2025-12-27 01:43:10,536 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:43:10,536 - aiogram.dispatcher - WARNING - Sleep for 4.980247 seconds and try again... (tryings = 501, bot id = 8399571083)
2025-12-27 01:43:15,645 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:43:15,645 - aiogram.dispatcher - WARNING - Sleep for 5.047867 seconds and try again... (tryings = 502, bot id = 8399571083)
2025-12-27 01:43:20,813 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:43:20,813 - aiogram.dispatcher - WARNING - Sleep for 4.939339 seconds and try again... (tryings = 503, bot id = 8399571083)
2025-12-27 01:43:25,880 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:43:25,881 - aiogram.dispatcher - WARNING - Sleep for 5.080671 seconds and try again... (tryings = 504, bot id = 8399571083)
2025-12-27 01:43:31,090 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:43:31,090 - aiogram.dispatcher - WARNING - Sleep for 4.860159 seconds and try again... (tryings = 505, bot id = 8399571083)
2025-12-27 01:43:36,088 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:43:36,088 - aiogram.dispatcher - WARNING - Sleep for 5.011459 seconds and try again... (tryings = 506, bot id = 8399571083)
2025-12-27 01:43:41,226 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:43:41,227 - aiogram.dispatcher - WARNING - Sleep for 5.002075 seconds and try again... (tryings = 507, bot id = 8399571083)
2025-12-27 01:43:46,615 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:43:46,615 - aiogram.dispatcher - WARNING - Sleep for 4.951857 seconds and try again... (tryings = 508, bot id = 8399571083)
2025-12-27 01:43:51,703 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:43:51,704 - aiogram.dispatcher - WARNING - Sleep for 5.033285 seconds and try again... (tryings = 509, bot id = 8399571083)
2025-12-27 01:43:56,852 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:43:56,852 - aiogram.dispatcher - WARNING - Sleep for 5.006771 seconds and try again... (tryings = 510, bot id = 8399571083)
2025-12-27 01:44:01,974 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:44:01,975 - aiogram.dispatcher - WARNING - Sleep for 4.939929 seconds and try again... (tryings = 511, bot id = 8399571083)
2025-12-27 01:44:07,034 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:44:07,034 - aiogram.dispatcher - WARNING - Sleep for 5.188126 seconds and try again... (tryings = 512, bot id = 8399571083)
2025-12-27 01:44:12,348 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:44:12,348 - aiogram.dispatcher - WARNING - Sleep for 4.949365 seconds and try again... (tryings = 513, bot id = 8399571083)
2025-12-27 01:44:17,412 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:44:17,413 - aiogram.dispatcher - WARNING - Sleep for 4.906326 seconds and try again... (tryings = 514, bot id = 8399571083)
2025-12-27 01:44:22,441 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:44:22,442 - aiogram.dispatcher - WARNING - Sleep for 5.044670 seconds and try again... (tryings = 515, bot id = 8399571083)
2025-12-27 01:44:27,612 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:44:27,612 - aiogram.dispatcher - WARNING - Sleep for 4.900087 seconds and try again... (tryings = 516, bot id = 8399571083)
2025-12-27 01:44:32,636 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:44:32,636 - aiogram.dispatcher - WARNING - Sleep for 4.958456 seconds and try again... (tryings = 517, bot id = 8399571083)
2025-12-27 01:44:37,707 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:44:37,707 - aiogram.dispatcher - WARNING - Sleep for 4.967136 seconds and try again... (tryings = 518, bot id = 8399571083)
2025-12-27 01:44:42,786 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:44:42,786 - aiogram.dispatcher - WARNING - Sleep for 5.098806 seconds and try again... (tryings = 519, bot id = 8399571083)
2025-12-27 01:44:44,075 - __main__ - INFO - База данных создана
2025-12-27 01:44:48,007 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:44:48,007 - aiogram.dispatcher - WARNING - Sleep for 4.785689 seconds and try again... (tryings = 520, bot id = 8399571083)
2025-12-27 01:44:52,908 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:44:52,908 - aiogram.dispatcher - WARNING - Sleep for 5.197259 seconds and try again... (tryings = 521, bot id = 8399571083)
2025-12-27 01:44:58,225 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:44:58,226 - aiogram.dispatcher - WARNING - Sleep for 4.993290 seconds and try again... (tryings = 522, bot id = 8399571083)
2025-12-27 01:45:03,334 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:45:03,334 - aiogram.dispatcher - WARNING - Sleep for 4.926839 seconds and try again... (tryings = 523, bot id = 8399571083)
2025-12-27 01:45:08,372 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:45:08,372 - aiogram.dispatcher - WARNING - Sleep for 5.035853 seconds and try again... (tryings = 524, bot id = 8399571083)
2025-12-27 01:45:13,532 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:45:13,532 - aiogram.dispatcher - WARNING - Sleep for 5.000457 seconds and try again... (tryings = 525, bot id = 8399571083)
2025-12-27 01:45:18,673 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:45:18,673 - aiogram.dispatcher - WARNING - Sleep for 4.952058 seconds and try again... (tryings = 526, bot id = 8399571083)
2025-12-27 01:45:23,748 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:45:23,748 - aiogram.dispatcher - WARNING - Sleep for 5.011750 seconds and try again... (tryings = 527, bot id = 8399571083)
2025-12-27 01:45:28,878 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:45:28,878 - aiogram.dispatcher - WARNING - Sleep for 5.059380 seconds and try again... (tryings = 528, bot id = 8399571083)
2025-12-27 01:45:34,051 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:45:34,052 - aiogram.dispatcher - WARNING - Sleep for 5.058161 seconds and try again... (tryings = 529, bot id = 8399571083)
2025-12-27 01:45:39,234 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:45:39,234 - aiogram.dispatcher - WARNING - Sleep for 4.933852 seconds and try again... (tryings = 530, bot id = 8399571083)
2025-12-27 01:45:44,300 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:45:44,300 - aiogram.dispatcher - WARNING - Sleep for 5.028170 seconds and try again... (tryings = 531, bot id = 8399571083)
2025-12-27 01:45:49,450 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:45:49,450 - aiogram.dispatcher - WARNING - Sleep for 4.997762 seconds and try again... (tryings = 532, bot id = 8399571083)
2025-12-27 01:45:54,566 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:45:54,566 - aiogram.dispatcher - WARNING - Sleep for 4.931563 seconds and try again... (tryings = 533, bot id = 8399571083)
2025-12-27 01:45:59,612 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:45:59,612 - aiogram.dispatcher - WARNING - Sleep for 4.989942 seconds and try again... (tryings = 534, bot id = 8399571083)
2025-12-27 01:46:04,728 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:46:04,728 - aiogram.dispatcher - WARNING - Sleep for 4.981661 seconds and try again... (tryings = 535, bot id = 8399571083)
2025-12-27 01:46:09,822 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:46:09,823 - aiogram.dispatcher - WARNING - Sleep for 4.748167 seconds and try again... (tryings = 536, bot id = 8399571083)
2025-12-27 01:46:14,698 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:46:14,698 - aiogram.dispatcher - WARNING - Sleep for 5.113656 seconds and try again... (tryings = 537, bot id = 8399571083)
2025-12-27 01:46:19,926 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:46:19,926 - aiogram.dispatcher - WARNING - Sleep for 5.128554 seconds and try again... (tryings = 538, bot id = 8399571083)
2025-12-27 01:46:25,253 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:46:25,255 - aiogram.dispatcher - WARNING - Sleep for 5.051413 seconds and try again... (tryings = 539, bot id = 8399571083)
2025-12-27 01:46:30,432 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:46:30,433 - aiogram.dispatcher - WARNING - Sleep for 5.072256 seconds and try again... (tryings = 540, bot id = 8399571083)
2025-12-27 01:46:35,613 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:46:35,614 - aiogram.dispatcher - WARNING - Sleep for 4.944874 seconds and try again... (tryings = 541, bot id = 8399571083)
2025-12-27 01:46:40,680 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:46:40,680 - aiogram.dispatcher - WARNING - Sleep for 4.966097 seconds and try again... (tryings = 542, bot id = 8399571083)
2025-12-27 01:46:45,773 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:46:45,773 - aiogram.dispatcher - WARNING - Sleep for 5.059065 seconds and try again... (tryings = 543, bot id = 8399571083)
2025-12-27 01:46:50,961 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:46:50,961 - aiogram.dispatcher - WARNING - Sleep for 4.942948 seconds and try again... (tryings = 544, bot id = 8399571083)
2025-12-27 01:46:56,020 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:46:56,020 - aiogram.dispatcher - WARNING - Sleep for 4.907498 seconds and try again... (tryings = 545, bot id = 8399571083)
2025-12-27 01:47:01,040 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:47:01,040 - aiogram.dispatcher - WARNING - Sleep for 4.986191 seconds and try again... (tryings = 546, bot id = 8399571083)
2025-12-27 01:47:06,146 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:47:06,146 - aiogram.dispatcher - WARNING - Sleep for 5.116556 seconds and try again... (tryings = 547, bot id = 8399571083)
2025-12-27 01:47:11,377 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:47:11,377 - aiogram.dispatcher - WARNING - Sleep for 4.970087 seconds and try again... (tryings = 548, bot id = 8399571083)
2025-12-27 01:47:16,467 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:47:16,467 - aiogram.dispatcher - WARNING - Sleep for 4.980618 seconds and try again... (tryings = 549, bot id = 8399571083)
2025-12-27 01:47:21,554 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:47:21,554 - aiogram.dispatcher - WARNING - Sleep for 5.049577 seconds and try again... (tryings = 550, bot id = 8399571083)
2025-12-27 01:47:27,017 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:47:27,017 - aiogram.dispatcher - WARNING - Sleep for 4.939675 seconds and try again... (tryings = 551, bot id = 8399571083)
2025-12-27 01:47:27,997 - __main__ - INFO - База данных создана
2025-12-27 01:47:32,091 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:47:32,091 - aiogram.dispatcher - WARNING - Sleep for 5.237615 seconds and try again... (tryings = 552, bot id = 8399571083)
2025-12-27 01:47:37,456 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:47:37,456 - aiogram.dispatcher - WARNING - Sleep for 5.225314 seconds and try again... (tryings = 553, bot id = 8399571083)
2025-12-27 01:47:42,811 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:47:42,812 - aiogram.dispatcher - WARNING - Sleep for 5.091893 seconds and try again... (tryings = 554, bot id = 8399571083)
2025-12-27 01:47:48,037 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:47:48,038 - aiogram.dispatcher - WARNING - Sleep for 4.920937 seconds and try again... (tryings = 555, bot id = 8399571083)
2025-12-27 01:47:53,094 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:47:53,094 - aiogram.dispatcher - WARNING - Sleep for 5.077247 seconds and try again... (tryings = 556, bot id = 8399571083)
2025-12-27 01:47:58,306 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:47:58,306 - aiogram.dispatcher - WARNING - Sleep for 5.168627 seconds and try again... (tryings = 557, bot id = 8399571083)
2025-12-27 01:48:03,605 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:48:03,605 - aiogram.dispatcher - WARNING - Sleep for 5.035043 seconds and try again... (tryings = 558, bot id = 8399571083)
2025-12-27 01:48:08,769 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:48:08,770 - aiogram.dispatcher - WARNING - Sleep for 4.904946 seconds and try again... (tryings = 559, bot id = 8399571083)
2025-12-27 01:48:13,818 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:48:13,819 - aiogram.dispatcher - WARNING - Sleep for 5.051457 seconds and try again... (tryings = 560, bot id = 8399571083)
2025-12-27 01:48:18,997 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:48:18,998 - aiogram.dispatcher - WARNING - Sleep for 5.190005 seconds and try again... (tryings = 561, bot id = 8399571083)
2025-12-27 01:48:24,316 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:48:24,316 - aiogram.dispatcher - WARNING - Sleep for 5.064562 seconds and try again... (tryings = 562, bot id = 8399571083)
2025-12-27 01:48:29,508 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:48:29,509 - aiogram.dispatcher - WARNING - Sleep for 4.990264 seconds and try again... (tryings = 563, bot id = 8399571083)
2025-12-27 01:48:34,639 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:48:34,639 - aiogram.dispatcher - WARNING - Sleep for 4.944037 seconds and try again... (tryings = 564, bot id = 8399571083)
2025-12-27 01:48:39,722 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:48:39,722 - aiogram.dispatcher - WARNING - Sleep for 5.019605 seconds and try again... (tryings = 565, bot id = 8399571083)
2025-12-27 01:48:44,873 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:48:44,874 - aiogram.dispatcher - WARNING - Sleep for 5.006830 seconds and try again... (tryings = 566, bot id = 8399571083)
2025-12-27 01:48:50,012 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:48:50,013 - aiogram.dispatcher - WARNING - Sleep for 5.013273 seconds and try again... (tryings = 567, bot id = 8399571083)
2025-12-27 01:48:55,169 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:48:55,169 - aiogram.dispatcher - WARNING - Sleep for 4.848991 seconds and try again... (tryings = 568, bot id = 8399571083)
2025-12-27 01:49:00,143 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:49:00,143 - aiogram.dispatcher - WARNING - Sleep for 4.938593 seconds and try again... (tryings = 569, bot id = 8399571083)
2025-12-27 01:49:04,153 - __main__ - INFO - База данных создана
2025-12-27 01:49:05,210 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:49:05,210 - aiogram.dispatcher - WARNING - Sleep for 4.945146 seconds and try again... (tryings = 570, bot id = 8399571083)
2025-12-27 01:49:09,881 - __main__ - CRITICAL - Критическая ошибка: cannot import name 'AdminBroadcastStates' from 'src.states.admin_states' (C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\states\admin_states.py)
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\run.py", line 72, in main
    from src.main import main as bot_main
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\main.py", line 9, in <module>
    from src.bot.loader import setup_middlewares, setup_routers
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\loader.py", line 5, in <module>
    from src.handlers.start import start_router
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\__init__.py", line 2, in <module>
    from .admin import admin_router
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\admin\__init__.py", line 5, in <module>
    from .panel import router as panel_router
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\admin\panel.py", line 7, in <module>
    from src.states.admin_states import AdminPanelStates
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\states\__init__.py", line 8, in <module>
    from .admin_states import (
ImportError: cannot import name 'AdminBroadcastStates' from 'src.states.admin_states' (C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\states\admin_states.py)
2025-12-27 01:49:10,285 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:49:10,285 - aiogram.dispatcher - WARNING - Sleep for 4.943851 seconds and try again... (tryings = 571, bot id = 8399571083)
2025-12-27 01:49:15,357 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:49:15,357 - aiogram.dispatcher - WARNING - Sleep for 5.065602 seconds and try again... (tryings = 572, bot id = 8399571083)
2025-12-27 01:49:20,555 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:49:20,555 - aiogram.dispatcher - WARNING - Sleep for 5.089713 seconds and try again... (tryings = 573, bot id = 8399571083)
2025-12-27 01:49:25,790 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:49:25,790 - aiogram.dispatcher - WARNING - Sleep for 5.145602 seconds and try again... (tryings = 574, bot id = 8399571083)
2025-12-27 01:49:31,122 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:49:31,122 - aiogram.dispatcher - WARNING - Sleep for 5.055237 seconds and try again... (tryings = 575, bot id = 8399571083)
2025-12-27 01:49:36,305 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:49:36,306 - aiogram.dispatcher - WARNING - Sleep for 5.038548 seconds and try again... (tryings = 576, bot id = 8399571083)
2025-12-27 01:49:41,476 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:49:41,477 - aiogram.dispatcher - WARNING - Sleep for 5.045115 seconds and try again... (tryings = 577, bot id = 8399571083)
2025-12-27 01:49:46,652 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:49:46,652 - aiogram.dispatcher - WARNING - Sleep for 4.774910 seconds and try again... (tryings = 578, bot id = 8399571083)
2025-12-27 01:49:51,553 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:49:51,553 - aiogram.dispatcher - WARNING - Sleep for 4.975566 seconds and try again... (tryings = 579, bot id = 8399571083)
2025-12-27 01:49:56,657 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:49:56,657 - aiogram.dispatcher - WARNING - Sleep for 4.930851 seconds and try again... (tryings = 580, bot id = 8399571083)
2025-12-27 01:50:01,732 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:50:01,732 - aiogram.dispatcher - WARNING - Sleep for 4.896771 seconds and try again... (tryings = 581, bot id = 8399571083)
2025-12-27 01:50:06,756 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:50:06,756 - aiogram.dispatcher - WARNING - Sleep for 5.005970 seconds and try again... (tryings = 582, bot id = 8399571083)
2025-12-27 01:50:11,895 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:50:11,895 - aiogram.dispatcher - WARNING - Sleep for 4.981858 seconds and try again... (tryings = 583, bot id = 8399571083)
2025-12-27 01:50:17,002 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:50:17,002 - aiogram.dispatcher - WARNING - Sleep for 5.068766 seconds and try again... (tryings = 584, bot id = 8399571083)
2025-12-27 01:50:22,205 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:50:22,205 - aiogram.dispatcher - WARNING - Sleep for 4.829327 seconds and try again... (tryings = 585, bot id = 8399571083)
2025-12-27 01:50:27,162 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:50:27,162 - aiogram.dispatcher - WARNING - Sleep for 5.025135 seconds and try again... (tryings = 586, bot id = 8399571083)
2025-12-27 01:50:32,312 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:50:32,312 - aiogram.dispatcher - WARNING - Sleep for 4.954118 seconds and try again... (tryings = 587, bot id = 8399571083)
2025-12-27 01:50:37,398 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:50:37,398 - aiogram.dispatcher - WARNING - Sleep for 5.051651 seconds and try again... (tryings = 588, bot id = 8399571083)
2025-12-27 01:50:42,578 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:50:42,578 - aiogram.dispatcher - WARNING - Sleep for 4.968206 seconds and try again... (tryings = 589, bot id = 8399571083)
2025-12-27 01:50:47,680 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:50:47,680 - aiogram.dispatcher - WARNING - Sleep for 4.947648 seconds and try again... (tryings = 590, bot id = 8399571083)
2025-12-27 01:50:52,763 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:50:52,764 - aiogram.dispatcher - WARNING - Sleep for 4.915539 seconds and try again... (tryings = 591, bot id = 8399571083)
2025-12-27 01:50:57,817 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:50:57,817 - aiogram.dispatcher - WARNING - Sleep for 4.885763 seconds and try again... (tryings = 592, bot id = 8399571083)
2025-12-27 01:51:02,838 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:51:02,838 - aiogram.dispatcher - WARNING - Sleep for 4.999351 seconds and try again... (tryings = 593, bot id = 8399571083)
2025-12-27 01:51:07,972 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:51:07,972 - aiogram.dispatcher - WARNING - Sleep for 5.140889 seconds and try again... (tryings = 594, bot id = 8399571083)
2025-12-27 01:51:13,240 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:51:13,240 - aiogram.dispatcher - WARNING - Sleep for 4.996228 seconds and try again... (tryings = 595, bot id = 8399571083)
2025-12-27 01:51:18,364 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:51:18,364 - aiogram.dispatcher - WARNING - Sleep for 4.981973 seconds and try again... (tryings = 596, bot id = 8399571083)
2025-12-27 01:51:23,473 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:51:23,473 - aiogram.dispatcher - WARNING - Sleep for 5.069503 seconds and try again... (tryings = 597, bot id = 8399571083)
2025-12-27 01:51:28,671 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:51:28,671 - aiogram.dispatcher - WARNING - Sleep for 4.937234 seconds and try again... (tryings = 598, bot id = 8399571083)
2025-12-27 01:51:33,752 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:51:33,752 - aiogram.dispatcher - WARNING - Sleep for 5.080650 seconds and try again... (tryings = 599, bot id = 8399571083)
2025-12-27 01:51:38,959 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:51:38,959 - aiogram.dispatcher - WARNING - Sleep for 4.844522 seconds and try again... (tryings = 600, bot id = 8399571083)
2025-12-27 01:51:43,964 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:51:43,965 - aiogram.dispatcher - WARNING - Sleep for 5.234014 seconds and try again... (tryings = 601, bot id = 8399571083)
2025-12-27 01:51:49,317 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:51:49,317 - aiogram.dispatcher - WARNING - Sleep for 5.014619 seconds and try again... (tryings = 602, bot id = 8399571083)
2025-12-27 01:51:50,155 - __main__ - INFO - База данных создана
2025-12-27 01:51:54,465 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:51:54,465 - aiogram.dispatcher - WARNING - Sleep for 4.853813 seconds and try again... (tryings = 603, bot id = 8399571083)
2025-12-27 01:51:55,346 - __main__ - CRITICAL - Критическая ошибка: type object 'AdminPanelStates' has no attribute 'confirmations'
Traceback (most recent call last):
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\run.py", line 72, in main
    from src.main import main as bot_main
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\main.py", line 9, in <module>
    from src.bot.loader import setup_middlewares, setup_routers
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\bot\loader.py", line 5, in <module>
    from src.handlers.start import start_router
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\__init__.py", line 2, in <module>
    from .admin import admin_router
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\admin\__init__.py", line 5, in <module>
    from .panel import router as panel_router
  File "C:\Users\xam\PycharmProjects\vpn_bot_xam\vpn_bot\src\handlers\admin\panel.py", line 82, in <module>
    AdminPanelStates.confirmations,
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: type object 'AdminPanelStates' has no attribute 'confirmations'
2025-12-27 01:51:59,457 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:51:59,457 - aiogram.dispatcher - WARNING - Sleep for 4.968735 seconds and try again... (tryings = 604, bot id = 8399571083)
2025-12-27 01:52:04,558 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:52:04,558 - aiogram.dispatcher - WARNING - Sleep for 5.090017 seconds and try again... (tryings = 605, bot id = 8399571083)
2025-12-27 01:52:09,778 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:52:09,778 - aiogram.dispatcher - WARNING - Sleep for 5.141768 seconds and try again... (tryings = 606, bot id = 8399571083)
2025-12-27 01:52:15,045 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:52:15,046 - aiogram.dispatcher - WARNING - Sleep for 4.992064 seconds and try again... (tryings = 607, bot id = 8399571083)
2025-12-27 01:52:20,173 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:52:20,173 - aiogram.dispatcher - WARNING - Sleep for 4.833014 seconds and try again... (tryings = 608, bot id = 8399571083)
2025-12-27 01:52:25,146 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:52:25,147 - aiogram.dispatcher - WARNING - Sleep for 5.064512 seconds and try again... (tryings = 609, bot id = 8399571083)
2025-12-27 01:52:30,339 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:52:30,339 - aiogram.dispatcher - WARNING - Sleep for 4.847214 seconds and try again... (tryings = 610, bot id = 8399571083)
2025-12-27 01:52:35,309 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:52:35,309 - aiogram.dispatcher - WARNING - Sleep for 5.169089 seconds and try again... (tryings = 611, bot id = 8399571083)
2025-12-27 01:52:40,618 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:52:40,619 - aiogram.dispatcher - WARNING - Sleep for 5.162071 seconds and try again... (tryings = 612, bot id = 8399571083)
2025-12-27 01:52:45,913 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:52:45,913 - aiogram.dispatcher - WARNING - Sleep for 5.058051 seconds and try again... (tryings = 613, bot id = 8399571083)
2025-12-27 01:52:51,119 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:52:51,119 - aiogram.dispatcher - WARNING - Sleep for 5.099316 seconds and try again... (tryings = 614, bot id = 8399571083)
2025-12-27 01:52:56,345 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:52:56,345 - aiogram.dispatcher - WARNING - Sleep for 4.856952 seconds and try again... (tryings = 615, bot id = 8399571083)
2025-12-27 01:53:01,344 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:53:01,345 - aiogram.dispatcher - WARNING - Sleep for 4.927775 seconds and try again... (tryings = 616, bot id = 8399571083)
2025-12-27 01:53:06,415 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:53:06,416 - aiogram.dispatcher - WARNING - Sleep for 5.118297 seconds and try again... (tryings = 617, bot id = 8399571083)
2025-12-27 01:53:11,665 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:53:11,665 - aiogram.dispatcher - WARNING - Sleep for 5.102128 seconds and try again... (tryings = 618, bot id = 8399571083)
2025-12-27 01:53:16,894 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:53:16,894 - aiogram.dispatcher - WARNING - Sleep for 5.117191 seconds and try again... (tryings = 619, bot id = 8399571083)
2025-12-27 01:53:22,143 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:53:22,143 - aiogram.dispatcher - WARNING - Sleep for 5.052621 seconds and try again... (tryings = 620, bot id = 8399571083)
2025-12-27 01:53:27,346 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:53:27,346 - aiogram.dispatcher - WARNING - Sleep for 4.878054 seconds and try again... (tryings = 621, bot id = 8399571083)
2025-12-27 01:53:32,358 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:53:32,359 - aiogram.dispatcher - WARNING - Sleep for 4.842581 seconds and try again... (tryings = 622, bot id = 8399571083)
2025-12-27 01:53:37,348 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:53:37,348 - aiogram.dispatcher - WARNING - Sleep for 4.978307 seconds and try again... (tryings = 623, bot id = 8399571083)
2025-12-27 01:53:42,464 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:53:42,465 - aiogram.dispatcher - WARNING - Sleep for 5.117433 seconds and try again... (tryings = 624, bot id = 8399571083)
2025-12-27 01:53:45,808 - __main__ - INFO - База данных создана
2025-12-27 01:53:47,721 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:53:47,721 - aiogram.dispatcher - WARNING - Sleep for 4.878195 seconds and try again... (tryings = 625, bot id = 8399571083)
2025-12-27 01:53:52,742 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:53:52,742 - aiogram.dispatcher - WARNING - Sleep for 4.947943 seconds and try again... (tryings = 626, bot id = 8399571083)
2025-12-27 01:53:57,827 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:53:57,828 - aiogram.dispatcher - WARNING - Sleep for 4.909219 seconds and try again... (tryings = 627, bot id = 8399571083)
2025-12-27 01:54:02,873 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:54:02,873 - aiogram.dispatcher - WARNING - Sleep for 4.968093 seconds and try again... (tryings = 628, bot id = 8399571083)
2025-12-27 01:54:07,971 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:54:07,971 - aiogram.dispatcher - WARNING - Sleep for 5.106297 seconds and try again... (tryings = 629, bot id = 8399571083)
2025-12-27 01:54:13,207 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:54:13,207 - aiogram.dispatcher - WARNING - Sleep for 4.903724 seconds and try again... (tryings = 630, bot id = 8399571083)
2025-12-27 01:54:18,247 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:54:18,247 - aiogram.dispatcher - WARNING - Sleep for 5.088777 seconds and try again... (tryings = 631, bot id = 8399571083)
2025-12-27 01:54:23,453 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:54:23,453 - aiogram.dispatcher - WARNING - Sleep for 4.911400 seconds and try again... (tryings = 632, bot id = 8399571083)
2025-12-27 01:54:28,499 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:54:28,499 - aiogram.dispatcher - WARNING - Sleep for 4.868739 seconds and try again... (tryings = 633, bot id = 8399571083)
2025-12-27 01:54:33,503 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:54:33,503 - aiogram.dispatcher - WARNING - Sleep for 4.981288 seconds and try again... (tryings = 634, bot id = 8399571083)
2025-12-27 01:54:38,610 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:54:38,610 - aiogram.dispatcher - WARNING - Sleep for 5.014543 seconds and try again... (tryings = 635, bot id = 8399571083)
2025-12-27 01:54:43,754 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:54:43,754 - aiogram.dispatcher - WARNING - Sleep for 4.896546 seconds and try again... (tryings = 636, bot id = 8399571083)
2025-12-27 01:54:48,782 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:54:48,782 - aiogram.dispatcher - WARNING - Sleep for 4.865148 seconds and try again... (tryings = 637, bot id = 8399571083)
2025-12-27 01:54:53,797 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:54:53,798 - aiogram.dispatcher - WARNING - Sleep for 4.735141 seconds and try again... (tryings = 638, bot id = 8399571083)
2025-12-27 01:54:58,667 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:54:58,667 - aiogram.dispatcher - WARNING - Sleep for 5.157830 seconds and try again... (tryings = 639, bot id = 8399571083)
2025-12-27 01:55:03,957 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:55:03,957 - aiogram.dispatcher - WARNING - Sleep for 5.048485 seconds and try again... (tryings = 640, bot id = 8399571083)
2025-12-27 01:55:09,132 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:55:09,132 - aiogram.dispatcher - WARNING - Sleep for 4.904307 seconds and try again... (tryings = 641, bot id = 8399571083)
2025-12-27 01:55:14,162 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:55:14,163 - aiogram.dispatcher - WARNING - Sleep for 5.151075 seconds and try again... (tryings = 642, bot id = 8399571083)
2025-12-27 01:55:19,450 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:55:19,450 - aiogram.dispatcher - WARNING - Sleep for 4.991556 seconds and try again... (tryings = 643, bot id = 8399571083)
2025-12-27 01:55:24,565 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:55:24,565 - aiogram.dispatcher - WARNING - Sleep for 4.984648 seconds and try again... (tryings = 644, bot id = 8399571083)
2025-12-27 01:55:29,676 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:55:29,676 - aiogram.dispatcher - WARNING - Sleep for 4.925213 seconds and try again... (tryings = 645, bot id = 8399571083)
2025-12-27 01:55:34,730 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:55:34,730 - aiogram.dispatcher - WARNING - Sleep for 5.034148 seconds and try again... (tryings = 646, bot id = 8399571083)
2025-12-27 01:55:39,894 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:55:39,894 - aiogram.dispatcher - WARNING - Sleep for 4.866369 seconds and try again... (tryings = 647, bot id = 8399571083)
2025-12-27 01:55:44,903 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:55:44,903 - aiogram.dispatcher - WARNING - Sleep for 4.981950 seconds and try again... (tryings = 648, bot id = 8399571083)
2025-12-27 01:55:50,014 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:55:50,015 - aiogram.dispatcher - WARNING - Sleep for 4.917626 seconds and try again... (tryings = 649, bot id = 8399571083)
2025-12-27 01:55:55,064 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramUnauthorizedError: Telegram server says - Unauthorized
2025-12-27 01:55:55,065 - aiogram.dispatcher - WARNING - Sleep for 5.166077 seconds and try again... (tryings = 650, bot id = 8399571083)
